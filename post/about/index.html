<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="keywords" content="Philosopher blog">
<meta name="description" content="WORLD AS CODE">
<meta name="theme-color" content="#000">
<title>å…³äº | Philosopher</title>
<link rel="shortcut icon" href="/favicon.ico?v=1677655066253">
<link rel="stylesheet" href="/media/css/pisces.css">
<link rel="stylesheet" href="/media/fonts/font-awesome.css">
<link
  href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Rosario:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext"
  rel="stylesheet" type="text/css">

<link href="/media/hljs/styles/default.css"
  rel="stylesheet">

<link rel="stylesheet" href="/styles/main.css">
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script src="/media/js/jquery.js"></script>
<script src="/media/hljs/highlight.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.ui.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"
  integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"
  integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"
  integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
  onload="renderMathInElement(document.body);"></script>






  <meta name="description" content="å…³äº" />
  <meta name="keywords" content="" />
</head>

<body>
  <div class="head-top-line"></div>
  <div class="header-box">
    
<div class="pisces">
  <header class="header  ">
    <div class="blog-header box-shadow-wrapper bg-color " id="header">
      <div class="nav-toggle" id="nav_toggle">
        <div class="toggle-box">
          <div class="line line-top"></div>
          <div class="line line-center"></div>
          <div class="line line-bottom"></div>
        </div>
      </div>
      <div class="site-meta">       
        <div class="site-title">
          
            <a href="/" class="brand">
              <span>Philosopher</span>
            </a>  
          
        </div>
        
          <p class="subtitle">WORLD AS CODE</p>
        
      </div>
      <nav class="site-nav" id="site_nav">
        <ul id="nav_ul">
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/" target="_self">
                  <i class="fa fa-home"></i> é¦–é¡µ
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/archives/" target="_self">
                  <i class="fa fa-archive"></i> å½’æ¡£
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/tags/" target="_self">
                  <i class="fa fa-tags"></i> æ ‡ç­¾
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/post/about/" target="_self">
                  <i class="fa fa-user"></i> å…³äº
                </a>
              
            </li>
          
          
            
              <li class="nav-item ">
                <a href="/friends/" target="_self">
                  
                    <i class="fa fa-address-book"></i> å‹é“¾
                  
                </a>
              </li>
            
          
          
            <li id="fa_search" class="nav-item">
              <a href="javascript:void(0);">
                <i class="fa fa-search"></i> <span class="language" data-lan="search">æœç´¢</span>
              </a>
            </li>
          
        </ul>
      </nav>
    </div>
  </header>
</div>

<script type="text/javascript"> 
 
  let showNav = true;

  let navToggle = document.querySelector('#nav_toggle'),
  siteNav = document.querySelector('#site_nav');
  
  function navClick() {
    let sideBar = document.querySelector('.sidebar');
    let navUl = document.querySelector('#nav_ul');
    navToggle.classList.toggle('nav-toggle-active');
    siteNav.classList.toggle('nav-menu-active');
    if (siteNav.classList.contains('nav-menu-active')) {
      siteNav.style = "height: " + (navUl.children.length * 42) +"px !important";
    } else {
      siteNav.style = "";
    }
  }

  navToggle.addEventListener('click',navClick);  
</script>
  </div>
  <div class="main-continer">
    
    <div
      class="section-layout pisces ">
      <div class="section-layout-wrapper">
        

<div class="sidebar">
  
    <div class="sidebar-box box-shadow-wrapper bg-color right-motion" id="sidebar">
      
        <div class="post-list-sidebar">
          <div class="sidebar-title">
            <span id="tocSideBar" class="sidebar-title-item sidebar-title-active language" data-lan="index">æ–‡ç« ç›®å½•</span>
            <span id="metaSideBar" class="sidebar-title-item language" data-lan="preview">ç«™ç‚¹æ¦‚è§ˆ</span>
          </div>
        </div>
      
      <div class="sidebar-body pisces" id="sidebar_body">
        
          
            <div class="post-side-meta" id="post_side_meta">
              
<div class="sidebar-wrapper box-shadow-wrapper bg-color">
  <div class="sidebar-item">
    <img class="site-author-image right-motion" src="/images/avatar.png"/>
    <p class="site-author-name">Philosopher</p>
    
    <div class="site-description right-motion">
      
      
      
        <p>world-as-code</p>
      
      
    </div>
    
  </div>
  <div class="sidebar-item side-item-stat right-motion">
    <div class="sidebar-item-box">
      <a href="/archives/">
        
        <span class="site-item-stat-count">7</span>
        <span class="site-item-stat-name language" data-lan="article">æ–‡ç« </span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="">
        <span class="site-item-stat-count">1</span>
        <span class="site-item-stat-name language" data-lan="category">åˆ†ç±»</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="/tags/">
        <span class="site-item-stat-count">1</span>
        <span class="site-item-stat-name language" data-lan="tag">æ ‡ç­¾</span>
      </a>
    </div>
  </div>
  
    
      <div class="sidebar-item">
        <span class="site-item-rss">
            <i class="fa fa-rss"></i>
            <a href="https://philosopherzb.github.io/atom.xml" target="_blank">RSS</a>
        </span>
      </div>
    
  
  



</div>
            </div>
            <div class="post-toc sidebar-body-active" id="post_toc" style="opacity: 1;">
              <div class="toc-box right-motion">
  <div class="toc-wrapper auto-number auto"
    id="toc_wrapper">
    <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E5%85%B3%E4%BA%8E%E6%9C%AC%E7%AB%99">ğŸ  å…³äºæœ¬ç«™</a></li>
<li><a href="#%E5%8D%9A%E4%B8%BB%E6%98%AF%E8%B0%81">ğŸ‘¨â€ğŸ’» åšä¸»æ˜¯è°</a></li>
<li><a href="#%E8%81%94%E7%B3%BB%E6%88%91%E5%91%80">ğŸ“¬ è”ç³»æˆ‘å‘€</a></li>
</ul>
</li>
</ul>

  </div>
</div>

<script>

  let lastTop = 0, lList = [], hList = [], postBody, lastIndex = -1;
  let active = 'active-show', activeClass = 'active-current';
  let tocWrapper = document.querySelector('#toc_wrapper');
  let tocContent = tocWrapper.children[0];
  let autoNumber = tocWrapper && tocWrapper.classList.contains('auto-number');

  function addTocNumber(elem, deep) {
    if (!elem) {
      return;
    }
    let prop = elem.__proto__;

    if (prop === HTMLUListElement.prototype) {
      for (let i = 0; i < elem.children.length; i++) {
        addTocNumber(elem.children[i], deep + (i + 1) + '.');
      }
    } else if (prop === HTMLLIElement.prototype) {
      // ä¿å­˜liå…ƒç´ 
      if (elem.children[0] && elem.children[0].__proto__ === HTMLAnchorElement.prototype) {
        lList.push(elem);
      }
      for (let i = 0; i < elem.children.length; i++) {
        let cur = elem.children[i];
        if (cur.__proto__ === HTMLAnchorElement.prototype) {
          if (autoNumber) {
            cur.text = deep + ' ' + cur.text;
          }
        } else if (cur.__proto__ === HTMLUListElement.prototype) {
          addTocNumber(cur, deep);
        }
      }
    }
  }

  function removeParentActiveClass() {
    let parents = tocContent.querySelectorAll('.' + active)
    parents.forEach(function (elem) {
      elem.classList.remove(active);
    });
  }

  function addActiveClass(index) {
    if (index >= 0 && index < hList.length) {
      lList[index].classList.add(activeClass);
    }
  }

  function removeActiveClass(index) {
    if (index >= 0 && index < hList.length) {
      lList[index].classList.remove(activeClass);
    }
  }

  function addActiveLiElemment(elem, parent) {
    if (!elem || elem === parent) {
      return;
    } else {
      if (elem.__proto__ === HTMLLIElement.prototype) {
        elem.classList.add(active);
      }
      addActiveLiElemment(elem.parentElement, parent);
    }
  }

  function showToc() {
    if (tocWrapper) {
      postBody = document.querySelector('#post_body');
      for (let i = 0; i < postBody.children.length; i++) {
        if (postBody.children[i].__proto__ === HTMLHeadingElement.prototype) {
          hList.push(postBody.children[i]);
        }
      }
      if (tocWrapper.classList.contains('compress')) {
        tocContent.classList.add('closed');
      } else if (tocWrapper.classList.contains('no_compress')) {
        tocContent.classList.add('expanded');
      } else {
        if (hList.length > 10) {
          active = 'active-hidden'
          tocContent.classList.add('closed');
        } else {
          tocContent.classList.add('expanded');
        }
      }
    }
  }

  (function () {
    // å¤„ç†ä¸æ˜¯ä»#ä¸€çº§æ ‡é¢˜å¼€å§‹ç›®å½•
    if (tocContent.children.length === 1 && tocContent.children[0].__proto__ === HTMLLIElement.prototype) {
      let con = tocContent.children[0].children[0];
      tocContent.innerHTML = con.innerHTML;
    }
    let markdownItTOC = document.querySelector('.markdownIt-TOC');
    let innerHeight = window.innerHeight;
    markdownItTOC.style = `max-height: ${innerHeight - 80 > 0 ? innerHeight - 80 : innerHeight}px`
    addTocNumber(tocContent, '');
  })();

  document.addEventListener('scroll', function (e) {
    if (lList.length <= 0) {
      return;
    }
    let scrollTop = document.scrollingElement.scrollTop + 10;
    let dir;

    if (lastTop - scrollTop > 0) {
      dir = 'up';
    } else {
      dir = 'down';
    }

    lastTop = scrollTop;
    if (scrollTop <= 0) {
      if (lastIndex >= 0 && lastIndex < hList.length) {
        lList[lastIndex].classList.remove(activeClass);
      }
      return;
    }

    let current = 0, hasFind = false;
    for (let i = 0; i < hList.length; i++) {
      if (hList[i].offsetTop > scrollTop) {
        current = i;
        hasFind = true;
        break;
      }
    }
    if (!hasFind && scrollTop > lList[lList.length - 1].offsetTop) {
      current = hList.length - 1;
    } else {
      current--;
    }
    if (dir === 'down') {
      if (current > lastIndex) {
        addActiveClass(current);
        removeActiveClass(lastIndex)
        lastIndex = current;
        removeParentActiveClass();
        lList[current] && addActiveLiElemment(lList[current].parentElement, tocContent);
      }
    } else {
      if (current < lastIndex) {
        addActiveClass(current);
        removeActiveClass(lastIndex);
        lastIndex = current;
        removeParentActiveClass();
        lList[current] && addActiveLiElemment(lList[current].parentElement, tocContent);
      }
    }
  });


  window.addEventListener('load', function () {
    showToc();
    document.querySelector('#sidebar').style = 'display: block;';
    tocWrapper.classList.add('toc-active');
    setTimeout(function () {
      if ("createEvent" in document) {
        let evt = document.createEvent("HTMLEvents");
        evt.initEvent("scroll", false, true);
        document.dispatchEvent(evt);
      }
      else {
        document.fireEvent("scroll");
      }
    }, 500)
  })

</script>
            </div>
          
        
      </div>
    </div>
  
</div>
<script>
  const SIDEBAR_TITLE_ACTIVE = 'sidebar-title-active';
  const SIDEBAR_BODY_ACTIVE = 'sidebar-body-active';
  const SLIDE_UP_IN = 'slide-up-in';

  let sidebar = document.querySelector('#sidebar'),
  tocSideBar = document.querySelector('#tocSideBar'),
  metaSideBar = document.querySelector('#metaSideBar'),
  postToc = document.querySelector('#post_toc'),
  postSiteMeta = document.querySelector('#post_side_meta'),
  sidebarTitle = document.querySelector('.sidebar-title'),
  sidebarBody = document.querySelector('#sidebar_body');

  tocSideBar && tocSideBar.addEventListener('click', (e) => {
    toggleSidebar(e);
  });

  metaSideBar && metaSideBar.addEventListener('click', (e) => {
    toggleSidebar(e);
  });

  function toggleSidebar(e) {
    let currentTitle = document.querySelector("."+SIDEBAR_TITLE_ACTIVE);
    if (currentTitle == e.srcElement) {
      return ;
    }
    let current, showElement, hideElement;
    if (e.srcElement == metaSideBar) {
      showElement = postSiteMeta;
      hideElement = postToc;
    } else if (e.srcElement == tocSideBar){
      showElement = postToc;
      hideElement = postSiteMeta;
    }
    currentTitle.classList.remove(SIDEBAR_TITLE_ACTIVE);
    e.srcElement.classList.add(SIDEBAR_TITLE_ACTIVE);

    window.Velocity(hideElement, 'stop');
    window.Velocity(hideElement, 'transition.slideUpOut', {
      display: 'none',
      duration: 200,
      complete: function () {
        window.Velocity(showElement, 'transition.slideDownIn', {
          duration: 200
        });
      }
    })
    hideElement.classList.remove(SIDEBAR_BODY_ACTIVE);
    showElement.classList.add(SIDEBAR_BODY_ACTIVE);
  }

  postToc && postToc.addEventListener('transitionend', function() {
    this.classList.remove(SLIDE_UP_IN);
  });

  if (sidebarBody) {
    if (sidebarBody.classList.contains('pisces') || sidebarBody.classList.contains('gemini')) {
      let hasFix = false;
      let scrollEl = document.querySelector('.main-continer');
      let limitTop = document.querySelector('#nav_ul').children.length * 42 + 162;
      window.addEventListener('scroll', function(e) {
        if (document.scrollingElement.scrollTop >= limitTop) {
          if (!hasFix) {
            sidebar.classList.add('sidebar-fixed');
            hasFix = true;
          }
        } else {
          if (hasFix) {
            sidebar.classList.remove('sidebar-fixed');
            hasFix = false;
          }
        }
      });
    }
  }
  
</script>
        <div class="section-box box-shadow-wrapper">
          <div class="section bg-color post post-page">
            <section class="post-header">
  <h1 class="post-title">
    <a class="post-title-link" href="https://philosopherzb.github.io/post/about/">
      å…³äº
    </a>
  </h1>
  <div class="post-meta">
    
    <span class="meta-item pc-show">
      <i class="fa fa-calendar-o"></i>
      <span class="language" data-lan="publish">å‘å¸ƒäº</span>
      <span class="publish-time" data-t="2019-01-25 19:09:48">2019-01-25</span>
      <span class="post-meta-divider pc-show">|</span>
    </span>
    
    <span class="meta-item">
      <i class="fa fa-clock-o"></i>
      <span>1<span class="language" data-lan="minute">åˆ†é’Ÿ</span></span>
    </span>
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-file-word-o"></i>
      <span>88<span class="pc-show language" data-lan="words">å­—æ•°</span></span>
    </span>
    
    
    
    <span id="/post/about/" data-flag-title="å…³äº" class="meta-item pc-show leancloud_visitors">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-eye"></i>
      <span><span class="language" data-lan="view">æµè§ˆé‡</span>ï¼š<span class="leancloud-visitors-count"></span></span>
    </span>
    
  </div>
</section>
            <div class="post-body next-md-body" id="post_body">
              <blockquote>
<p>æ¬¢è¿æ¥åˆ°æˆ‘çš„å°ç«™å‘€ï¼Œå¾ˆé«˜å…´é‡è§ä½ ï¼ğŸ¤</p>
</blockquote>
<h2 id="å…³äºæœ¬ç«™">ğŸ  å…³äºæœ¬ç«™</h2>
<p>æœ¬ç«™ä½¿ç”¨github-pagesåŠGrideaæ­å»ºè€Œæˆï¼Œä¸“é—¨ç”¨äºæŠ€æœ¯åˆ†äº«ï¼Œæ¬¢è¿å¤§å®¶ä¸€èµ·å‚ä¸ã€‚</p>
<blockquote>
<p>github-pages doc: <a href="https://docs.github.com/en/pages">https://docs.github.com/en/pages</a><br>
gridea doc: <a href="https://gridea.dev/gridea-start/">https://gridea.dev/gridea-start/</a></p>
</blockquote>
<h2 id="åšä¸»æ˜¯è°">ğŸ‘¨â€ğŸ’» åšä¸»æ˜¯è°</h2>
<p>æ±‚çŸ¥è·¯ä¸Šçš„é™Œç”Ÿäºº</p>
<h2 id="è”ç³»æˆ‘å‘€">ğŸ“¬ è”ç³»æˆ‘å‘€</h2>
<p>æœ‰é—®é¢˜å¯ä»¥ç•™è¨€è®¨è®ºå“ˆğŸ˜„</p>

            </div>
            
            
            
  <script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script>
<div id="vcomments" style="padding: 10px 0px 0px 0px"></div>

<style>
  .v .veditor {
    min-height: 10rem;
    background-image: url('');
    background-size: contain;
    background-repeat: no-repeat;
    background-position: right;
    background-color: rgba(255, 255, 255, 0);
    resize: none;
  }

  .v .vwrap {
    border: 1px solid #000 !important;
  }

  .v .vbtn {
    padding: .4rem 1.2rem !important;
    border-color: #fff !important;
    background-color: #49b1f5 !important;
    color: #fff !important;
    font-size: .7rem !important;
  }

  .v .vcards .vcard .vh .vmeta .vat {
    padding: 0 .8rem !important;
    border: 1px solid #00c4b6 !important;
    border-radius: 5px !important;
    color: #00c4b6 !important;
  }
</style>
<script>
  new Valine({
    el: '#vcomments',
    appId: 'vTL9neewLgXcivf073tLdmIO-gzGzoHsz',
    appKey: '6EMsHOzs5kmg8TqCyk0OI7qU',
    avatar: 'mp',
    placeholder: 'Comments welcome',
    pageSize: '10',
    lang: 'zh-cn',
    enableQQ: 'true' === 'false',
    visitor: 'true' === 'true',
    highlight: 'true' === 'true',
    avatarForce: 'true' === 'false',
  });
</script>

          </div>
        </div>
      </div>
    </div>
    <div class="footer-box">
  <footer class="footer">
    <span id="busuanzi_container_site_pv">æµè§ˆæ•° <span id="busuanzi_value_site_pv"></span> æ¬¡</span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">è®¿å®¢æ•° <span id="busuanzi_value_site_uv"></span> äºº</span>
    <div class="copyright">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> Â©2019 | Theme By <a
        href="https://github.com/hsxyhao/gridea-theme-next" target="_blank">HsxyHao</a>
    </div>
    <div class="poweredby">
      
    </div>
  </footer>
  
  
  <div class="pisces back-to-top" id="back_to_top">
    <i class="fa fa-arrow-up"></i>
    
    <span class="scrollpercent">
      <span id="back_to_top_text">0</span>%
    </span>
    
  </div>
  
  
  
  <div class="bg-img">
    <img src="https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/1580483397838.jpeg" />
  </div>
  
  
  
  
</div>
<script>

  let sideBarOpen = 'sidebar-open';
  let body = document.body;
  let back2Top = document.querySelector('#back_to_top'),
    back2TopText = document.querySelector('#back_to_top_text'),
    drawerBox = document.querySelector('#drawer_box'),
    rightSideBar = document.querySelector('.sidebar'),
    viewport = document.querySelector('body');

  function scrollAnimation(currentY, targetY) {

    let needScrollTop = targetY - currentY
    let _currentY = currentY
    setTimeout(() => {
      const dist = Math.ceil(needScrollTop / 10)
      _currentY += dist
      window.scrollTo(_currentY, currentY)
      if (needScrollTop > 10 || needScrollTop < -10) {
        scrollAnimation(_currentY, targetY)
      } else {
        window.scrollTo(_currentY, targetY)
      }
    }, 1)
  }

  back2Top.addEventListener("click", function (e) {
    scrollAnimation(document.scrollingElement.scrollTop, 0);
    e.stopPropagation();
    return false;
  });

  window.addEventListener('scroll', function (e) {
    let percent = document.scrollingElement.scrollTop / (document.scrollingElement.scrollHeight - document.scrollingElement.clientHeight) * 100;
    if (percent > 1 && !back2Top.classList.contains('back-top-active')) {
      back2Top.classList.add('back-top-active');
    }
    if (percent == 0) {
      back2Top.classList.remove('back-top-active');
    }
    if (back2TopText) {
      back2TopText.textContent = Math.floor(percent);
    }
  });


  let hasCacu = false;
  window.addEventListener('resize', function (e) {
    calcuHeight();
  });

  function calcuHeight() {
    // åŠ¨æ€è°ƒæ•´ç«™ç‚¹æ¦‚è§ˆé«˜åº¦
    if (!hasCacu && back2Top.classList.contains('pisces') || back2Top.classList.contains('gemini')) {
      let sideBar = document.querySelector('.sidebar');
      let navUl = document.querySelector('#site_nav');
      sideBar.style = 'margin-top:' + (navUl.offsetHeight + navUl.offsetTop + 15) + 'px;';
      hasCacu = true;
    }
  }
  calcuHeight();

  let open = false, MOTION_TIME = 300, RIGHT_MOVE_DIS = '320px';

  if (drawerBox) {
    let rightMotions = document.querySelectorAll('.right-motion');
    let right = drawerBox.classList.contains('right');

    let transitionDir = right ? "transition.slideRightIn" : "transition.slideLeftIn";

    let openProp, closeProp;
    if (right) {
      openProp = {
        paddingRight: RIGHT_MOVE_DIS
      };
      closeProp = {
        paddingRight: '0px'
      };
    } else {
      openProp = {
        paddingLeft: RIGHT_MOVE_DIS
      };
      closeProp = {
        paddingLeft: '0px'
      };
    }

    drawerBox.onclick = function () {
      open = !open;
      jQuery.Velocity(rightSideBar, 'stop');
      jQuery.Velocity(viewport, 'stop');
      jQuery.Velocity(rightMotions, 'stop');
      if (open) {
        jQuery.Velocity(rightSideBar, {
          width: RIGHT_MOVE_DIS
        }, {
          duration: MOTION_TIME,
          begin: function () {
            jQuery.Velocity(rightMotions, transitionDir, {});
          }
        })
        jQuery.Velocity(viewport, openProp, {
          duration: MOTION_TIME
        });
      } else {
        jQuery.Velocity(rightSideBar, {
          width: '0px'
        }, {
          duration: MOTION_TIME,
          begin: function () {
            jQuery.Velocity(rightMotions, {
              opacity: 0
            });
          }
        })
        jQuery.Velocity(viewport, closeProp, {
          duration: MOTION_TIME
        });
      }
      for (let i = 0; i < drawerBox.children.length; i++) {
        drawerBox.children[i].classList.toggle('muse-line');
      }
      drawerBox.classList.toggle(sideBarOpen);
    }
  }

  // é“¾æ¥è·³è½¬
  let newWindow = 'true'
  if (newWindow === 'true') {
    let links = document.querySelectorAll('.post-body a')
    links.forEach(item => {
      if (!item.classList.contains('btn')) {
        item.setAttribute("target", "_blank");
      }
    })
  }

  let faSearch = document.querySelector('#fa_search');
  faSearch && faSearch.addEventListener('click', function () {
    document.querySelector('#search_mask').style = ''
  })

  // ä»£ç é«˜äº®
  hljs.initHighlightingOnLoad();
  
  // ç¦»å¼€å½“å‰é¡µtitleå˜åŒ–
  var leaveTitle = "";
  if (leaveTitle) {
    document.addEventListener('visibilitychange', function () {
      if (document.visibilityState == 'hidden') {
        normal_title = document.title;
        document.title = leaveTitle;
      } else {
        document.title = normal_title;
      }
    });
  }

</script>

<link rel="stylesheet" href="/media/css/jquery.fancybox.css" />
<script src="/media/js/jquery.fancybox.js"></script>

<script>
  let images = document.querySelectorAll('.section img');
  images.forEach(image => {
    var parent = image.parentElement;
    var next = image.nextElementSibling;
    parent.removeChild(image);
    var aelem = document.createElement('a');
    aelem.href = image.src;
    aelem.dataset['fancybox'] = 'images';
    aelem.dataset['rel'] = 'fancybox-button';
    aelem.classList.add('fancybox');
    aelem.appendChild(image);
    parent.insertBefore(aelem, next);
  })
</script>

    <div class="reward-mask" style="display: none;">
  <div class="reward-relative">
    <span class="close" aria-hidden="true">x</span>
    <div class="reward-body">
      <h2>æ„Ÿè°¢æ‚¨çš„æ”¯æŒï¼Œæˆ‘ä¼šç»§ç»­åŠªåŠ›çš„!</h2>
      <div class="reward-img-box">
        <div style="position: relative; width: 140px; height: 140px;">
          
          
          
        </div>
      </div>
      <p class="reward-word">æ‰«ç æ‰“èµï¼Œä½ è¯´å¤šå°‘å°±å¤šå°‘</p>
      <p class="reward-tip">æ‰“å¼€å¾®ä¿¡æ‰«ä¸€æ‰«ï¼Œå³å¯è¿›è¡Œæ‰«ç æ‰“èµå“¦</p>
    </div>
    <div class="bottom">
      
      
    </div>
  </div>
</div>
<style>
  .reward-mask {
    position: fixed;
    z-index: 99999;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    background-color: #00000054;
  }

  .reward-relative {
    position: relative;
    width: 480px;
    text-align: center;
    margin: 0 auto;
    border-radius: 5px;
    background-color: #fff;
    top: 50%;
    margin-top: -205px;
  }

  .reward-relative .close {
    position: absolute;
    right: 10px;
    font-weight: normal;
    font-size: 16px;
    color: #929292;
  }

  .reward-body {
    padding: 40px 20px 20px;
  }

  .bottom {
    display: flex;
  }

  .reward-btn {
    text-align: center;
  }

  .reward-btn-text {
    display: inline-block;
    cursor: pointer;
    width: 60px;
    height: 60px;
    line-height: 60px;
    border-radius: 50%;
    background-color: #ff9734;
    color: #FFF;
    margin-top: 20px;
  }

  .pay-text {
    margin-top: 10px;
    padding: 10px;
    flex: 1;
    transition: all .2s linear;
  }

  .pay-text:hover {
    background-color: #a5a5a536;
  }

  .reward-body h2 {
    padding-top: 10px;
    text-align: center;
    color: #a3a3a3;
    font-size: 16px;
    font-weight: normal;
    margin: 0 0 20px;
  }

  .reward-body h2:after,
  .reward-body h2:before {
    font-family: Arial, Helvetica, sans-serif;
    background: 0 0;
    width: 0;
    height: 0;
    font-style: normal;
    color: #eee;
    font-size: 80px;
    position: absolute;
    top: 20px;
  }

  .reward-body h2:before {
    content: '\201c';
    left: 50px;
  }

  .reward-body h2:after {
    content: '\201d';
    right: 80px;
  }

  .reward-img-box {
    display: inline-block;
    padding: 10px;
    border: 6px solid #ea5f00;
    margin: 0 auto;
    border-radius: 3px;
    position: relative;
  }

  .reward-img {
    position: absolute;
    left: 0px;
    top: 0px;
    width: 100%;
    height: 100%;
  }

  @media (max-width: 767px) {
    .reward-relative {
      height: 100%;
      top: 0px;
      margin-top: 0;
      width: auto;
    }

    .reward-relative .bottom {
      flex-direction: column;
    }

    .reward-relative .pay-text {
      width: 80%;
      margin: 5px auto;
      border: 1px solid silver;
      padding: 6px;
      border-radius: 4px;
    }

    .reward-body h2:after {
      right: 40px;
    }

    .reward-body h2:after,
    .reward-body h2:before {
      font-size: 60px;
    }

    .reward-body h2:before {
      left: 20px;
    }
  }
</style>
<script>
  !function () {
    var mask = document.querySelector('.reward-mask');
    let close = document.querySelector('.reward-relative .close');
    let rewardBtn = document.querySelector('.reward-btn');

    let zfb = document.querySelector('#zfb'),
      wx = document.querySelector('#wx'),
      zfbBtn = document.querySelector('#zfbBtn'),
      wxBtn = document.querySelector('#wxBtn');

    if (zfbBtn && wxBtn) {
      zfbBtn.addEventListener('click', () => {
        window.Velocity(zfb, 'transition.slideLeftIn', {
          duration: 400
        });
        window.Velocity(wx, 'transition.slideRightOut', {
          display: 'none',
          duration: 400
        });
      });

      wxBtn.addEventListener('click', () => {
        window.Velocity(wx, 'transition.slideRightIn', {
          duration: 400
        });
        window.Velocity(zfb, 'transition.slideLeftOut', {
          display: 'none',
          duration: 400
        });
      });
    }

    rewardBtn.addEventListener('click', (e) => {
      window.Velocity(mask, 'transition.slideDownIn', {
        duration: 400
      })
    });

    close.addEventListener('click', (e) => {
      e.preventDefault();
      window.Velocity(mask, 'transition.slideUpOut', {
        duration: 400
      })
    })
  }()
</script>

  </div>
</body>

<div class="search-mask" id="search_mask" style="display: none;">
  <div class="search-box">
    <div class="search-title">
      <i class="fa fa-search"></i>
      <div class="input-box">
        <input id="search" type="text" class="language" data-lan="search" placeholder="æœç´¢">
      </div>
      <i id="close" class="fa fa-times-circle"></i>
    </div>
    <div class="stat-box">
      <span id="stat_count">0</span><span class="language" data-lan="stat">æ¡ç›¸å…³æ¡ç›®ï¼Œä½¿ç”¨äº†</span><span id="stat_times">0</span><span class="language" data-lan="stat-time">æ¯«ç§’</span>
      <hr>
    </div>
    <div class="result" id="result">
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://philosopherzb.github.io/post/java8-xin-te-xing-streamandcompletablefuture/"" data-c="
          &lt;h2 id=&#34;stream&#34;&gt;Stream&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;// è·å–æŸä¸ªå±æ€§çš„å’Œ
System.out.println(personPojos.stream().mapToInt(PersonPojo::getCount).sum());
// æœ€å¤§å€¼
System.out.println(personPojos.stream().mapToInt(PersonPojo::getCount).max());
// æœ€å°å€¼
System.out.println(personPojos.stream().mapToInt(PersonPojo::getCount).min());
// å¹³å‡å€¼
System.out.println(personPojos.stream().mapToInt(PersonPojo::getCount).average());

// è·å–æŸä¸ªå±æ€§å€¼æœ€å¤§çš„é›†åˆ
Optional&amp;lt;PersonPojo&amp;gt; couponConfigOptional = personPojos.stream().
        filter(Objects::nonNull).
        filter(personPojo -&amp;gt; StringUtils.isNotEmpty(personPojo.getEndTime())).
        max(Comparator.comparing(PersonPojo::getEndTime));
couponConfigOptional.ifPresent(personPojo -&amp;gt; System.out.println(JSONObject.toJSONString(personPojo)));


// ä»¥å¯¹è±¡çš„æŸä¸ªå±æ€§åˆ†ç»„
Map&amp;lt;String, List&amp;lt;PersonPojo&amp;gt;&amp;gt; resultMap = personPojos.stream().collect(Collectors.groupingBy(PersonPojo::getName));
System.out.println(JSONObject.toJSONString(resultMap));

// ä»¥å¯¹è±¡æŸä¸ªå±æ€§åˆ†ç»„ï¼ŒåŒæ—¶åªå–åˆ—è¡¨ä¸­çš„ç¬¬ä¸€æ¡æ•°æ®
Map&amp;lt;String, PersonPojo&amp;gt; resultMap = personPojos.stream().collect(Collectors.groupingBy(PersonPojo::getName,Collectors.collectingAndThen(Collectors.toList(), value-&amp;gt;value.get(0)))))));
System.out.println(JSONObject.toJSONString(resultMap));

// ä»¥å¯¹è±¡çš„æŸä¸ªå±æ€§åˆ†ç»„ï¼Œå¹¶åªæ±‡æ€»æŸä¸€ä¸ªå±æ€§å­—æ®µ
Map&amp;lt;String, List&amp;lt;String&amp;gt;&amp;gt; map = personPojos.stream().collect(Collectors.groupingBy(PersonPojo::getId, Collectors.mapping(PersonPojo::getName, Collectors.toList())));
System.out.println(JSONObject.toJSONString(map));

// è¿‡æ»¤ä¸åŒ…å«æŸä¸ªå¯¹è±¡
List&amp;lt;PersonPojo&amp;gt; filters = personPojos.stream().filter(personPojo-&amp;gt;!personPojos.contains(personPojo)).collect(Collectors.toList());
System.out.println(JSONObject.toJSONString(filters));

// ç§»é™¤ä¸åœ¨æœ‰æ•ˆæœŸå†…çš„æ•°æ®
long currentTime = System.currentTimeMillis();
personPojos.removeIf(personPojo -&amp;gt; currentTime &amp;lt; personPojo.getStartTime().getTime() || currentTime &amp;gt; personPojo.getEndTime().getTime());

// è·å–æŸä¸ªå­—æ®µä½œä¸ºæ–°çš„list
List&amp;lt;String&amp;gt; names =personPojos.stream().map(PersonPojo::getName).collect(Collectors.toList());
System.out.println(JSONObject.toJSONString(names));

// è·å–æŸä¸ªå­—æ®µä½œä¸ºæ–°çš„listï¼Œå»é‡
List&amp;lt;String&amp;gt; distinctNames =personPojos.stream().map(PersonPojo::getName).distinct().collect(Collectors.toList());
System.out.println(JSONObject.toJSONString(distinctNames));

// åˆ¤æ–­å¯¹è±¡ç»„ä¸­æ˜¯å¦å­˜åœ¨åŒ…å«æŒ‡å®šå€¼çš„å¯¹è±¡
boolean match = personPojos.stream().anyMatch(personPojo -&amp;gt; &amp;quot;zhangsan&amp;quot;.equals(personPojo.getName()));
System.out.println(match);
// åˆ¤æ–­å¯¹è±¡ç»„æ˜¯å¦éƒ½æ˜¯åŒ…å«æŒ‡å®šå€¼çš„å¯¹è±¡
boolean match2 = personPojos.stream().allMatch(personPojo -&amp;gt; &amp;quot;zhangsan&amp;quot;.equals(personPojo.getName()));
System.out.println(match2);

//è¿”å› å¯¹è±¡é›†åˆä»¥ç±»å±æ€§ä¸€å‡åºæ’åº
list.stream().sorted(Comparator.comparing(ç±»::å±æ€§ä¸€));

//è¿”å› å¯¹è±¡é›†åˆä»¥ç±»å±æ€§ä¸€é™åºæ’åº æ³¨æ„ä¸¤ç§å†™æ³•
list.stream().sorted(Comparator.comparing(ç±»::å±æ€§ä¸€).reversed());//å…ˆä»¥å±æ€§ä¸€å‡åº,ç»“æœè¿›è¡Œå±æ€§ä¸€é™åº
list.stream().sorted(Comparator.comparing(ç±»::å±æ€§ä¸€,Comparator.reverseOrder()));//ä»¥å±æ€§ä¸€é™åº

//è¿”å› å¯¹è±¡é›†åˆä»¥ç±»å±æ€§ä¸€å‡åº å±æ€§äºŒå‡åº
list.stream().sorted(Comparator.comparing(ç±»::å±æ€§ä¸€).thenComparing(ç±»::å±æ€§äºŒ));

//è¿”å› å¯¹è±¡é›†åˆä»¥ç±»å±æ€§ä¸€é™åº å±æ€§äºŒå‡åº æ³¨æ„ä¸¤ç§å†™æ³•
//å…ˆä»¥å±æ€§ä¸€å‡åº,å‡åºç»“æœè¿›è¡Œå±æ€§ä¸€é™åº,å†è¿›è¡Œå±æ€§äºŒå‡åº
list.stream().sorted(Comparator.comparing(ç±»::å±æ€§ä¸€).reversed().thenComparing(ç±»::å±æ€§äºŒ));
//å…ˆä»¥å±æ€§ä¸€é™åº,å†è¿›è¡Œå±æ€§äºŒå‡åº
list.stream().sorted(Comparator.comparing(ç±»::å±æ€§ä¸€,Comparator.reverseOrder()).thenComparing(ç±»::å±æ€§äºŒ));

//è¿”å› å¯¹è±¡é›†åˆä»¥ç±»å±æ€§ä¸€é™åº å±æ€§äºŒé™åº æ³¨æ„ä¸¤ç§å†™æ³•
//å…ˆä»¥å±æ€§ä¸€å‡åº,å‡åºç»“æœè¿›è¡Œå±æ€§ä¸€é™åº,å†è¿›è¡Œå±æ€§äºŒé™åº
list.stream().sorted(Comparator.comparing(ç±»::å±æ€§ä¸€).reversed().thenComparing(ç±»::å±æ€§äºŒ,Comparator.reverseOrder()));
//å…ˆä»¥å±æ€§ä¸€é™åº,å†è¿›è¡Œå±æ€§äºŒé™åº
list.stream().sorted(Comparator.comparing(ç±»::å±æ€§ä¸€,Comparator.reverseOrder()).thenComparing(ç±»::å±æ€§äºŒ,Comparator.reverseOrder()));

//è¿”å› å¯¹è±¡é›†åˆä»¥ç±»å±æ€§ä¸€å‡åº å±æ€§äºŒé™åº æ³¨æ„ä¸¤ç§å†™æ³•
//å…ˆä»¥å±æ€§ä¸€å‡åº,å‡åºç»“æœè¿›è¡Œå±æ€§ä¸€é™åº,å†è¿›è¡Œå±æ€§äºŒå‡åº,ç»“æœè¿›è¡Œå±æ€§ä¸€é™åºå±æ€§äºŒé™åº
list.stream().sorted(Comparator.comparing(ç±»::å±æ€§ä¸€).reversed().thenComparing(ç±»::å±æ€§äºŒ).reversed());
//å…ˆä»¥å±æ€§ä¸€å‡åº,å†è¿›è¡Œå±æ€§äºŒé™åº
list.stream().sorted(Comparator.comparing(ç±»::å±æ€§ä¸€).thenComparing(ç±»::å±æ€§äºŒ,Comparator.reverseOrder()));

// å¤šå±æ€§åˆ†ç»„
Map&amp;lt;String, Map&amp;lt;String, List&amp;lt;PersonPojo&amp;gt;&amp;gt;&amp;gt; mapMap = personPojos.stream()
        .collect(Collectors.groupingBy(PersonPojo::getId, Collectors.groupingBy(PersonPojo::getName)));
System.out.println(JSONObject.toJSONString(mapMap));

// å¤šä¸ªå±æ€§åˆæˆä¸€ä¸ªå±æ€§
Map&amp;lt;String, List&amp;lt;PersonPojo&amp;gt;&amp;gt; map = personPojos.stream().collect(Collectors.groupingBy(Test5::fetchGroupKey));
System.out.println(JSONObject.toJSONString(map));
private static String fetchGroupKey(PersonPojo p) {
    return p.getId() + &amp;quot;_&amp;quot; + p.getName();
}

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;completablefuture&#34;&gt;CompletableFuture&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;package com.philosopherzb.demo.test;

import java.util.concurrent.CompletableFuture;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.ThreadLocalRandom;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.TimeoutException;

/**
 * @author philosopherZB
 * @date 2021/9/28
 */
public class Test10 {
    public static void main(String[] args) {
//        Test10.testThenAccept();
//        Test10.testThenRun();
//        Test10.testThenApply();
//        Test10.testThenCombine();
//        Test10.testThenCompose();
//        Test10.testApplyToEither();
//        Test10.testExceptionally();
//        Test10.testHandle();
        Test10.testAllOf();
//        Test10.testGet();
    }

    /**
     * åŠŸèƒ½: å½“å‰ä»»åŠ¡æ­£å¸¸å®Œæˆåæ‰§è¡Œï¼Œä¸”å½“å‰ä»»åŠ¡çš„è¿”å›å€¼å¯ä½œä¸ºä¸‹ä¸ªä»»åŠ¡çš„å…¥å‚ï¼›thenAcceptæœ¬èº«å¹¶æ²¡æœ‰è¿”å›å€¼
     * æ ·ä¾‹: æ¥å—ç¬¬ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œç»“æœçš„å­—ç¬¦ä¸²ï¼Œå¹¶å°†å…¶ä¸ç¬¬äºŒä¸ªä»»åŠ¡çš„å­—ç¬¦ä¸²è¿›è¡Œæ‹¼æ¥æ“ä½œ
     */
    private static void testThenAccept() {
        CompletableFuture&amp;lt;String&amp;gt; first = CompletableFuture.supplyAsync(() -&amp;gt; &amp;quot;first&amp;quot;);
        first.thenAccept(f -&amp;gt; {
            System.out.println(&amp;quot;accept firstFuture result: &amp;quot; + f);
            System.out.println(&amp;quot;Splicing result: &amp;quot; + f + &amp;quot;second&amp;quot;);
        }).whenComplete((aVoid, throwable) -&amp;gt; {
            if (throwable != null) {
                System.out.println(throwable.getLocalizedMessage());
            }
        });
    }

    /**
     * åŠŸèƒ½: å½“å‰ä»»åŠ¡æ­£å¸¸å®Œæˆåæ‰§è¡Œï¼›thenRunæœ¬èº«å¹¶æ²¡æœ‰è¿”å›å€¼
     * æ ·ä¾‹: å¼‚æ­¥é¡ºåºæ‰§è¡Œ
     */
    private static void testThenRun() {
        CompletableFuture&amp;lt;String&amp;gt; first = CompletableFuture.supplyAsync(() -&amp;gt; {
            System.out.println(&amp;quot;first&amp;quot;);
            return &amp;quot;first&amp;quot;;
        });
        first.thenRun(() -&amp;gt; System.out.println(&amp;quot;result: &amp;quot; + &amp;quot;second&amp;quot;)).whenComplete((aVoid, throwable) -&amp;gt; {
            if (throwable != null) {
                System.out.println(throwable.getLocalizedMessage());
            }
        });
    }

    /**
     * åŠŸèƒ½: å½“å‰ä»»åŠ¡æ­£å¸¸å®Œæˆåæ‰§è¡Œï¼Œä¸”å½“å‰ä»»åŠ¡çš„è¿”å›å€¼å¯ä½œä¸ºä¸‹ä¸ªä»»åŠ¡çš„å…¥å‚ï¼›thenApplyæœ¬èº«æœ‰è¿”å›å€¼
     * æ ·ä¾‹: æ¥å—ç¬¬ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œç»“æœçš„å­—ç¬¦ä¸²ï¼Œå¹¶å°†å…¶ä¸ç¬¬äºŒä¸ªä»»åŠ¡çš„å­—ç¬¦ä¸²è¿›è¡Œæ‹¼æ¥æ“ä½œï¼Œæœ€åå°†ç»“æœä¸ç¬¬ä¸‰ä¸ªä»»åŠ¡çš„å­—ç¬¦ä¸²æ‹¼æ¥ï¼ˆå¤šä¸ªä»»åŠ¡ä¸²è¡Œï¼‰
     */
    private static void testThenApply() {
        CompletableFuture&amp;lt;String&amp;gt; first = CompletableFuture.supplyAsync(() -&amp;gt; &amp;quot;first&amp;quot;);
        CompletableFuture&amp;lt;String&amp;gt; second = first.thenApply(f -&amp;gt; {
            System.out.println(&amp;quot;second accept firstFuture result: &amp;quot; + f);
            System.out.println(&amp;quot;second Splicing result: &amp;quot; + f + &amp;quot;second&amp;quot;);
            return f + &amp;quot;second&amp;quot;;
        }).whenComplete((aVoid, throwable) -&amp;gt; {
            if (throwable != null) {
                System.out.println(throwable.getLocalizedMessage());
            }
        });
        second.thenApply(s -&amp;gt; {
            System.out.println(&amp;quot;second.thenApply accept firstFuture result: &amp;quot; + s);
            System.out.println(&amp;quot;second.thenApply Splicing result: &amp;quot; + s + &amp;quot;third&amp;quot;);
            return s + &amp;quot;third&amp;quot;;
        }).whenComplete((r, throwable) -&amp;gt; {
            System.out.println(&amp;quot;third result: &amp;quot; + r);
            if (throwable != null) {
                System.out.println(throwable.getLocalizedMessage());
            }
        });
    }

    /**
     * åŠŸèƒ½: å¤„ç†ä¸¤ä¸ªCompletionStageçš„ç»“æœå¹¶è¿›è¡Œè¿”å›ï¼›thenCombine æœ¬èº«æœ‰è¿”å›å€¼
     * æ ·ä¾‹: æ‹¼æ¥å­—ç¬¦ä¸²
     */
    private static void testThenCombine() {
        CompletableFuture&amp;lt;String&amp;gt; first = CompletableFuture.supplyAsync(() -&amp;gt; &amp;quot;first&amp;quot;);
        CompletableFuture&amp;lt;String&amp;gt; second = CompletableFuture.supplyAsync(() -&amp;gt; &amp;quot;second&amp;quot;);
        // æœ‰è¿”å›å€¼
        first.thenCombine(second, (f, s) -&amp;gt; f + s).whenComplete((r, throwable) -&amp;gt; {
            System.out.println(&amp;quot;thenCombine result: &amp;quot; + r);
            if (throwable != null) {
                System.out.println(throwable.getLocalizedMessage());
            }
        });
        // æ— è¿”å›å€¼
        first.thenAcceptBoth(second, (f, s) -&amp;gt; {
            System.out.println(&amp;quot;thenAcceptBoth result: &amp;quot; + f + s);
        }).whenComplete((aVoid, throwable) -&amp;gt; {
            if (throwable != null) {
                System.out.println(throwable.getLocalizedMessage());
            }
        });
        // æ— è¿”å›å€¼, åœ¨ä¸¤ä¸ªä»»åŠ¡æ‰§è¡Œåæ‰§è¡Œ
        first.runAfterBoth(second, () -&amp;gt; {
            System.out.println(&amp;quot;runAfterBoth result: &amp;quot;);
        }).whenComplete((aVoid, throwable) -&amp;gt; {
            if (throwable != null) {
                System.out.println(throwable.getLocalizedMessage());
            }
        });
    }

    /**
     * åŠŸèƒ½: å¤„ç†ä¸¤ä¸ªCompletionStageçš„ç»“æœå¹¶è¿›è¡Œè¿”å›, ä¸thenApplyç±»ä¼¼ï¼Œä¸è¿‡lambdaæ¥å—çš„æ˜¯ä¸€ä¸ªCompletableFutureï¼›thenCompose æœ¬èº«æœ‰è¿”å›å€¼
     * æ ·ä¾‹: æ‹¼æ¥å­—ç¬¦ä¸²
     */
    private static void testThenCompose() {
        CompletableFuture&amp;lt;String&amp;gt; first = CompletableFuture.supplyAsync(() -&amp;gt; &amp;quot;first&amp;quot;);
        CompletableFuture&amp;lt;String&amp;gt; second = CompletableFuture.supplyAsync(() -&amp;gt; &amp;quot;second&amp;quot;);
        // æœ‰è¿”å›å€¼
        first.thenCompose(f -&amp;gt; second.thenApply(s -&amp;gt; f + s)).whenComplete((r, throwable) -&amp;gt; {
            System.out.println(&amp;quot;thenCompose result: &amp;quot; + r);
            if (throwable != null) {
                System.out.println(throwable.getLocalizedMessage());
            }
        });
    }

    /**
     * åŠŸèƒ½: è¿è¡Œä¸¤ä¸ªCompletionStageï¼Œå¹¶å°†æœ€å…ˆå¤„ç†ç»“æŸçš„ç»“æœè¿”å›ï¼›applyToEither æœ¬èº«æœ‰è¿”å›å€¼
     * æ ·ä¾‹: è¿”å›æœ€å¿«å¤„ç†ç»“æœ
     */
    private static void testApplyToEither() {
        CompletableFuture&amp;lt;String&amp;gt; first = CompletableFuture.supplyAsync(() -&amp;gt; {
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            return &amp;quot;first-sleep-1000&amp;quot;;
        });
        CompletableFuture&amp;lt;String&amp;gt; second = CompletableFuture.supplyAsync(() -&amp;gt; {
            try {
                Thread.sleep(2000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            return &amp;quot;second-sleep-2000&amp;quot;;
        });
        // è·å–ä¸€ä¸‹è¿”å›å€¼ï¼Œå¦åˆ™ä»¥ä¸‹ä»£ç ä¸ä¼šæ‰§è¡Œ
        System.out.println(&amp;quot;=====&amp;gt;&amp;quot; + second.join());
        // æœ‰è¿”å›å€¼
        CompletableFuture&amp;lt;String&amp;gt; third = first.applyToEither(second, s -&amp;gt; s).whenComplete((r, throwable) -&amp;gt; {
            System.out.println(&amp;quot;applyToEither result: &amp;quot; + r);
            if (throwable != null) {
                System.out.println(throwable.getLocalizedMessage());
            }
        });
        // æ— è¿”å›å€¼
        first.acceptEither(second, s -&amp;gt; {
            System.out.println(&amp;quot;acceptEither result: &amp;quot; + s);
        }).whenComplete((aVoid, throwable) -&amp;gt; {
            if (throwable != null) {
                System.out.println(throwable.getLocalizedMessage());
            }
        });
        // æ— è¿”å›å€¼, åœ¨ä¸¤ä¸ªä»»åŠ¡æ‰§è¡Œåæ‰§è¡Œ
        first.runAfterEither(second, () -&amp;gt; {
            System.out.println(&amp;quot;runAfterEither result: &amp;quot;);
        }).whenComplete((aVoid, throwable) -&amp;gt; {
            if (throwable != null) {
                System.out.println(throwable.getLocalizedMessage());
            }
        });
    }

    /**
     * åŠŸèƒ½: å¤„ç†è¿è¡Œæ—¶å¼‚å¸¸ï¼Œå¹¶è¿›è¡Œé¢å¤–çš„è¡¥å¿æ“ä½œï¼ˆç±»ä¼¼äºtry catchï¼‰ï¼›exceptionally æœ¬èº«æœ‰è¿”å›å€¼
     * æ ·ä¾‹: å¤„ç†å¼‚å¸¸
     */
    private static void testExceptionally() {
        // å‘ç”Ÿå¼‚å¸¸ï¼ŒthenApplyä¸ä¼šæ‰§è¡Œï¼ˆthenApplyå¿…é¡»åœ¨ç¨‹åºæ­£å¸¸è¿è¡Œåæ‰ä¼šæ‰§è¡Œï¼‰
        CompletableFuture.supplyAsync(() -&amp;gt; &amp;quot;result: &amp;quot; + (3 / 0))
                .thenApply(s -&amp;gt; {
                    System.out.println(&amp;quot;first not running: &amp;quot; + s);
                    return s;
                })
                .exceptionally(throwable -&amp;gt; {
                    System.out.println(&amp;quot;first e: &amp;quot; + throwable.getLocalizedMessage());
                    return &amp;quot;first occur exception&amp;quot;;
                })
                .whenComplete((r, throwable) -&amp;gt; {
                    System.out.println(&amp;quot;first exceptionally result: &amp;quot; + r);
                    if (throwable != null) {
                        System.out.println(throwable.getLocalizedMessage());
                    }
                });
        // æ­£å¸¸è¿è¡Œï¼ŒthenApplyæ‰§è¡Œ
        CompletableFuture.supplyAsync(() -&amp;gt; &amp;quot;result: &amp;quot; + (3 / 1))
                .thenApply(s -&amp;gt; {
                    System.out.println(&amp;quot;second running: &amp;quot; + s);
                    return s;
                })
                .exceptionally(throwable -&amp;gt; {
                    System.out.println(&amp;quot;second e: &amp;quot; + throwable.getLocalizedMessage());
                    return &amp;quot;second occur exception&amp;quot;;
                })
                .whenComplete((r, throwable) -&amp;gt; {
                    System.out.println(&amp;quot;second exceptionally result: &amp;quot; + r);
                    if (throwable != null) {
                        System.out.println(throwable.getLocalizedMessage());
                    }
                });
    }

    /**
     * åŠŸèƒ½: handleç±»ä¼¼äºwhenCompleteï¼ŒåŒºåˆ«åœ¨äºï¼šhandle æœ‰è¿”å›å€¼ï¼Œ whenComplete æ— è¿”å›å€¼
     * æ ·ä¾‹: æ‰“å°è¿”å›å€¼
     */
    private static void testHandle() {
        // å‘ç”Ÿå¼‚å¸¸ï¼ŒthenApplyä¸ä¼šæ‰§è¡Œï¼ˆthenApplyå¿…é¡»åœ¨ç¨‹åºæ­£å¸¸è¿è¡Œåæ‰ä¼šæ‰§è¡Œï¼‰
        CompletableFuture&amp;lt;String&amp;gt; first = CompletableFuture.supplyAsync(() -&amp;gt; &amp;quot;result: &amp;quot; + (3 / 0))
                .thenApply(s -&amp;gt; {
                    System.out.println(&amp;quot;first not running: &amp;quot; + s);
                    return s;
                })
                .exceptionally(throwable -&amp;gt; {
                    System.out.println(&amp;quot;first e: &amp;quot; + throwable.getLocalizedMessage());
                    return &amp;quot;first occur exception&amp;quot;;
                })
                .handle((r, throwable) -&amp;gt; {
                    System.out.println(&amp;quot;first handle result: &amp;quot; + r);
                    if (throwable != null) {
                        System.out.println(throwable.getLocalizedMessage());
                    }
                    return r;
                });
        // æ­£å¸¸è¿è¡Œï¼ŒthenApplyæ‰§è¡Œ
        CompletableFuture&amp;lt;String&amp;gt; second = CompletableFuture.supplyAsync(() -&amp;gt; &amp;quot;result: &amp;quot; + (3 / 1))
                .thenApply(s -&amp;gt; {
                    System.out.println(&amp;quot;second running: &amp;quot; + s);
                    return s;
                })
                .exceptionally(throwable -&amp;gt; {
                    System.out.println(&amp;quot;second e: &amp;quot; + throwable.getLocalizedMessage());
                    return &amp;quot;second occur exception&amp;quot;;
                })
                .handle((r, throwable) -&amp;gt; {
                    System.out.println(&amp;quot;second handle result: &amp;quot; + r);
                    if (throwable != null) {
                        System.out.println(throwable.getLocalizedMessage());
                    }
                    return r;
                });

        System.out.println(&amp;quot;join result: &amp;quot; + first.join());
        System.out.println(&amp;quot;join result: &amp;quot; + second.join());
    }

    /**
     * åŠŸèƒ½: æ‰€æœ‰ä»»åŠ¡å®Œæˆåæ‰§è¡Œ:allOf; ä»»æ„ä»»åŠ¡å®Œæˆåæ‰§è¡Œï¼šanyOf
     * æ ·ä¾‹: å¼‚æ­¥æŸ¥è¯¢ä¸‰ä¸ªä»»åŠ¡ä¿¡æ¯å¹¶è¿”å›
     */
    private static void testAllOf() {
        ExecutorService executorService = Executors.newFixedThreadPool(3);
        long start = System.currentTimeMillis();

        CompletableFuture&amp;lt;String&amp;gt; first = CompletableFuture.supplyAsync(() -&amp;gt; {
            try {
                Thread.sleep(1000 + ThreadLocalRandom.current().nextInt(1000));
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            return &amp;quot;first&amp;quot;;
        }, executorService);
        CompletableFuture&amp;lt;String&amp;gt; second = CompletableFuture.supplyAsync(() -&amp;gt; {
            try {
                Thread.sleep(1000 + ThreadLocalRandom.current().nextInt(1000));
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            return &amp;quot;second&amp;quot;;
        }, executorService);
        CompletableFuture&amp;lt;String&amp;gt; third = CompletableFuture.supplyAsync(() -&amp;gt; {
            try {
                Thread.sleep(1000 + ThreadLocalRandom.current().nextInt(1000));
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            return &amp;quot;third&amp;quot;;
        }, executorService);
        // æ‰€æœ‰ä»»åŠ¡å®Œæˆåæ‰§è¡Œ
        CompletableFuture.allOf(first, second, third).join();
        System.out.println(first.join() + second.join() + third.join());
        System.out.println(System.currentTimeMillis() - start);

        // ä»»æ„ä»»åŠ¡å®Œæˆåæ‰§è¡Œ
        CompletableFuture.anyOf(first, second, third).join();
        System.out.println(first.join() + second.join() + third.join());
        System.out.println(System.currentTimeMillis() - start);
    }

    /**
     * è·å–è¿”å›å€¼
     */
    private static void testGet() {
        CompletableFuture cf = CompletableFuture.supplyAsync(() -&amp;gt; &amp;quot;content&amp;quot;).whenComplete(((result, throwable) -&amp;gt; {
            System.out.println(&amp;quot;result: &amp;quot; + result);
            if (throwable != null) {
                System.out.println(throwable.getLocalizedMessage());
            }
        }));
        try {
            System.out.println(&amp;quot;cf get: &amp;quot; + cf.get());
            System.out.println(&amp;quot;cf getWithTimeOut: &amp;quot; + cf.get(1, TimeUnit.SECONDS));
            System.out.println(&amp;quot;cf join: &amp;quot; + cf.join());
        } catch (InterruptedException | ExecutionException | TimeoutException e) {
            e.printStackTrace();
        }

    }
}

&lt;/code&gt;&lt;/pre&gt;
">Java8æ–°ç‰¹æ€§Stream&CompletableFuture</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://philosopherzb.github.io/post/arraylist-yuan-ma-jie-xi-jdk8/"" data-c="
          &lt;h2 id=&#34;æºç æ¥è‡ªäºjdk8&#34;&gt;æºç æ¥è‡ªäºJDK8&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;package java.util;

import java.util.function.Consumer;
import java.util.function.Predicate;
import java.util.function.UnaryOperator;
import sun.misc.SharedSecrets;

//å…¶ä¸­å®ç°äº†RandomAccessæ¥å£è¡¨ç¤ºæ”¯æŒéšæœºè®¿é—®
public class ArrayList&amp;lt;E&amp;gt; extends AbstractList&amp;lt;E&amp;gt;
        implements List&amp;lt;E&amp;gt;, RandomAccess, Cloneable, java.io.Serializable
{
    //åºåˆ—å·
    private static final long serialVersionUID = 8683452581122892189L;

    /**
     * é»˜è®¤åˆå§‹å®¹é‡
     */
    private static final int DEFAULT_CAPACITY = 10;

    /**
     * å…±äº«çš„ç©ºæ•°ç»„å®ä¾‹ï¼ˆç”¨äºç©ºå®ä¾‹ï¼‰
     * å½“ArrayList(int initialCapacity)ï¼ŒArrayList(Collection&amp;lt;? extends E&amp;gt; c)ä¸­çš„å®¹é‡ç­‰äº0çš„æ—¶å€™ä½¿ç”¨
     */
    private static final Object[] EMPTY_ELEMENTDATA = {};

    /**
     * å…±äº«çš„ç©ºæ•°ç»„å®ä¾‹ï¼ˆç”¨äºé»˜è®¤å¤§å°çš„ç©ºå®ä¾‹ï¼‰
     * å°†å…¶ä¸EMPTY_ELEMENTDATAåŒºåˆ†å¼€æ¥ï¼Œä¸»è¦æ˜¯ä¸ºäº†çŸ¥é“ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ çš„æ—¶å€™éœ€è¦æ‰©å®¹å¤šå°‘
     * ç”¨äºArrayList()æ„é€ å™¨
     */
    private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};

    /**
     * ArrayListä¿å­˜æœ‰åºå…ƒç´ çš„æ•°ç»„
     * ArraylListå®¹é‡ä¸ºæ•°ç»„å®¹é‡
     * ä»»ä½•ç©ºæ•°ç»„éƒ½ä½¿ç”¨ elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA
     * å½“ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ çš„æ—¶å€™å…¶å®¹é‡å°†ä¼šæ‰©å®¹è‡³ DEFAULT_CAPACITYï¼ˆ10ï¼‰
     */
    transient Object[] elementData; // non-private to simplify nested class access

    /**
     * ArrayListçš„å¤§å°ï¼ˆåŒ…å«å…ƒç´ çš„æ•°é‡ï¼‰
     * @serial
     */
    private int size;

    /**
     * å¸¦æŒ‡å®šå®¹é‡å‚æ•°çš„æ„é€ å™¨ï¼Œå¦‚æœå…ƒç´ æ•°é‡è¾ƒå¤§çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨æ­¤æ„é€ å™¨ï¼Œé˜²æ­¢é¢‘ç¹æ‰©å®¹é€ æˆçš„æ€§èƒ½æŸå¤±
     */
    public ArrayList(int initialCapacity) {
        //å¦‚æœä¼ å…¥å€¼å¤§äº0ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªè¯¥å®¹é‡å¤§å°çš„æ•°ç»„ã€‚
        if (initialCapacity &amp;gt; 0) {
            this.elementData = new Object[initialCapacity];
        } else if (initialCapacity == 0) {
            //å¦åˆ™å¦‚æœä¼ å…¥å€¼ç­‰äº0ï¼Œåˆ™åˆ›å»ºé»˜è®¤ç©ºæ•°ç»„
            this.elementData = EMPTY_ELEMENTDATA;
        } else {
            //å¦‚æœå°äº0åˆ™æŠ›å‡ºå¼‚å¸¸
            throw new IllegalArgumentException(&amp;quot;Illegal Capacity: &amp;quot;+
                    initialCapacity);
        }
    }

    /**
     * é»˜è®¤æ„é€ å‡½æ•°ï¼Œå…¶åˆå§‹å®¹é‡ä¸º10ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œä¸€å¼€å§‹å…¶å®æ˜¯ä¸€ä¸ªç©ºæ•°ç»„ï¼Œåªæ˜¯å½“addæ—¶æ‰ä¼šè¿›è¡Œæ‰©å®¹è‡³10çš„æ“ä½œï¼Œä¸€å®šç¨‹åº¦ä¸Šå‡å°äº†å†…å­˜æ¶ˆè€—ã€‚ï¼‰
     */
    public ArrayList() {
        this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;
    }

    /**
     * æ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šé›†åˆå…ƒç´ çš„åˆ—è¡¨ï¼Œå…ƒç´ é¡ºåºç”±é›†åˆçš„è¿­ä»£å™¨æ‰€è¿”å›ã€‚
     */
    public ArrayList(Collection&amp;lt;? extends E&amp;gt; c) {
        //é›†åˆè½¬æ•°ç»„
        elementData = c.toArray();
        //æŒ‡å®šé›†åˆå«æœ‰å…ƒç´ 
        if ((size = elementData.length) != 0) {
            // c.toArrayå¯èƒ½ä¸ä¼šè¿”å›Object[] (see 6260652)
            //ä½¿ç”¨åå°„è¿›è¡Œè¿è¡Œæ—¶åˆ¤æ–­elementDataæ˜¯å¦å±äºObject[]
            if (elementData.getClass() != Object[].class)
                //æ‹·è´æ•°ç»„
                elementData = Arrays.copyOf(elementData, size, Object[].class);
        } else {
            // ç”±ç©ºæ•°ç»„ä»£æ›¿
            this.elementData = EMPTY_ELEMENTDATA;
        }
    }

    /**
     * ä¿®æ”¹ArrayListå®¹é‡ä¸ºlistçš„å½“å‰å¤§å°
     * ä¸€ä¸ªåº”ç”¨å¯ä»¥ä½¿ç”¨æ­¤æ“ä½œæ¥æœ€å°åŒ–ä¸€ä¸ªArrayListçš„å­˜å‚¨
     */
    public void trimToSize() {
        modCount++;
        //å¦‚æœå½“å‰æ•°ç»„å…ƒç´ ä¸ªæ•°å°äºæ•°ç»„å®¹é‡
        if (size &amp;lt; elementData.length) {
            //æ²¡æœ‰å…ƒç´ è¿”å›ç©ºæ•°ç»„ï¼Œå¦åˆ™è¿”å›å…ƒç´ ä¸ªæ•°çš„æ•°ç»„ã€‚
            elementData = (size == 0)
                    ? EMPTY_ELEMENTDATA
                    : Arrays.copyOf(elementData, size);
        }
    }

    /**
     * å¦‚æœæœ‰å¿…è¦å»å¢åŠ ArrayListçš„å®¹é‡ï¼Œè¯·ç¡®ä¿å®ƒè‡³å°‘å¯ä»¥å®¹çº³ç”±æœ€å°å®¹é‡å‚æ•°æŒ‡å®šçš„å…ƒç´ æ•°é‡
     * @param   minCapacity   æ‰€éœ€çš„æœ€å°å®¹é‡
     */
    public void ensureCapacity(int minCapacity) {
        //é»˜è®¤æœ€å°å®¹é‡ï¼Œç©ºæ•°ç»„ä»¥åŠé»˜è®¤å¤§å°10
        int minExpand = (elementData != DEFAULTCAPACITY_EMPTY_ELEMENTDATA)
                // any size if not default element table
                ? 0
                // larger than default for default empty table. It&#39;s already
                // supposed to be at default size.
                : DEFAULT_CAPACITY;

        //å¦‚æœä¼ å…¥å®¹é‡å¤§äºæœ€å°å®¹é‡ï¼Œåˆ™è¿›è¡Œæ‰©å®¹
        if (minCapacity &amp;gt; minExpand) {
            ensureExplicitCapacity(minCapacity);
        }
    }

    private static int calculateCapacity(Object[] elementData, int minCapacity) {
        //å¦‚æœelementDataä¸ºé»˜è®¤ç©ºæ•°ç»„ï¼Œåˆ™æ¯”è¾ƒä¼ å…¥å€¼ä¸é»˜è®¤å€¼ï¼ˆ10ï¼‰ï¼Œè¿”å›ä¸¤è€…ä¸­çš„è¾ƒå¤§å€¼
        //elementDataä¸ºé»˜è®¤ç©ºæ•°ç»„æŒ‡çš„æ˜¯é€šè¿‡ArrayList()è¿™ä¸ªæ„é€ å™¨åˆ›å»ºçš„ArrayListå¯¹è±¡
        if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {
            return Math.max(DEFAULT_CAPACITY, minCapacity);
        }
        //è¿”å›ä¼ å…¥å€¼
        return minCapacity;
    }

    private void ensureCapacityInternal(int minCapacity) {
        //å…ˆé€šè¿‡calculateCapacityæ–¹æ³•è®¡ç®—æœ€ç»ˆå®¹é‡ï¼Œä»¥ç¡®è®¤å®é™…å®¹é‡
        ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));
    }

    private void ensureExplicitCapacity(int minCapacity) {
        modCount++;

        // overflow-conscious code
        //å¦‚æœæœ€ç»ˆç¡®è®¤å®¹é‡å¤§äºæ•°ç»„å®¹é‡ï¼Œåˆ™è¿›è¡Œgrow()æ‰©å®¹
        if (minCapacity - elementData.length &amp;gt; 0)
            grow(minCapacity);
    }

    /**
     * å¯åˆ†é…æ•°ç»„æœ€å¤§å¤§å°
     */
    private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;

    /**
     * å¢åŠ ArrayListçš„å®¹é‡ï¼Œä»¥ç¡®ä¿å®ƒè‡³å°‘å¯ä»¥å®¹çº³ç”±æœ€å°å®¹é‡å‚æ•°æŒ‡å®šçš„å…ƒç´ æ•°é‡
     * @param minCapacity æ‰€éœ€çš„æœ€å°å®¹é‡
     */
    private void grow(int minCapacity) {
        // overflow-conscious code
        //oldCapacityè¡¨ç¤ºæ—§å®¹é‡
        int oldCapacity = elementData.length;
        //newCapacityè¡¨ç¤ºæ–°å®¹é‡ï¼Œè®¡ç®—è§„åˆ™ä¸ºæ—§å®¹é‡+æ—§å®¹é‡çš„0.5ï¼Œå³æ—§å®¹é‡çš„1.5å€ã€‚å¦‚æœè¶…è¿‡intçš„æœ€å¤§å€¼ä¼šè¿”å›ä¸€ä¸ªè´Ÿæ•°ã€‚
        //oldCapacity &amp;gt;&amp;gt; 1è¡¨ç¤ºå³ç§»ä¸€ä½ï¼Œå¯¹åº”é™¤ä»¥2çš„1æ¬¡æ–¹ã€‚
        int newCapacity = oldCapacity + (oldCapacity &amp;gt;&amp;gt; 1);
        //å¦‚æœæ–°å®¹é‡å°äºæœ€å°å®¹é‡ï¼Œåˆ™å°†æœ€å°å®¹é‡èµ‹å€¼ç»™æ–°å®¹é‡(æœ‰æ—¶æ‰‹åŠ¨æ‰©å®¹å¯èƒ½ä¹Ÿä¼šè¿”å›&amp;lt;0ï¼Œå¯¹åº”æ–¹æ³•ä¸ºensureCapacity())
        if (newCapacity - minCapacity &amp;lt; 0)
            newCapacity = minCapacity;
        //å¦‚æœæ–°å®¹é‡å¤§äºMAX_ARRAY_SIZEï¼Œåˆ™æ‰§è¡ŒhugeCapacity(minCapacity)è¿”å›å¯¹åº”å€¼
        if (newCapacity - MAX_ARRAY_SIZE &amp;gt; 0)
            newCapacity = hugeCapacity(minCapacity);
        // minCapacity is usually close to size, so this is a win:
        //å¤åˆ¶æ—§æ•°ç»„åˆ°æ–°å®¹é‡æ•°ç»„ä¸­ï¼Œå®Œæˆæ‰©å®¹æ“ä½œ
        elementData = Arrays.copyOf(elementData, newCapacity);
    }

    private static int hugeCapacity(int minCapacity) {
        //å¦‚æœæœ€å°å®¹é‡è¶…è¿‡äº†intçš„æœ€å¤§å€¼ï¼ŒminCapacityä¼šæ˜¯ä¸€ä¸ªè´Ÿæ•°ï¼Œæ­¤æ—¶æŠ›å‡ºå†…å­˜æº¢å‡ºé”™è¯¯
        if (minCapacity &amp;lt; 0) // overflow
            throw new OutOfMemoryError();
        //æ¯”è¾ƒæœ€å°å®¹é‡æ˜¯å¦å¤§äºMAX_ARRAY_SIZEï¼Œå¦‚æœæ˜¯åˆ™è¿”å›Integer.MAX_VALUEï¼Œå¦åˆ™è¿”å›MAX_ARRAY_SIZE
        return (minCapacity &amp;gt; MAX_ARRAY_SIZE) ?
                Integer.MAX_VALUE :
                MAX_ARRAY_SIZE;
    }

    /**
     * è¿”å›åˆ—è¡¨å…ƒç´ æ•°
     */
    public int size() {
        return size;
    }

    /**
     * å¦‚æœåˆ—è¡¨ä¸åŒ…å«å…ƒç´ ï¼Œè¿”å›true
     */
    public boolean isEmpty() {
        return size == 0;
    }

    /**
     * å¦‚æœåˆ—è¡¨åŒ…å«æŒ‡å®šå…ƒç´ ï¼Œè¿”å›true
     */
    public boolean contains(Object o) {
        //è¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šå…ƒç´ ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œå¦‚æœåˆ—è¡¨ä¸­ä¸åŒ…å«æŒ‡å®šå…ƒç´ ï¼Œåˆ™ä¸º-1
        return indexOf(o) &amp;gt;= 0;
    }

    /**
     * è¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šå…ƒç´ ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œå¦‚æœåˆ—è¡¨ä¸­ä¸åŒ…å«æŒ‡å®šå…ƒç´ ï¼Œåˆ™ä¸º-1
     */
    public int indexOf(Object o) {
        if (o == null) {
            for (int i = 0; i &amp;lt; size; i++)
                if (elementData[i]==null)
                    return i;
        } else {
            for (int i = 0; i &amp;lt; size; i++)
                if (o.equals(elementData[i]))
                    return i;
        }
        return -1;
    }

    /**
     * è¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šå…ƒç´ æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œå¦‚æœåˆ—è¡¨ä¸­ä¸åŒ…å«æŒ‡å®šå…ƒç´ ï¼Œåˆ™ä¸º-1
     */
    public int lastIndexOf(Object o) {
        if (o == null) {
            for (int i = size-1; i &amp;gt;= 0; i--)
                if (elementData[i]==null)
                    return i;
        } else {
            for (int i = size-1; i &amp;gt;= 0; i--)
                if (o.equals(elementData[i]))
                    return i;
        }
        return -1;
    }

    /**
     * è¿”å›ArrayListå®ä¾‹çš„ä¸€ä¸ªæµ…æ‹·è´ï¼Œåˆ—è¡¨ä¸­çš„å…ƒç´ ä¸ä¼šè¢«æ‹·è´
     */
    public Object clone() {
        try {
            ArrayList&amp;lt;?&amp;gt; v = (ArrayList&amp;lt;?&amp;gt;) super.clone();
            v.elementData = Arrays.copyOf(elementData, size);
            v.modCount = 0;
            return v;
        } catch (CloneNotSupportedException e) {
            // this shouldn&#39;t happen, since we are Cloneable
            throw new InternalError(e);
        }
    }

    /**
     * ä»¥æ­£ç¡®çš„é¡ºåºï¼ˆä»ç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ªå…ƒç´ ï¼‰è¿”å›ä¸€ä¸ªåŒ…å«æ­¤åˆ—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„æ•°ç»„ã€‚
     * è¿”å›çš„æ•°ç»„å°†æ˜¯â€œå®‰å…¨çš„â€ï¼Œå› ä¸ºè¯¥åˆ—è¡¨ä¸ä¿ç•™å¯¹å®ƒçš„å¼•ç”¨ã€‚ ï¼ˆæ¢å¥è¯è¯´ï¼Œè¿™ä¸ªæ–¹æ³•å¿…é¡»åˆ†é…ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼‰ã€‚
     * å› æ­¤ï¼Œè°ƒç”¨è€…å¯ä»¥è‡ªç”±åœ°ä¿®æ”¹è¿”å›çš„æ•°ç»„ã€‚ æ­¤æ–¹æ³•å……å½“åŸºäºé˜µåˆ—å’ŒåŸºäºé›†åˆçš„APIä¹‹é—´çš„æ¡¥æ¢ã€‚
     */
    public Object[] toArray() {
        return Arrays.copyOf(elementData, size);
    }

    /**
     * ä»¥æ­£ç¡®çš„é¡ºåºè¿”å›ä¸€ä¸ªåŒ…å«æ­¤åˆ—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„æ•°ç»„ï¼ˆä»ç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ªå…ƒç´ ï¼‰;
     * è¿”å›çš„æ•°ç»„çš„è¿è¡Œæ—¶ç±»å‹æ˜¯æŒ‡å®šæ•°ç»„çš„è¿è¡Œæ—¶ç±»å‹ã€‚ å¦‚æœåˆ—è¡¨é€‚åˆæŒ‡å®šçš„æ•°ç»„ï¼Œåˆ™è¿”å›å…¶ä¸­ã€‚
     * å¦åˆ™ï¼Œå°†ä¸ºæŒ‡å®šæ•°ç»„çš„è¿è¡Œæ—¶ç±»å‹å’Œæ­¤åˆ—è¡¨çš„å¤§å°åˆ†é…ä¸€ä¸ªæ–°æ•°ç»„ã€‚
     * å¦‚æœåˆ—è¡¨é€‚ç”¨äºæŒ‡å®šçš„æ•°ç»„ï¼Œå…¶ä½™ç©ºé—´ï¼ˆå³æ•°ç»„çš„åˆ—è¡¨æ•°é‡å¤šäºæ­¤å…ƒç´ ï¼‰ï¼Œåˆ™ç´§è·Ÿåœ¨é›†åˆç»“æŸåçš„æ•°ç»„ä¸­çš„å…ƒç´ è®¾ç½®ä¸ºnull ã€‚
     *ï¼ˆè¿™ä»…åœ¨è°ƒç”¨è€…çŸ¥é“åˆ—è¡¨ä¸åŒ…å«ä»»ä½•ç©ºå…ƒç´ çš„æƒ…å†µä¸‹æ‰èƒ½ç¡®å®šåˆ—è¡¨çš„é•¿åº¦ã€‚ï¼‰
     */
    @SuppressWarnings(&amp;quot;unchecked&amp;quot;)
    public &amp;lt;T&amp;gt; T[] toArray(T[] a) {
        if (a.length &amp;lt; size)
            //åˆ›å»ºä¸€ä¸ªæ–°çš„è¿è¡Œæ—¶ç±»å‹æ•°ç»„ï¼Œå†…å®¹ä¸ºArrayListæ•°ç»„çš„
            return (T[]) Arrays.copyOf(elementData, size, a.getClass());
        System.arraycopy(elementData, 0, a, 0, size);
        if (a.length &amp;gt; size)
            a[size] = null;
        return a;
    }

    // ä½ç½®è®¿é—®æ“ä½œ

    @SuppressWarnings(&amp;quot;unchecked&amp;quot;)
    E elementData(int index) {
        return (E) elementData[index];
    }

    /**
     * è¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ 
     */
    public E get(int index) {
        //æ£€æŸ¥ç´¢å¼•æ˜¯å¦è¶Šç•Œ
        rangeCheck(index);

        return elementData(index);
    }

    /**
     * ç”¨æŒ‡å®šå…ƒç´ æ›¿æ¢åˆ—è¡¨ä¸­çš„æŒ‡å®šä½ç½®çš„å…ƒç´ 
     */
    public E set(int index, E element) {
        //æ£€æŸ¥ç´¢å¼•æ˜¯å¦è¶Šç•Œ
        rangeCheck(index);

        E oldValue = elementData(index);
        elementData[index] = element;
        return oldValue;
    }

    /**
     * å°†æŒ‡å®šå…ƒç´ è¿½åŠ åˆ°æ•°ç»„æœ«å°¾
     */
    public boolean add(E e) {
        //æ·»åŠ ä¹‹å‰å…ˆç¡®è®¤æ˜¯å¦éœ€è¦æ‰©å®¹
        ensureCapacityInternal(size + 1);  // Increments modCount!!
        //æ–°åŠ å…¥çš„å…ƒç´ æ˜¯æ·»åŠ åœ¨äº†æ•°ç»„çš„æœ«å°¾ï¼Œéšåæ•°ç»„sizeè‡ªå¢ã€‚
        elementData[size++] = e;
        return true;
    }

    /**
     * æ’å…¥æŒ‡å®šå…ƒç´ åˆ°æ­¤åˆ—è¡¨ä¸­çš„æŒ‡å®šä½ç½®
     * å…ˆè°ƒç”¨ rangeCheckForAdd å¯¹indexè¿›è¡Œç•Œé™æ£€æŸ¥ï¼›ç„¶åè°ƒç”¨ ensureCapacityInternal æ–¹æ³•ä¿è¯capacityè¶³å¤Ÿå¤§ï¼›
     * å†å°†ä»indexå¼€å§‹ä¹‹åçš„æ‰€æœ‰æˆå‘˜åç§»ä¸€ä¸ªä½ç½®ï¼›å°†elementæ’å…¥indexä½ç½®ï¼›æœ€åsizeåŠ 1ã€‚
     */
    public void add(int index, E element) {
        rangeCheckForAdd(index);

        ensureCapacityInternal(size + 1);  // Increments modCount!!
        //è‡ªå·±å¤åˆ¶è‡ªå·±
        System.arraycopy(elementData, index, elementData, index + 1,
                size - index);
        elementData[index] = element;
        size++;
    }

    /**
     * å°†åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ç§»é™¤ï¼Œåç»­æ‰€æœ‰å…ƒç´ ç§»åˆ°å·¦ç«¯ï¼ˆä»ä»–ä»¬çš„ç´¢å¼•ä¸­å‡å»ä¸€ä¸ªï¼‰
     */
    public E remove(int index) {
        rangeCheck(index);

        modCount++;
        E oldValue = elementData(index);

        int numMoved = size - index - 1;
        if (numMoved &amp;gt; 0)
            System.arraycopy(elementData, index+1, elementData, index,
                    numMoved);
        elementData[--size] = null; //  æ¸…ç†å·¥ä½œäº¤ç»™GC

        return oldValue;
    }

    /**
     * ä»åˆ—è¡¨ä¸­ç§»é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ä¸æ›´æ”¹
     */
    public boolean remove(Object o) {
        if (o == null) {
            for (int index = 0; index &amp;lt; size; index++)
                if (elementData[index] == null) {
                    fastRemove(index);
                    return true;
                }
        } else {
            for (int index = 0; index &amp;lt; size; index++)
                if (o.equals(elementData[index])) {
                    fastRemove(index);
                    return true;
                }
        }
        return false;
    }

    /*
     * Private remove method that skips bounds checking and does not
     * return the value removed.
     */
    private void fastRemove(int index) {
        modCount++;
        int numMoved = size - index - 1;
        if (numMoved &amp;gt; 0)
            System.arraycopy(elementData, index+1, elementData, index,
                    numMoved);
        elementData[--size] = null; // clear to let GC do its work
    }

    /**
     * ç§»é™¤åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œä¹‹åä¼šè¿”å›ä¸€ä¸ªç©ºæ•°ç»„
     */
    public void clear() {
        modCount++;

        // clear to let GC do its work
        for (int i = 0; i &amp;lt; size; i++)
            elementData[i] = null;

        size = 0;
    }

    /**
     * å°†æŒ‡å®šé›†åˆä¸­çš„å…ƒç´ ä»¥Iteratorè¿”å›çš„é¡ºåºï¼Œè¿½åŠ åˆ°åˆ—è¡¨æœ«å°¾
     */
    public boolean addAll(Collection&amp;lt;? extends E&amp;gt; c) {
        Object[] a = c.toArray();
        int numNew = a.length;
        ensureCapacityInternal(size + numNew);  // Increments modCount
        System.arraycopy(a, 0, elementData, size, numNew);
        size += numNew;
        return numNew != 0;
    }

    /**
     * å°†æŒ‡å®šé›†åˆä¸­çš„å…ƒç´ ä»¥Iteratorè¿”å›çš„é¡ºåºï¼Œæ’å…¥åˆ°æŒ‡å®šä½ç½®
     */
    public boolean addAll(int index, Collection&amp;lt;? extends E&amp;gt; c) {
        rangeCheckForAdd(index);

        Object[] a = c.toArray();
        int numNew = a.length;
        ensureCapacityInternal(size + numNew);  // Increments modCount

        int numMoved = size - index;
        if (numMoved &amp;gt; 0)
            System.arraycopy(elementData, index, elementData, index + numNew,
                    numMoved);

        System.arraycopy(a, 0, elementData, index, numNew);
        size += numNew;
        return numNew != 0;
    }

    /**
     * ç§»é™¤[fromIndex,toIndex)ä¹‹é—´çš„å…ƒç´ ï¼Œåç»­å…ƒç´ ç§»åˆ°å·¦ç«¯
     */
    protected void removeRange(int fromIndex, int toIndex) {
        modCount++;
        int numMoved = size - toIndex;
        System.arraycopy(elementData, toIndex, elementData, fromIndex,
                numMoved);

        // clear to let GC do its work
        int newSize = size - (toIndex-fromIndex);
        for (int i = newSize; i &amp;lt; size; i++) {
            elementData[i] = null;
        }
        size = newSize;
    }

    /**
     *æ£€æŸ¥ç»™å®šç´¢å¼•æ˜¯å¦åœ¨ç•Œé™å†…ã€‚
     */
    private void rangeCheck(int index) {
        if (index &amp;gt;= size)
            throw new IndexOutOfBoundsException(outOfBoundsMsg(index));
    }

    /**
     * add and addAllä½¿ç”¨çš„rangeCheck
     */
    private void rangeCheckForAdd(int index) {
        if (index &amp;gt; size || index &amp;lt; 0)
            throw new IndexOutOfBoundsException(outOfBoundsMsg(index));
    }

    /**
     * è¿”å› an IndexOutOfBoundsException çš„ç»†èŠ‚ä¿¡æ¯
     */
    private String outOfBoundsMsg(int index) {
        return &amp;quot;Index: &amp;quot;+index+&amp;quot;, Size: &amp;quot;+size;
    }

    /**
     * ä»åˆ—è¡¨ä¸­ç§»é™¤æŒ‡å®šé›†åˆåŒ…å«çš„æ‰€æœ‰å…ƒç´ 
     */
    public boolean removeAll(Collection&amp;lt;?&amp;gt; c) {
        Objects.requireNonNull(c);
        return batchRemove(c, false);
    }

    /**
     * ä¿ç•™æ­¤åˆ—è¡¨ä¸­æŒ‡å®šé›†åˆçš„æ‰€æœ‰å…ƒç´ 
     */
    public boolean retainAll(Collection&amp;lt;?&amp;gt; c) {
        Objects.requireNonNull(c);
        return batchRemove(c, true);
    }

    //æ‰¹é‡ç§»é™¤
    private boolean batchRemove(Collection&amp;lt;?&amp;gt; c, boolean complement) {
        final Object[] elementData = this.elementData;
        int r = 0, w = 0;
        boolean modified = false;
        try {
            for (; r &amp;lt; size; r++)
                if (c.contains(elementData[r]) == complement)
                    elementData[w++] = elementData[r];
        } finally {
            // Preserve behavioral compatibility with AbstractCollection,
            // even if c.contains() throws.
            if (r != size) {
                System.arraycopy(elementData, r,
                        elementData, w,
                        size - r);
                w += size - r;
            }
            if (w != size) {
                // clear to let GC do its work
                for (int i = w; i &amp;lt; size; i++)
                    elementData[i] = null;
                modCount += size - w;
                size = w;
                modified = true;
            }
        }
        return modified;
    }

    /**
     * ä¿å­˜ArrayListçŠ¶æ€åˆ°ä¸€ä¸ªæµä¸­ï¼ˆå³åºåˆ—åŒ–ï¼‰
     */
    private void writeObject(java.io.ObjectOutputStream s)
            throws java.io.IOException{
        // Write out element count, and any hidden stuff
        int expectedModCount = modCount;
        s.defaultWriteObject();

        // Write out size as capacity for behavioural compatibility with clone()
        s.writeInt(size);

        // Write out all elements in the proper order.
        for (int i=0; i&amp;lt;size; i++) {
            s.writeObject(elementData[i]);
        }

        if (modCount != expectedModCount) {
            throw new ConcurrentModificationException();
        }
    }

    /**
     * ä»ä¸€ä¸ªæµä¸­è¯»å–ArrayListï¼ˆå³ååºåˆ—åŒ–ï¼‰
     */
    private void readObject(java.io.ObjectInputStream s)
            throws java.io.IOException, ClassNotFoundException {
        elementData = EMPTY_ELEMENTDATA;

        // Read in size, and any hidden stuff
        s.defaultReadObject();

        // Read in capacity
        s.readInt(); // ignored

        if (size &amp;gt; 0) {
            // be like clone(), allocate array based upon size not capacity
            int capacity = calculateCapacity(elementData, size);
            SharedSecrets.getJavaOISAccess().checkArray(s, Object[].class, capacity);
            ensureCapacityInternal(size);

            Object[] a = elementData;
            // Read in all elements in the proper order.
            for (int i=0; i&amp;lt;size; i++) {
                a[i] = s.readObject();
            }
        }
    }

    /**
     *  ä»åˆ—è¡¨ä¸­çš„æŒ‡å®šä½ç½®å¼€å§‹ï¼Œè¿”å›ä¹‹åæ‰€æœ‰å…ƒç´ çš„åˆ—è¡¨è¿­ä»£å™¨ï¼ˆæŒ‰æ­£ç¡®çš„é¡ºåºï¼‰
     *  æŒ‡å®šçš„ç´¢å¼•è¡¨ç¤ºåˆå§‹è°ƒç”¨å°†è¿”å›çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºnext ã€‚ åˆå§‹è°ƒç”¨previouså°†è¿”å›æŒ‡å®šç´¢å¼•å‡1çš„å…ƒç´ ã€‚
     *  è¿”å›çš„åˆ—è¡¨è¿­ä»£å™¨æ˜¯fail-fast ã€‚
     */
    public ListIterator&amp;lt;E&amp;gt; listIterator(int index) {
        if (index &amp;lt; 0 || index &amp;gt; size)
            throw new IndexOutOfBoundsException(&amp;quot;Index: &amp;quot;+index);
        return new ListItr(index);
    }

    /**
     * è¿”å›åˆ—è¡¨ä¸­çš„åŒ…å«æ‰€æœ‰å…ƒç´ çš„åˆ—è¡¨è¿­ä»£å™¨ï¼ˆæŒ‰æ­£ç¡®çš„é¡ºåºï¼‰ã€‚
     * è¿”å›çš„åˆ—è¡¨è¿­ä»£å™¨æ˜¯fail-fast ã€‚
     */
    public ListIterator&amp;lt;E&amp;gt; listIterator() {
        return new ListItr(0);
    }

    /**
     * ä»¥æ­£ç¡®çš„é¡ºåºè¿”å›åˆ—è¡¨ä¸­çš„åŒ…å«æ‰€æœ‰å…ƒç´ çš„è¿­ä»£å™¨ã€‚
     * è¿”å›çš„è¿­ä»£å™¨æ˜¯fail-fast ã€‚
     */
    public Iterator&amp;lt;E&amp;gt; iterator() {
        return new Itr();
    }

    @Override
    public void forEach(Consumer&amp;lt;? super E&amp;gt; action) {
        Objects.requireNonNull(action);
        final int expectedModCount = modCount;
        @SuppressWarnings(&amp;quot;unchecked&amp;quot;)
        final E[] elementData = (E[]) this.elementData;
        final int size = this.size;
        for (int i=0; modCount == expectedModCount &amp;amp;&amp;amp; i &amp;lt; size; i++) {
            action.accept(elementData[i]);
        }
        if (modCount != expectedModCount) {
            throw new ConcurrentModificationException();
        }
    }


    @Override
    public boolean removeIf(Predicate&amp;lt;? super E&amp;gt; filter) {
        Objects.requireNonNull(filter);
        // figure out which elements are to be removed
        // any exception thrown from the filter predicate at this stage
        // will leave the collection unmodified
        int removeCount = 0;
        final BitSet removeSet = new BitSet(size);
        final int expectedModCount = modCount;
        final int size = this.size;
        for (int i=0; modCount == expectedModCount &amp;amp;&amp;amp; i &amp;lt; size; i++) {
            @SuppressWarnings(&amp;quot;unchecked&amp;quot;)
            final E element = (E) elementData[i];
            if (filter.test(element)) {
                removeSet.set(i);
                removeCount++;
            }
        }
        if (modCount != expectedModCount) {
            throw new ConcurrentModificationException();
        }

        // shift surviving elements left over the spaces left by removed elements
        final boolean anyToRemove = removeCount &amp;gt; 0;
        if (anyToRemove) {
            final int newSize = size - removeCount;
            for (int i=0, j=0; (i &amp;lt; size) &amp;amp;&amp;amp; (j &amp;lt; newSize); i++, j++) {
                i = removeSet.nextClearBit(i);
                elementData[j] = elementData[i];
            }
            for (int k=newSize; k &amp;lt; size; k++) {
                elementData[k] = null;  // Let gc do its work
            }
            this.size = newSize;
            if (modCount != expectedModCount) {
                throw new ConcurrentModificationException();
            }
            modCount++;
        }

        return anyToRemove;
    }

    @Override
    @SuppressWarnings(&amp;quot;unchecked&amp;quot;)
    public void replaceAll(UnaryOperator&amp;lt;E&amp;gt; operator) {
        Objects.requireNonNull(operator);
        final int expectedModCount = modCount;
        final int size = this.size;
        for (int i=0; modCount == expectedModCount &amp;amp;&amp;amp; i &amp;lt; size; i++) {
            elementData[i] = operator.apply((E) elementData[i]);
        }
        if (modCount != expectedModCount) {
            throw new ConcurrentModificationException();
        }
        modCount++;
    }

    @Override
    @SuppressWarnings(&amp;quot;unchecked&amp;quot;)
    public void sort(Comparator&amp;lt;? super E&amp;gt; c) {
        final int expectedModCount = modCount;
        Arrays.sort((E[]) elementData, 0, size, c);
        if (modCount != expectedModCount) {
            throw new ConcurrentModificationException();
        }
        modCount++;
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;æ‰©å®¹æºç è§£æjdk8&#34;&gt;æ‰©å®¹æºç è§£æï¼ˆJDK8ï¼‰&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨ ArrayList &lt;code&gt;&amp;lt;String&amp;gt;&lt;/code&gt; list = new ArrayList&amp;lt;&amp;gt;(5)åˆ›å»ºä¸€ä¸ªArrayLsitï¼Œè¿™è¡¨æ˜åˆ›å»ºçš„ArrayListåˆå§‹å®¹é‡ä¸º5.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    //é»˜è®¤åˆå§‹å®¹é‡10
    private static final int DEFAULT_CAPACITY = 10;
    //ä¸€ä¸ªç©ºçš„é»˜è®¤å¯¹è±¡æ•°ç»„ï¼Œå½“ArrayList(int initialCapacity)ï¼ŒArrayList(Collection&amp;lt;? extends E&amp;gt; c)ä¸­çš„å®¹é‡ç­‰äº0çš„æ—¶å€™ä½¿ç”¨
    private static final Object[] EMPTY_ELEMENTDATA = {};
    //ä¸€ä¸ªç©ºçš„é»˜è®¤å¯¹è±¡æ•°ç»„ï¼Œç”¨äºArrayList()æ„é€ å™¨
    private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};
    //ä¸€ä¸ªå¯¹è±¡æ•°ç»„ï¼Œtransientè¡¨ç¤ºä¸èƒ½åºåˆ—åŒ–
    transient Object[] elementData;
    //æ•°ç»„å¤§å°
    private int size;

    //ä»¥ä¼ å…¥çš„å®¹é‡æ„é€ ä¸€ä¸ªç©ºçš„list
    public ArrayList(int initialCapacity) {
        //å¦‚æœä¼ å…¥å€¼å¤§äº0ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªè¯¥å®¹é‡å¤§å°çš„æ•°ç»„ã€‚
        if (initialCapacity &amp;gt; 0) {
            this.elementData = new Object[initialCapacity];
        } else if (initialCapacity == 0) {
            //å¦åˆ™å¦‚æœä¼ å…¥å€¼ç­‰äº0ï¼Œåˆ™åˆ›å»ºé»˜è®¤ç©ºæ•°ç»„
            this.elementData = EMPTY_ELEMENTDATA;
        } else {
            //å¦‚æœå°äº0åˆ™æŠ›å‡ºå¼‚å¸¸
            throw new IllegalArgumentException(&amp;quot;Illegal Capacity: &amp;quot;+
                    initialCapacity);
        }
    }

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ¥ç€æˆ‘ä»¬ä½¿ç”¨addæ–¹æ³•æ·»åŠ ä¸€ä¸ªå­—ç¬¦ä¸²åˆ°è¯¥listä¸­ï¼Œlist.add(&amp;quot;Test&amp;quot;)ã€‚è¿›å…¥addæºç ä¼šå‘ç°ï¼ŒçœŸæ­£çš„æ‰©å®¹æ˜¯å‘ç”Ÿåœ¨addæ“ä½œä¹‹å‰çš„ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    //é»˜è®¤æ·»åŠ åœ¨æ•°ç»„æœ«å°¾
    public boolean add(E e) {
        //æ·»åŠ ä¹‹å‰å…ˆç¡®è®¤æ˜¯å¦éœ€è¦æ‰©å®¹
        ensureCapacityInternal(size + 1);  // Increments modCount!!
        //æ–°åŠ å…¥çš„å…ƒç´ æ˜¯æ·»åŠ åœ¨äº†æ•°ç»„çš„æœ«å°¾ï¼Œéšåæ•°ç»„sizeè‡ªå¢ã€‚
        elementData[size++] = e;
        return true;
    }

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿›å…¥ensureCapacityInternal()æ–¹æ³•æŸ¥çœ‹å¯¹åº”æºç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    private void ensureCapacityInternal(int minCapacity) {
        //å…ˆé€šè¿‡calculateCapacityæ–¹æ³•è®¡ç®—æœ€ç»ˆå®¹é‡ï¼Œä»¥ç¡®è®¤å®é™…å®¹é‡
        ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));
    }

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ°è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè¿›å…¥calculateCapacity()æ–¹æ³•çœ‹çœ‹ä»–æ˜¯å¦‚ä½•è®¡ç®—æœ€åå®¹é‡çš„ï¼Œæºç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    private static int calculateCapacity(Object[] elementData, int minCapacity) {
        //å¦‚æœelementDataä¸ºé»˜è®¤ç©ºæ•°ç»„ï¼Œåˆ™æ¯”è¾ƒä¼ å…¥å€¼ä¸é»˜è®¤å€¼ï¼ˆ10ï¼‰ï¼Œè¿”å›ä¸¤è€…ä¸­çš„è¾ƒå¤§å€¼
        //elementDataä¸ºé»˜è®¤ç©ºæ•°ç»„æŒ‡çš„æ˜¯é€šè¿‡ArrayList()è¿™ä¸ªæ„é€ å™¨åˆ›å»ºçš„ArrayListå¯¹è±¡
        if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {
            return Math.max(DEFAULT_CAPACITY, minCapacity);
        }
        //è¿”å›ä¼ å…¥å€¼
        return minCapacity;
    }

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬ç¡®è®¤äº†æœ€ç»ˆå®¹é‡ï¼Œé‚£ä¹ˆè¿›å…¥ensureExplicitCapacityï¼ŒæŸ¥çœ‹æºç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    private void ensureExplicitCapacity(int minCapacity) {
        modCount++;
        // overflow-conscious code
        //å¦‚æœæœ€ç»ˆç¡®è®¤å®¹é‡å¤§äºæ•°ç»„å®¹é‡ï¼Œåˆ™è¿›è¡Œgrow()æ‰©å®¹
        if (minCapacity - elementData.length &amp;gt; 0)
            grow(minCapacity);
    }

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œåªæœ‰å½“æœ€ç»ˆå®¹é‡å¤§äºæ•°ç»„å®¹é‡æ—¶æ‰ä¼šè¿›è¡Œæ‰©å®¹ã€‚é‚£ä¹ˆä»¥æˆ‘ä»¬ä¸Šé¢çš„ä¾‹å­è€Œè¨€å…·ä½“åˆ†æå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é¦–å…ˆå› ä¸ºæˆ‘ä»¬åˆ›å»ºçš„æ—¶å€™å°±èµ‹äº†åˆå§‹å®¹é‡5ï¼Œæ‰€ä»¥elementData.length = 5ã€‚&lt;/li&gt;
&lt;li&gt;å½“æˆ‘ä»¬addç¬¬ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼ŒminCapacityæ˜¯ç­‰äºsize + 1 = 1çš„ã€‚&lt;/li&gt;
&lt;li&gt;æ­¤æ—¶minCapacity - elementData.length &amp;gt; 0æ¡ä»¶ä¸æˆç«‹ï¼Œæ‰€ä»¥ä¸ä¼šè¿›å…¥grow(minCapacity)æ–¹æ³•è¿›è¡Œæ‰©å®¹ã€‚&lt;/li&gt;
&lt;li&gt;ä»¥æ­¤ç±»æ¨ï¼Œåªæœ‰æ·»åŠ åˆ°ç¬¬äº”ä¸ªå…ƒç´ çš„æ—¶å€™ï¼ŒminCapacity = 6 å¤§äº elementData.length = 5ï¼Œè¿™æ—¶å°±ä¼šè¿›å…¥grow(minCapacity)æ–¹æ³•è¿›è¡Œæ‰©å®¹ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;grow()ä»¥åŠhugeCapacity()æºç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    //å¯åˆ†é…çš„æœ€å¤§æ•°ç»„å¤§å°
    private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;

    //æ‰©å®¹
    private void grow(int minCapacity) {
        // overflow-conscious code
        //oldCapacityè¡¨ç¤ºæ—§å®¹é‡
        int oldCapacity = elementData.length;
        //newCapacityè¡¨ç¤ºæ–°å®¹é‡ï¼Œè®¡ç®—è§„åˆ™ä¸ºæ—§å®¹é‡+æ—§å®¹é‡çš„0.5ï¼Œå³æ—§å®¹é‡çš„1.5å€ã€‚å¦‚æœè¶…è¿‡intçš„æœ€å¤§å€¼ä¼šè¿”å›ä¸€ä¸ªè´Ÿæ•°ã€‚
        //oldCapacity &amp;gt;&amp;gt; 1è¡¨ç¤ºå³ç§»ä¸€ä½ï¼Œå¯¹åº”é™¤ä»¥2çš„1æ¬¡æ–¹ã€‚
        int newCapacity = oldCapacity + (oldCapacity &amp;gt;&amp;gt; 1);
        //å¦‚æœæ–°å®¹é‡å°äºæœ€å°å®¹é‡ï¼Œåˆ™å°†æœ€å°å®¹é‡èµ‹å€¼ç»™æ–°å®¹é‡(æœ‰æ—¶æ‰‹åŠ¨æ‰©å®¹å¯èƒ½ä¹Ÿä¼šè¿”å›&amp;lt;0ï¼Œå¯¹åº”æ–¹æ³•ä¸ºensureCapacity())
        if (newCapacity - minCapacity &amp;lt; 0)
            newCapacity = minCapacity;
        //å¦‚æœæ–°å®¹é‡å¤§äºMAX_ARRAY_SIZEï¼Œåˆ™æ‰§è¡ŒhugeCapacity(minCapacity)è¿”å›å¯¹åº”å€¼
        if (newCapacity - MAX_ARRAY_SIZE &amp;gt; 0)
            newCapacity = hugeCapacity(minCapacity);
        // minCapacity is usually close to size, so this is a win:
        //å¤åˆ¶æ—§æ•°ç»„åˆ°æ–°å®¹é‡æ•°ç»„ä¸­ï¼Œå®Œæˆæ‰©å®¹æ“ä½œ
        elementData = Arrays.copyOf(elementData, newCapacity);
    }

    private static int hugeCapacity(int minCapacity) {
        //å¦‚æœæœ€å°å®¹é‡è¶…è¿‡äº†intçš„æœ€å¤§å€¼ï¼ŒminCapacityä¼šæ˜¯ä¸€ä¸ªè´Ÿæ•°ï¼Œæ­¤æ—¶æŠ›å‡ºå†…å­˜æº¢å‡ºé”™è¯¯
        if (minCapacity &amp;lt; 0) // overflow
            throw new OutOfMemoryError();
        //æ¯”è¾ƒæœ€å°å®¹é‡æ˜¯å¦å¤§äºMAX_ARRAY_SIZEï¼Œå¦‚æœæ˜¯åˆ™è¿”å›Integer.MAX_VALUEï¼Œå¦åˆ™è¿”å›MAX_ARRAY_SIZE
        return (minCapacity &amp;gt; MAX_ARRAY_SIZE) ?
                Integer.MAX_VALUE :
                MAX_ARRAY_SIZE;
    }

&lt;/code&gt;&lt;/pre&gt;
">ArrayListæºç è§£æ(JDK8)</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://philosopherzb.github.io/post/java-ji-he-ji-chu-zhi-shi/"" data-c="
          &lt;h2 id=&#34;æ¥å£ç»§æ‰¿å…³ç³»å’Œå®ç°&#34;&gt;æ¥å£ç»§æ‰¿å…³ç³»å’Œå®ç°&lt;/h2&gt;
&lt;h3 id=&#34;é›†åˆç±»æ¦‚å¿µ&#34;&gt;é›†åˆç±»æ¦‚å¿µ&lt;/h3&gt;
&lt;p&gt;é›†åˆç±»å­˜æ”¾äºjava.utilåŒ…ä¸­ï¼Œä¸»è¦æœ‰ä¸‰ç§ï¼Œsetï¼ˆé›†ï¼‰ï¼Œlistï¼ˆåˆ—è¡¨åŒ…å«Queueï¼‰ï¼Œmapï¼ˆæ˜ å°„ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;Collectionï¼šé›†åˆç±»çš„é€šç”¨æ¥å£ï¼Œç›´æ¥ç»§æ‰¿æ¥å£æœ‰Listå’ŒSetã€‚&lt;/p&gt;
&lt;p&gt;Iteratorï¼šä¸€ä¸ªè½»é‡çº§å¯¹è±¡ï¼ˆåˆ›å»ºä»£ä»·å°ï¼‰ï¼Œä¸»è¦ç”¨æ¥å¯¹é›†åˆè¿›è¡Œéå†ç§»é™¤ç­‰æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;Mapï¼šä½¿ç”¨é”®å€¼å¯¹å­˜å‚¨çš„å®¹å™¨ï¼Œæ˜ å°„è¡¨çš„åŸºç¡€æ¥å£ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230301010.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230301011.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;list&#34;&gt;List&lt;/h3&gt;
&lt;p&gt;æœ‰åºé›†åˆï¼Œæ˜¯ä¸€ä¸ªéå¸¸å¸¸ç”¨çš„æ•°æ®ç±»å‹ï¼Œå®ƒçš„å®ç°ç±»æœ‰ArrayListï¼ŒVectorä»¥åŠLinkedListã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230301012.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ArrayListï¼šåº•å±‚æ•°æ®ç»“æ„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒæŸ¥è¯¢æ•ˆç‡æ¯”è¾ƒé«˜ï¼Œæ·»åŠ åˆ é™¤è¾ƒæ…¢ï¼ˆé»˜è®¤æ·»åŠ åœ¨æœ«å°¾ï¼Œåœ¨æŒ‡å®šä½ç½®æ·»åŠ å…ƒç´ æ•ˆç‡æ¯”è¾ƒä½ï¼Œå› ä¸ºéœ€è¦å°†æŒ‡å®šä½ç½®åç»­çš„å…ƒç´ éƒ½å¾€åç§»ä½ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;Vectorï¼šä¸ArrayListåŸºæœ¬ä¸€è‡´ï¼Œå”¯ä¸€çš„å·®åˆ«å°±æ˜¯å…¶æ“ä½œä¸ºåŒæ­¥ï¼ˆåŠ äº†é”ï¼‰ï¼Œå³æŸä¸€ä¸ªæ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿå†™Vectorï¼Œè¿™ä¹Ÿå¯¼è‡´å…¶æŸ¥è¯¢æ•ˆç‡æ¯”ArrayListæ…¢ã€‚&lt;/p&gt;
&lt;p&gt;LinkedListï¼šåº•å±‚æ•°æ®ç»“æ„æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼ˆprevæŒ‡å‘å‰èŠ‚ç‚¹ï¼ŒnextæŒ‡å‘åèŠ‚ç‚¹ï¼‰ï¼ŒæŸ¥è¯¢æ•ˆç‡æ¯”è¾ƒæ…¢ï¼Œæ·»åŠ åˆ é™¤æ¯”è¾ƒå¿«ã€‚å¦å¤–ï¼Œå®ƒè¿˜æä¾›äº†Listæ¥å£ä¸­æ²¡æœ‰å®šä¹‰çš„æ–¹æ³•ï¼Œä¸“é—¨ç”¨äºæ“ä½œè¡¨å¤´å’Œè¡¨å°¾å…ƒç´ ï¼Œå¯ä»¥å½“åšå †æ ˆï¼Œé˜Ÿåˆ—å’ŒåŒå‘é˜Ÿåˆ—æ¥ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;set&#34;&gt;Set&lt;/h3&gt;
&lt;p&gt;Setæ³¨é‡ç‹¬ä¸€æ— äºŒçš„æ€§è´¨ï¼Œå…¶ç‰¹ç‚¹æ˜¯æ— åºä¸”ä¸èƒ½å‡ºç°é‡å¤å€¼ã€‚å¯¹è±¡çš„ç›¸ç­‰æ€§æœ¬è´¨æ˜¯ç”±å¯¹è±¡çš„hashCodeå€¼ï¼ˆjavaæ˜¯æ ¹æ®å¯¹è±¡çš„å†…å­˜åœ°å€è®¡ç®—å‡ºçš„æ­¤åºå·ï¼‰åˆ¤æ–­çš„ã€‚å¦‚æœä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ï¼Œåˆ™å…¶hashCodeä»¥åŠequalsæ¯”è¾ƒç»“æœå¿…ç„¶ç›¸ç­‰ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230301013.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;HashSetï¼ˆhashè¡¨ï¼‰ï¼šå“ˆå¸Œè¡¨ä¸­å­˜æ”¾çš„æ˜¯å“ˆå¸Œå€¼ï¼ŒhashSetå­˜å‚¨å…ƒç´ å¹¶ä¸æ˜¯æŒ‰ç…§å­˜å…¥æ—¶çš„é¡ºåºï¼ˆæ— åºï¼‰ï¼Œè€Œæ˜¯æŒ‰ç…§å“ˆå¸Œå€¼æ¥å­˜çš„ï¼Œæ•…å…¶å–æ•°æ®ä¹Ÿæ˜¯ä¾æ®å“ˆå¸Œå€¼ã€‚å…ƒç´ çš„å“ˆå¸Œå€¼æ˜¯é€šè¿‡å…ƒç´ çš„hashCodeæ–¹æ³•è·å–çš„ã€‚&lt;/p&gt;
&lt;p&gt;hashSetåˆ¤æ–­ä¸¤ä¸ªå…ƒç´ ç›¸ç­‰ï¼šå…ˆåˆ¤æ–­ä¸¤ä¸ªå…ƒç´ çš„å“ˆå¸Œå€¼æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœå“ˆå¸Œå€¼ä¸€æ ·ï¼Œå†æ¯”è¾ƒequalsæ–¹æ³•ï¼Œå¦‚æœè¿”å›trueåˆ™ä¸¤ä¸ªå…ƒç´ ç›¸ç­‰ï¼Œå¦åˆ™ä¸ç›¸ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;hashSeté€šè¿‡hashCodeå€¼æ¥ç¡®å®šå…ƒç´ åœ¨å†…å­˜ä¸­çš„ä½ç½®ã€‚ä¸€ä¸ªhashCodeä½ç½®ä¸Šå¯ä»¥å­˜æ”¾å¤šä¸ªå…ƒç´ ï¼ˆequalsç»“æœä¸ºfalseï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;TreeSetï¼ˆäºŒå‰æ ‘ï¼‰ï¼šä¼šå¯¹æ’å…¥çš„å…ƒç´ è¿›è¡Œæ’åºï¼ˆä¾æ®äºŒå‰æ ‘ï¼‰ã€‚å¦‚æœæ˜¯è‡ªå®šä¹‰çš„ç±»éœ€è¦è¿›è¡Œæ’åºï¼Œéœ€è¦è‡ªå®šä¹‰ç±»å®ç°Comparableï¼Œè¦†å†™å¯¹åº”çš„compareTo()å‡½æ•°ï¼Œå¹¶è¿”å›ç›¸åº”çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;LinkHashSetï¼ˆhashSet+LinkedHashMapï¼‰ï¼šå…¶ç»§æ‰¿äºHashSetï¼Œåº•å±‚ä½¿ç”¨LinkedHashMapä¿å­˜æ•°æ®ã€‚&lt;/p&gt;
&lt;h3 id=&#34;map&#34;&gt;Map&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230301014.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;hashTableï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰ï¼šæ˜¯ä¸€ä¸ªé—ç•™ç±»ï¼Œä¸hashMapç±»ä¼¼ï¼Œåªæ˜¯åŠ äº†å…¨å±€é”ï¼Œä¿è¯äº†å¤šçº¿ç¨‹ä¸‹çš„å®‰å…¨ã€‚ç°åœ¨å·²ä¸å»ºè®®ä½¿ç”¨ï¼Œå¦‚æœéœ€è¦çº¿ç¨‹å®‰å…¨ï¼Œæ¨èä½¿ç”¨ConcurrentHashMapã€‚&lt;/p&gt;
&lt;p&gt;TreeMapï¼ˆå¯æ’åºï¼‰ï¼šå®ç°äº†SortedMapæ¥å£ï¼Œèƒ½å¤Ÿå°†å…¶ä¿å­˜çš„è®°å½•æŒ‰é”®è¿›è¡Œæ’åºï¼ˆé»˜è®¤å‡åºï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;LinkHashMapï¼ˆæœ‰åºï¼‰ï¼šhashMap+åŒå‘é“¾è¡¨ï¼Œæ˜¯hashMapçš„ä¸€ä¸ªå­ç±»ï¼Œä¿å­˜äº†è®°å½•çš„æ’å…¥é¡ºåºï¼Œåœ¨ä½¿ç”¨Iteratoréå†æ—¶ï¼Œå…ˆå¾—çš„æ•°æ®å¿…ç„¶æ˜¯å…ˆæ’å…¥çš„ï¼ˆæœ‰åºï¼‰ï¼Œä¸è¿‡ä¹Ÿå¯ä»¥å¯¹å…¶è¿›è¡Œè®¾ç½®ï¼Œå…³é”®å‚æ•°ä¸ºaccessOrderï¼ˆtrueåˆ™æ˜¯è®¿é—®é¡ºåºï¼Œfalseåˆ™æ˜¯æ’å…¥é¡ºåºï¼‰ã€‚&lt;/p&gt;
&lt;h4 id=&#34;hashmap&#34;&gt;hashMap&lt;/h4&gt;
&lt;p&gt;hashMapï¼ˆæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ï¼‰ï¼šæ ¹æ®é”®çš„hashCodeå€¼å­˜å‚¨æ•°æ®ã€‚éçº¿ç¨‹å®‰å…¨ï¼ˆCollectionsçš„synchronizedMapä»¥åŠConcurrentHashMapå¯å®ç°çº¿ç¨‹å®‰å…¨ï¼‰ï¼Œå…è®¸ç©ºé”®å€¼ï¼Œæ‰§è¡Œæ•ˆç‡ç›¸å¯¹è¾ƒé«˜ã€‚&lt;/p&gt;
&lt;p&gt;capacityï¼šå½“å‰æ•°ç»„å®¹é‡ï¼Œå§‹ç»ˆä¿æŒ2^nï¼Œå¯ä»¥æ‰©å®¹ï¼Œæ‰©å®¹åæ•°ç»„å¤§å°ä¸ºå½“å‰çš„2å€ã€‚&lt;/p&gt;
&lt;p&gt;loadFactorï¼šè´Ÿè½½å› å­ï¼Œé»˜è®¤ä¸º0.75ã€‚å…¶å¤§å°å†³å®šäº†æ•£åˆ—è¡¨ç©ºé—´çš„ç¨€å¯†åº¦ï¼ˆè¶Šå¤§ï¼Œè¶Šå¯†é›†ï¼Œé“¾è¡¨è¶Šé•¿ï¼Œç´¢å¼•è¶Šæ…¢ï¼›è¶Šå°ï¼Œè¶Šç¨€ç–ï¼Œé“¾è¡¨è¶ŠçŸ­ï¼Œç´¢å¼•è¶Šå¿«ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;thresholdï¼šæ‰©å®¹é˜ˆå€¼ï¼Œç­‰äºcapacity * loadFactor&lt;/p&gt;
&lt;p&gt;Java7ä¸­ï¼ŒhashMapç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230301015.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;Java8ä¸­ï¼ŒhashMapç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230301016.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;concurrenthashmap&#34;&gt;ConcurrenthashMap&lt;/h4&gt;
&lt;p&gt;ConcurrenthashMapï¼šç›¸æ¯”äºhashMapè€Œè¨€ï¼Œå®ƒæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå…¶ä½™åŸºæœ¬ä¸€è‡´ã€‚java7ä¸­ï¼Œä½¿ç”¨çš„æ˜¯åˆ†æ®µé”ï¼ˆSegmentï¼Œé»˜è®¤å¹¶è¡Œåº¦16ï¼‰ï¼›java8ä¸­ä½¿ç”¨çš„æ˜¯èŠ‚ç‚¹é”ï¼ˆç²’åº¦æ›´ç»†ï¼Œä¸”å¼•å…¥äº†çº¢é»‘æ ‘ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;Java7ä¸­ï¼ŒConcurrenthashMapç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230301017.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;Java8ä¸­ï¼ŒConcurrenthashMapç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230301018.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
">Javaé›†åˆåŸºç¡€çŸ¥è¯†</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://philosopherzb.github.io/post/java-zhong-de-suo/"" data-c="
          &lt;h2 id=&#34;é”çš„ç±»å‹&#34;&gt;é”çš„ç±»å‹&lt;/h2&gt;
&lt;h3 id=&#34;ä¹è§‚é”&#34;&gt;ä¹è§‚é”&lt;/h3&gt;
&lt;p&gt;ä¹è§‚é”è®¤ä¸ºè¯»å¤šå†™å°‘ï¼Œé‡åˆ°å¹¶å‘å†™çš„å¯èƒ½æ€§ä½ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ã€‚ä½†æ˜¯ï¼Œåœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»ä¿®æ”¹è¿™ä¸ªæ•°æ®ï¼Œé‡‡å–å†™æ—¶å…ˆè¯»å‡ºå½“å‰ç‰ˆæœ¬å·ï¼Œç„¶ååŠ é”æ“ä½œï¼ˆæ¯”è¾ƒä¸Šä¸€æ¬¡çš„ç‰ˆæœ¬å·ï¼Œä¸€è‡´åˆ™æ›´æ–°ï¼‰ï¼Œå¦‚æœå¤±è´¥åˆ™é‡å¤è¯»-æ¯”è¾ƒ-å†™æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;CASä¾¿æ˜¯å…¸å‹çš„ä¹è§‚é”æœºåˆ¶ï¼Œå…¶ä¸­ä¼šä½¿ç”¨åˆ°sun.misc.Unsafeè¿™ä¸ªç±»è¿›è¡ŒCompare And Swapæ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;CAS å³æ¯”è¾ƒå¹¶äº¤æ¢ã€‚æ˜¯è§£å†³å¤šçº¿ç¨‹å¹¶è¡Œæƒ…å†µä¸‹ä½¿ç”¨é”é€ æˆæ€§èƒ½æŸè€—çš„ä¸€ç§æœºåˆ¶ï¼ŒCAS æ“ä½œåŒ…å«ä¸‰ä¸ªæ“ä½œæ•°â€”â€”å†…å­˜ä½ç½®(V)ã€é¢„æœŸåŸå€¼(A)å’Œæ–°å€¼(B)ã€‚å¦‚æœå†…å­˜ä½ç½®çš„å€¼(V)ä¸é¢„æœŸåŸå€¼(A)ç›¸åŒ¹é…ï¼Œé‚£ä¹ˆå¤„ç†å™¨ä¼šè‡ªåŠ¨å°†è¯¥ä½ç½®å€¼æ›´æ–°ä¸ºæ–°å€¼(B)ã€‚å¦åˆ™ï¼Œå¤„ç†å™¨ä¸åšä»»ä½•æ“ä½œã€‚æ— è®ºå“ªç§æƒ…å†µï¼Œå®ƒéƒ½ä¼šåœ¨ CAS æŒ‡ä»¤ä¹‹å‰è¿”å›è¯¥ä½ç½®çš„å€¼ã€‚CAS æœ‰æ•ˆåœ°è¯´æ˜äº†â€œæˆ‘è®¤ä¸ºä½ç½®(V)åº”è¯¥åŒ…å«å€¼(A)ã€‚å¦‚æœåŒ…å«è¯¥å€¼ï¼Œåˆ™å°†æ–°å€¼(B)æ”¾åˆ°è¿™ä¸ªä½ç½®ï¼›å¦åˆ™ï¼Œä¸è¦æ›´æ”¹è¯¥ä½ç½®ï¼Œåªå‘Šè¯‰æˆ‘è¿™ä¸ªä½ç½®ç°åœ¨çš„å€¼å³å¯â€ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ‚²è§‚é”&#34;&gt;æ‚²è§‚é”&lt;/h3&gt;
&lt;p&gt;æ‚²è§‚é”è®¤ä¸ºå†™æ“ä½œæ›´å¤šï¼Œé‡åˆ°å¹¶å‘å†™çš„å¯èƒ½æ€§é«˜ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¼šåœ¨æ¯æ¬¡è¯»å†™çš„æ—¶å€™ä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³è¯»å†™è¿™ä¸ªæ•°æ®ä¾¿ä¼šblockç›´åˆ°è·å–é”ã€‚&lt;/p&gt;
&lt;p&gt;Synchronizedä¾¿æ˜¯å…¸å‹çš„æ‚²è§‚é”ï¼ŒAQSæ¡†æ¶ä¸‹çš„é”ä¼šå…ˆå°è¯•CASè·å–é”ï¼Œè·å–ä¸åˆ°ä¾¿ä¼šè½¬ä¸ºæ‚²è§‚é”ã€‚&lt;/p&gt;
&lt;h2 id=&#34;çº¿ç¨‹åˆ‡æ¢åŠå…¶ä»£ä»·&#34;&gt;çº¿ç¨‹åˆ‡æ¢åŠå…¶ä»£ä»·&lt;/h2&gt;
&lt;h3 id=&#34;çº¿ç¨‹åˆ‡æ¢&#34;&gt;çº¿ç¨‹åˆ‡æ¢&lt;/h3&gt;
&lt;p&gt;javaçº¿ç¨‹ä¸æ“ä½œç³»ç»Ÿä¸Šçš„åŸç”Ÿçº¿ç¨‹æ˜¯ä¸€ä¸€æ˜ å°„çš„ã€‚å¦‚æœéœ€è¦é˜»å¡æˆ–è€…å”¤é†’ä¸€ä¸ªçº¿ç¨‹ï¼Œä¾¿éœ€è¦æ“ä½œç³»ç»Ÿçš„ä»‹å…¥ï¼Œå¹¶åˆ‡æ¢ç”¨æˆ·æ€ä¸å†…æ ¸æ€ï¼ˆè¿™æ ·çš„åˆ‡æ¢éœ€è¦æ¶ˆè€—å¤§é‡çš„ç³»ç»Ÿèµ„æºï¼‰ã€‚&lt;/p&gt;
&lt;h4 id=&#34;ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€çš„æ­¥éª¤ä¸»è¦å¦‚ä¸‹&#34;&gt;ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€çš„æ­¥éª¤ä¸»è¦å¦‚ä¸‹&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;ä»å½“å‰è¿›ç¨‹çš„æè¿°ç¬¦ä¸­æå–å…¶å†…æ ¸æ ˆçš„ss0åŠesp0ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ss0å’Œesp0æŒ‡å‘çš„å†…æ ¸æ ˆå°†å½“å‰è¿›ç¨‹çš„csï¼Œeipï¼Œeflagsï¼Œssï¼Œespä¿¡æ¯ä¿å­˜èµ·æ¥ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿå®Œæˆäº†ç”±ç”¨æˆ·æ€åˆ°å†…æ ¸æ ˆçš„åˆ‡æ¢è¿‡ç¨‹ï¼ŒåŒæ—¶ä¿å­˜äº†è¢«æš‚åœæ‰§è¡Œçš„ç¨‹åºçš„ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚&lt;/li&gt;
&lt;li&gt;å°†å…ˆå‰ç”±ä¸­æ–­å‘é‡æ£€ç´¢å¾—åˆ°çš„ä¸­æ–­å¤„ç†ç¨‹åºçš„csï¼Œeipä¿¡æ¯è£…å…¥ç›¸åº”çš„å¯„å­˜å™¨ï¼Œå¼€å§‹æ‰§è¡Œä¸­æ–­å¤„ç†ç¨‹åºï¼Œè¿™æ—¶å°±è½¬åˆ°äº†å†…æ ¸æ€çš„ç¨‹åºæ‰§è¡Œäº†ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;åè¯è§£é‡Šå¦‚ä¸‹&#34;&gt;åè¯è§£é‡Šå¦‚ä¸‹&lt;/h4&gt;
&lt;p&gt;CSï¼šä»£ç æ®µå¯„å­˜å™¨ï¼›å­˜æ”¾å½“å‰æ­£åœ¨è¿è¡Œçš„ç¨‹åºä»£ç æ‰€åœ¨æ®µçš„æ®µåŸºå€¼ï¼›è”åˆipä½œä¸ºcpuæŒ‡å‘å½“å‰æ­£åœ¨æ‰§è¡Œçš„æŒ‡ä»¤ï¼Œä¸èƒ½éšä¾¿ä¿®æ”¹ã€‚&lt;/p&gt;
&lt;p&gt;DSï¼šæ•°æ®æ®µå¯„å­˜å™¨ï¼›å­˜æ”¾æ•°æ®æ®µçš„æ®µåŸºå€¼ï¼›å®šä¹‰äº†ä¸€ä¸ªæ•°æ®æ®µã€‚&lt;/p&gt;
&lt;p&gt;SSï¼šå †æ ˆæ®µå¯„å­˜å™¨ï¼›å­˜æ”¾å †æ ˆæ®µçš„æ®µåŸºå€¼ï¼Œè”åˆspå®šä¹‰ä¸€ä¸ªå †æ ˆå€¼ï¼Œä¸€æ—¦ç¡®å®šäº†å †æ ˆåœ°å€ï¼Œå°†ä¸èƒ½éšä¾¿æ”¹å˜ã€‚&lt;/p&gt;
&lt;p&gt;å†…æ ¸æ€åˆ‡æ¢åˆ°ç”¨æˆ·æ€ä¸»è¦ä½¿ç”¨PSWï¼ˆProgram Status Wordï¼Œç¨‹åºçŠ¶æ€å­—ï¼Œåˆç§°çŠ¶æ€å¯„å­˜å™¨ï¼‰ï¼Œå…¶ä¸€èˆ¬ç”¨äºåæ˜ å¤„ç†å™¨çš„çŠ¶æ€åŠæŸäº›è®¡ç®—ç»“æœä»¥åŠæ§åˆ¶æŒ‡ä»¤çš„æ‰§è¡Œï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230301001.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;åˆ‡æ¢çš„ä»£ä»·&#34;&gt;åˆ‡æ¢çš„ä»£ä»·&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœçº¿ç¨‹åˆ‡æ¢æ˜¯ä¸€ä¸ªé«˜é¢‘æ“ä½œï¼Œé‚£å°†è€—è´¹å¾ˆå¤šCPUå¤„ç†æ—¶é—´ï¼ˆç”¨æˆ·æ€ï¼Œå†…æ ¸æ€ä¹‹é—´çš„åˆ‡æ¢ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç”šè‡³ï¼Œå¦‚æœåŒæ­¥ä»£ç å—ä¸­çš„å†…å®¹è¿‡äºç®€å•ï¼ŒçŠ¶æ€åˆ‡æ¢æ¶ˆè€—çš„æ—¶é—´æœ‰å¯èƒ½æ¯”ç”¨æˆ·ä»£ç æ‰§è¡Œçš„æ—¶é—´è¿˜è¦é•¿ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;javaå¯¹è±¡ç»“æ„ä¹‹å¯¹è±¡å¤´&#34;&gt;Javaå¯¹è±¡ç»“æ„ä¹‹å¯¹è±¡å¤´&lt;/h2&gt;
&lt;h3 id=&#34;å¯¹è±¡å¤´&#34;&gt;å¯¹è±¡å¤´&lt;/h3&gt;
&lt;p&gt;å¯¹è±¡å¤´ï¼ˆHeaderï¼‰ä¸»è¦åŒ…å«ä¸¤éƒ¨åˆ†ä¿¡æ¯ï¼šç¬¬ä¸€éƒ¨åˆ†ç”¨äºå­˜å‚¨å¯¹è±¡è‡ªèº«çš„è¿è¡Œæ—¶æ•°æ®ï¼ˆå¦‚å“ˆå¸Œç ï¼ˆHashCodeï¼‰ï¼ŒGCåˆ†ä»£å¹´é¾„ï¼Œé”çŠ¶æ€æ ‡å¿—ï¼Œçº¿ç¨‹æŒæœ‰çš„é”ï¼Œåå‘çº¿ç¨‹IDï¼Œåå‘æ—¶é—´æˆ³ç­‰ï¼Œè¿™éƒ¨åˆ†æ•°æ®é•¿åº¦åœ¨32ä½æˆ–è€…64ä½çš„è™šæ‹Ÿæœºä¸­åˆ†åˆ«ä¸º32bitä»¥åŠ64bitï¼Œå®˜æ–¹ç§°ä¹‹ä¸ºâ€œMark Wordâ€ï¼‰ï¼›&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒéƒ¨åˆ†æ˜¯ç±»å‹æŒ‡é’ˆï¼Œå³å¯¹è±¡æŒ‡å‘å®ƒçš„ç±»å…ƒæ•°æ®çš„æŒ‡é’ˆï¼Œè™šæ‹Ÿæœºå¯ä»¥é€šè¿‡è¿™ä¸ªæŒ‡é’ˆæ¥ç¡®å®šè¯¥å¯¹è±¡å±äºå“ªä¸ªç±»çš„å®ä¾‹ï¼ˆå¹¶ä¸æ˜¯æ‰€æœ‰çš„è™šæ‹Ÿæœºå®ç°éƒ½éœ€è¦åœ¨å¯¹è±¡æ•°æ®ä¸Šä¿ç•™ç±»å‹æŒ‡é’ˆï¼Œå³æŸ¥æ‰¾å¯¹è±¡çš„å…ƒæ•°æ®ä¿¡æ¯å¹¶ä¸ä¸€å®šè¦ç»è¿‡å¯¹è±¡æœ¬èº«ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœå¯¹è±¡æ˜¯ä¸€ä¸ªJavaæ•°ç»„ï¼Œé‚£ä¹ˆå¯¹è±¡å¤´è¿˜éœ€è¦è®°å½•è¯¥æ•°ç»„é•¿åº¦ï¼Œå› ä¸ºæ™®é€šçš„Javaå¯¹è±¡å¯ä»¥é€šè¿‡å…ƒæ•°æ®ä¿¡æ¯ç¡®è®¤å¯¹è±¡å¤§å°ï¼Œè€Œæ•°ç»„å´ä¸è¡Œã€‚&lt;/p&gt;
&lt;h3 id=&#34;markword&#34;&gt;MarkWord&lt;/h3&gt;
&lt;p&gt;markwordæ•°æ®çš„é•¿åº¦åœ¨32ä½å’Œ64ä½ï¼ˆæœªå¼€å¯å‹ç¼©æŒ‡é’ˆï¼‰çš„è™šæ‹Ÿæœºä¸­åˆ†åˆ«ä¸º32bitå’Œ64bitï¼Œå®ƒçš„æœ€åä¸¤ä½ä¾¿æ˜¯é”çŠ¶æ€æ ‡è¯†ä½ï¼Œç”¨æ¥æ ‡è®°å½“å‰å¯¹è±¡çš„çŠ¶æ€ï¼Œå¸¸ç”¨å€¼å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230301002.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;32ä½è™šæ‹Ÿæœºåœ¨ä¸åŒçŠ¶æ€ä¸‹markwordçš„ç»“æ„å›¾å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230301003.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;javaä¸­çš„é”&#34;&gt;Javaä¸­çš„é”&lt;/h2&gt;
&lt;h3 id=&#34;ä¸»æµé”å›¾&#34;&gt;ä¸»æµé”å›¾&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230301004.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;è‡ªæ—‹é”åŸºäºcas&#34;&gt;è‡ªæ—‹é”ï¼ˆåŸºäºCASï¼‰&lt;/h3&gt;
&lt;p&gt;å¦‚æœæŒæœ‰é”çš„çº¿ç¨‹å¯ä»¥åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…é‡Šæ”¾é”ï¼Œé‚£ä¹ˆé‚£äº›ç­‰å¾…é”çš„çº¿ç¨‹ä¾¿ä¸éœ€è¦è¿›å…¥é˜»å¡æŒ‚èµ·çŠ¶æ€ï¼Œè€Œæ˜¯è‡ªæ—‹ç­‰å¾…ä¸€ä¼šå„¿ä¾¿å¯è·å–åˆ°åŒæ­¥èµ„æºï¼Œä»è€Œé¿å…äº†çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€ï¼Œè¿™å°±æ˜¯è‡ªæ—‹é”ã€‚&lt;/p&gt;
&lt;p&gt;è‡ªæ—‹é”æœ¬èº«æ˜¯æœ‰ç¼ºç‚¹çš„ï¼Œå®ƒä¸èƒ½ä»£æ›¿é˜»å¡ã€‚&lt;/p&gt;
&lt;p&gt;è‡ªæ—‹é”è™½ç„¶é¿å…äº†çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€ï¼Œä½†å…¶å æ®äº†CPUå¤„ç†å™¨æ—¶é—´ã€‚å¦‚æœé”è¢«å ç”¨çš„æ—¶é—´å¾ˆçŸ­ï¼Œè‡ªæ—‹ç­‰å¾…çš„æ•ˆæœå°±ä¼šéå¸¸å¥½ï¼›åä¹‹ï¼Œåˆ™ä¼šç™½ç™½æµªè´¹å¤„ç†å™¨èµ„æºã€‚ç”šè‡³ï¼Œå½“çº¿ç¨‹è¿‡å¤šæ—¶ï¼Œè¿˜ä¼šå½±å“ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œè‡ªæ—‹ç­‰å¾…çš„æ—¶é—´éœ€è¦æœ‰ä¸€ä¸ªé™åº¦ï¼Œå¦‚æœè¶…è¿‡é™å®šæ¬¡æ•°ï¼ˆé»˜è®¤10æ¬¡ï¼Œå¯ä»¥ä½¿ç”¨-XX:PreBlockSpinæ¥æ›´æ”¹ï¼‰æ²¡æœ‰è·å–åˆ°é”ï¼Œåˆ™åº”å½“æŒ‚èµ·çº¿ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;è‡ªæ—‹é”åœ¨JDK1.4.2ä¸­å¼•å…¥ï¼Œä½¿ç”¨-XX:+UseSpinningæ¥å¼€å¯ã€‚JDK 6ä¸­å˜ä¸ºé»˜è®¤å¼€å¯ï¼Œå¹¶ä¸”å¼•å…¥äº†è‡ªé€‚åº”çš„è‡ªæ—‹é”ï¼ˆé€‚åº”æ€§è‡ªæ—‹é”ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è‡ªé€‚åº”æ„å‘³ç€è‡ªæ—‹çš„æ—¶é—´ï¼ˆæ¬¡æ•°ï¼‰ä¸å†å›ºå®šï¼Œè€Œæ˜¯ç”±å‰ä¸€æ¬¡åœ¨åŒä¸€ä¸ªé”ä¸Šçš„è‡ªæ—‹æ—¶é—´åŠé”çš„æ‹¥æœ‰è€…çš„çŠ¶æ€æ¥å†³å®šã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœåœ¨åŒä¸€ä¸ªé”å¯¹è±¡ä¸Šï¼Œè‡ªæ—‹ç­‰å¾…åˆšåˆšæˆåŠŸè·å¾—è¿‡é”ï¼Œå¹¶ä¸”æŒæœ‰é”çš„çº¿ç¨‹æ­£åœ¨è¿è¡Œä¸­ï¼Œé‚£ä¹ˆè™šæ‹Ÿæœºå°±ä¼šè®¤ä¸ºè¿™æ¬¡è‡ªæ—‹ä¹Ÿæ˜¯å¾ˆæœ‰å¯èƒ½å†æ¬¡æˆåŠŸï¼Œè¿›è€Œå®ƒå°†å…è®¸è‡ªæ—‹ç­‰å¾…æŒç»­ç›¸å¯¹æ›´é•¿çš„æ—¶é—´ã€‚å¦‚æœå¯¹äºæŸä¸ªé”ï¼Œè‡ªæ—‹å¾ˆå°‘æˆåŠŸè·å¾—è¿‡ï¼Œé‚£åœ¨ä»¥åå°è¯•è·å–è¿™ä¸ªé”æ—¶å°†å¯èƒ½çœç•¥æ‰è‡ªæ—‹è¿‡ç¨‹ï¼Œç›´æ¥é˜»å¡çº¿ç¨‹ï¼Œé¿å…æµªè´¹å¤„ç†å™¨èµ„æºã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230301005.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;jvmé’ˆå¯¹å½“å‰cpuçš„è´Ÿè·æƒ…å†µè¿˜åšäº†å¦‚ä¸‹è‡ªæ—‹é”ä¼˜åŒ–æ“ä½œ&#34;&gt;JVMé’ˆå¯¹å½“å‰CPUçš„è´Ÿè·æƒ…å†µè¿˜åšäº†å¦‚ä¸‹è‡ªæ—‹é”ä¼˜åŒ–æ“ä½œï¼š&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœå¹³å‡è´Ÿè½½å°äºCPUsåˆ™ä¸€ç›´è‡ªæ—‹&lt;/li&gt;
&lt;li&gt;å¦‚æœæœ‰è¶…è¿‡(CPUs/2)ä¸ªçº¿ç¨‹æ­£åœ¨è‡ªæ—‹ï¼Œåˆ™åæ¥çº¿ç¨‹ç›´æ¥é˜»å¡&lt;/li&gt;
&lt;li&gt;å¦‚æœæ­£åœ¨è‡ªæ—‹çš„çº¿ç¨‹å‘ç°Ownerå‘ç”Ÿäº†å˜åŒ–åˆ™å»¶è¿Ÿè‡ªæ—‹æ—¶é—´ï¼ˆè‡ªæ—‹è®¡æ•°ï¼‰æˆ–è¿›å…¥é˜»å¡&lt;/li&gt;
&lt;li&gt;å¦‚æœCPUå¤„äºèŠ‚ç”µæ¨¡å¼åˆ™åœæ­¢è‡ªæ—‹&lt;/li&gt;
&lt;li&gt;è‡ªæ—‹æ—¶é—´çš„æœ€åæƒ…å†µæ˜¯CPUçš„å­˜å‚¨å»¶è¿Ÿï¼ˆCPU Aå­˜å‚¨äº†ä¸€ä¸ªæ•°æ®ï¼Œåˆ°CPU Bå¾—çŸ¥è¿™ä¸ªæ•°æ®ç›´æ¥çš„æ—¶é—´å·®ï¼‰&lt;/li&gt;
&lt;li&gt;è‡ªæ—‹æ—¶ä¼šé€‚å½“æ”¾å¼ƒçº¿ç¨‹ä¼˜å…ˆçº§ä¹‹é—´çš„å·®å¼‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;synchronizedæ— é”åå‘é”è½»é‡çº§é”é‡é‡çº§é”&#34;&gt;Synchronizedï¼ˆæ— é”ï¼Œåå‘é”ï¼Œè½»é‡çº§é”ï¼Œé‡é‡çº§é”ï¼‰&lt;/h3&gt;
&lt;h4 id=&#34;synchronizedé˜Ÿåˆ—&#34;&gt;Synchronizedé˜Ÿåˆ—&lt;/h4&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230301006.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å¯ä»¥çœ‹å‡ºï¼Œsynchronizedæœ‰å¤šä¸ªé˜Ÿåˆ—ï¼Œå½“å¤šä¸ªçº¿ç¨‹ä¸€èµ·è®¿é—®æŸä¸ªå¯¹è±¡ç›‘è§†å™¨ï¼ˆmonitorï¼Œå…¶æ˜¯ä¾èµ–äºåº•å±‚çš„æ“ä½œç³»ç»Ÿçš„Mutex Lockï¼ˆäº’æ–¥é”ï¼‰æ¥å®ç°çš„çº¿ç¨‹åŒæ­¥ï¼‰ï¼‰çš„æ—¶å€™ï¼Œå¯¹è±¡ç›‘è§†å™¨ä¼šå°†è¿™äº›çº¿ç¨‹å­˜å‚¨åœ¨ä¸åŒçš„å®¹å™¨é‡Œã€‚&lt;/p&gt;
&lt;h5 id=&#34;ç»“æ„æ¦‚è¿°&#34;&gt;ç»“æ„æ¦‚è¿°&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;ContentionListï¼šç«äº‰é˜Ÿåˆ—ï¼Œæ‰€æœ‰è¯·æ±‚é”çš„çº¿ç¨‹é¦–å…ˆä¼šè¢«æ”¾å…¥æ­¤é˜Ÿåˆ—ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;EntryListï¼šContentionListä¸­ä¸€äº›æœ‰èµ„æ ¼è·å–åŒæ­¥èµ„æºçš„çº¿ç¨‹å°†è¢«ç§»åŠ¨åˆ°æ­¤é˜Ÿåˆ—ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;WaitSetï¼šè°ƒç”¨waitæ–¹æ³•è¢«é˜»å¡çš„çº¿ç¨‹ï¼Œæ”¾äºæ­¤å¤„ã€‚&lt;/li&gt;
&lt;li&gt;OnDeckï¼šä»»ä½•æ—¶åˆ»ï¼Œæœ€å¤šåªæœ‰ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨ç«äº‰é”ï¼Œè¯¥çº¿ç¨‹ä¾¿æ˜¯OnDeckã€‚&lt;/li&gt;
&lt;li&gt;Ownerï¼šå·²ç»è·å–åˆ°é”çš„çº¿ç¨‹è¢«ç§°ä¸ºOwnerã€‚&lt;/li&gt;
&lt;li&gt;!Ownerï¼šå·²ç»é‡Šæ”¾é”çš„çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;é˜Ÿåˆ—åä½œè¿‡ç¨‹&#34;&gt;é˜Ÿåˆ—åä½œè¿‡ç¨‹&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;JVMæ¯æ¬¡éƒ½ä¼šä»é˜Ÿåˆ—å°¾éƒ¨å–å‡ºä¸€ä¸ªçº¿ç¨‹ç”¨äºé”ç«äº‰å€™é€‰è€…ï¼ˆOnDeckï¼‰ï¼Œä½†æ˜¯å¹¶å‘æƒ…å†µä¸‹ï¼ŒContentionListä¼šè¢«å¤§é‡çš„çº¿ç¨‹è¿›è¡ŒCASè®¿é—®ï¼Œä¸ºäº†é™ä½å¯¹å°¾éƒ¨å…ƒç´ çš„ç«äº‰ï¼ŒJVMä¼šå°†ä¸€éƒ¨åˆ†çº¿ç¨‹ç§»åŠ¨åˆ°EntryListä¸­ä½œä¸ºå€™é€‰ç«äº‰çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;Owneråœ¨unlockæ—¶ï¼Œä¹Ÿä¼šå°†ContentionListä¸­çš„éƒ¨åˆ†çº¿ç¨‹è¿ç§»åˆ°EntryListï¼Œå¹¶æŒ‡å®šEntryListä¸­çš„æŸä¸ªçº¿ç¨‹ä¸ºOndeckï¼ˆä¸€èˆ¬æ˜¯æœ€å…ˆè¿›å»çš„çº¿ç¨‹ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;Ownerä¸ä¼šç›´æ¥å°†é”ä¼ é€’ç»™OnDeckï¼Œè€Œæ˜¯å°†é”ç«äº‰çš„æƒåˆ©äº¤ç»™OnDeckï¼ŒOnDeckéœ€è¦é‡æ–°å»ç«äº‰é”ã€‚è¿™æ ·è™½ç„¶ç‰ºç‰²äº†ä¸€äº›å…¬å¹³æ€§ï¼Œä½†èƒ½æå¤§çš„æé«˜ç³»ç»Ÿååé‡ï¼Œåœ¨JVMä¸­ï¼Œè¿™ç§é€‰æ‹©è¡Œä¸ºè¢«ç§°ä¸ºâ€œç«äº‰åˆ‡æ¢â€ã€‚&lt;/li&gt;
&lt;li&gt;OnDeckè·å–åˆ°é”åå°±ä¼šå˜ä¸ºOwnerï¼Œè€Œæ²¡æœ‰å¾—åˆ°é”çš„åˆ™ä»ç„¶åœç•™åœ¨EntryListï¼›å¦‚æœOnDeckçº¿ç¨‹è¢«waité˜»å¡ï¼Œåˆ™ä¼šè¢«ç§»åŠ¨è‡³WaitSetï¼Œç›´åˆ°æŸä¸ªæ—¶åˆ»è¢«notifyæˆ–notifyAllå”¤é†’ï¼Œæ‰èƒ½é‡æ–°è¿›å…¥EntryLIstã€‚&lt;/li&gt;
&lt;li&gt;å¤„äºContentionListã€EntryListã€WaitSetä¸­çš„çº¿ç¨‹éƒ½å¤„äºé˜»å¡çŠ¶æ€ï¼Œè¯¥é˜»å¡æ˜¯ç”±æ“ä½œç³»ç»Ÿæ¥å®Œæˆçš„ï¼ˆLinuxå†…æ ¸ä¸‹é‡‡ç”¨pthread_mutex_lockå†…æ ¸å‡½æ•°å®ç°çš„ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;æ— é”cas&#34;&gt;æ— é”ï¼ˆCASï¼‰&lt;/h4&gt;
&lt;p&gt;æ— é”æ²¡æœ‰å¯¹èµ„æºè¿›è¡Œé”å®šï¼Œæ‰€æœ‰çš„çº¿ç¨‹éƒ½èƒ½è®¿é—®å¹¶ä¿®æ”¹åŒä¸€ä¸ªèµ„æºï¼Œä½†åŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½ä¿®æ”¹æˆåŠŸã€‚&lt;/p&gt;
&lt;p&gt;æ— é”çš„ç‰¹ç‚¹å°±æ˜¯ä¿®æ”¹æ“ä½œåœ¨å¾ªç¯å†…è¿›è¡Œï¼Œçº¿ç¨‹ä¼šä¸æ–­çš„å°è¯•ä¿®æ”¹å…±äº«èµ„æºã€‚å¦‚æœæ²¡æœ‰å†²çªå°±ä¿®æ”¹æˆåŠŸå¹¶é€€å‡ºï¼Œå¦åˆ™å°±ä¼šç»§ç»­å¾ªç¯å°è¯•ã€‚å¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹ä¿®æ”¹åŒä¸€ä¸ªå€¼ï¼Œå¿…å®šä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½ä¿®æ”¹æˆåŠŸï¼Œè€Œå…¶ä»–ä¿®æ”¹å¤±è´¥çš„çº¿ç¨‹ä¼šä¸æ–­é‡è¯•ç›´åˆ°ä¿®æ”¹æˆåŠŸã€‚æ— é”æ— æ³•å…¨é¢ä»£æ›¿æœ‰é”ï¼Œä½†æ— é”åœ¨æŸäº›åœºåˆä¸‹çš„æ€§èƒ½æ˜¯éå¸¸é«˜çš„ã€‚&lt;/p&gt;
&lt;h4 id=&#34;åå‘é”&#34;&gt;åå‘é”&lt;/h4&gt;
&lt;p&gt;åå‘é”æ˜¯æŒ‡ä¸€æ®µåŒæ­¥ä»£ç ä¸€ç›´è¢«ä¸€ä¸ªçº¿ç¨‹æ‰€è®¿é—®ï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹ä¾¿ä¼šè‡ªåŠ¨è·å–é”ï¼Œé™ä½äº†è·å–é”çš„ä»£ä»·ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œä¸å­˜åœ¨å¤šçº¿ç¨‹ç«äº‰ï¼Œåˆ™çº¿ç¨‹ä¸éœ€è¦è§¦å‘åŒæ­¥ï¼Œæ­¤æ—¶ä¸ºäº†æé«˜çº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç çš„æ•ˆç‡ï¼Œä¾¿å‡ºç°äº†åå‘é”ã€‚&lt;/p&gt;
&lt;h5 id=&#34;åå‘é”æ‰§è¡Œè¿‡ç¨‹&#34;&gt;åå‘é”æ‰§è¡Œè¿‡ç¨‹&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;è®¿é—®MarkWordä¸­åå‘é”çš„æ ‡è¯†ä½æ˜¯å¦è®¾ç½®ä¸º1ï¼Œé”æ ‡è¯†ä½æ˜¯å¦è®¾ç½®ä¸º01ï¼Œç¡®è®¤ä¸ºå¯åå‘çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœä¸ºå¯åå‘çŠ¶æ€ï¼Œåˆ™åˆ¤æ–­çº¿ç¨‹idæ˜¯å¦æŒ‡å‘å½“å‰çº¿ç¨‹ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿›å…¥æ­¥éª¤5ï¼Œå¦åˆ™è¿›å…¥æ­¥éª¤3ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœçº¿ç¨‹idæœªæŒ‡å‘å½“å‰çº¿ç¨‹ï¼Œåˆ™é€šè¿‡CASæ“ä½œç«äº‰é”ï¼Œå¦‚æœç«äº‰æˆåŠŸï¼Œåˆ™å°†MarkWordä¸­çš„çº¿ç¨‹idè®¾ç½®ä¸ºå½“å‰çº¿ç¨‹idï¼Œç„¶åæ‰§è¡Œæ­¥éª¤5ï¼Œå¦åˆ™è¿›å…¥æ­¥éª¤4ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœCASè·å–é”å¤±è´¥ï¼Œåˆ™è¡¨ç¤ºå­˜åœ¨é”ç«äº‰ã€‚å½“åˆ°è¾¾å…¨å±€å®‰å…¨ç‚¹ï¼ˆsafepointï¼Œä¼šå¯¼è‡´å¾ˆçŸ­æ—¶é—´çš„stop-the-worldï¼‰æ—¶ï¼Œè·å–åå‘é”çš„çº¿ç¨‹å°†è¢«æŒ‚èµ·ï¼Œåå‘é”å‡çº§ä¸ºè½»é‡çº§é”ï¼Œç„¶åè¢«é˜»å¡åœ¨å®‰å…¨ç‚¹çš„çº¿ç¨‹ç»§ç»­å¾€ä¸‹æ‰§è¡ŒåŒæ­¥ä»£ç ã€‚&lt;/li&gt;
&lt;li&gt;æ‰§è¡ŒåŒæ­¥ä»£ç ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h5 id=&#34;åå‘é”çš„é‡Šæ”¾&#34;&gt;åå‘é”çš„é‡Šæ”¾&lt;/h5&gt;
&lt;p&gt;åå‘é”åªæœ‰é‡åˆ°å…¶ä»–çº¿ç¨‹å°è¯•ç«äº‰åå‘é”æ—¶ï¼ŒæŒæœ‰åå‘é”çš„çº¿ç¨‹æ‰ä¼šé‡Šæ”¾é”ï¼Œçº¿ç¨‹ä¸ä¼šä¸»åŠ¨å»é‡Šæ”¾åå‘é”ã€‚&lt;/p&gt;
&lt;p&gt;åå‘é”çš„æ’¤é”€ï¼Œéœ€è¦ç­‰å¾…å…¨å±€å®‰å…¨ç‚¹ï¼ˆåœ¨è¿™ä¸ªæ—¶é—´ç‚¹ä¸Šæ²¡æœ‰å­—èŠ‚ç æ­£åœ¨æ‰§è¡Œï¼‰ï¼Œå®ƒä¼šé¦–å…ˆæš‚åœæ‹¥æœ‰åå‘é”çš„çº¿ç¨‹ï¼Œåˆ¤æ–­é”å¯¹è±¡æ˜¯å¦å¤„äºè¢«é”å®šçŠ¶æ€ï¼Œæ’¤é”€åå‘é”åæ¢å¤åˆ°æœªé”å®šï¼ˆæ ‡å¿—ä½ä¸ºâ€œ01â€ï¼‰æˆ–è½»é‡çº§é”ï¼ˆæ ‡å¿—ä½ä¸ºâ€œ00â€ï¼‰çš„çŠ¶æ€ã€‚&lt;/p&gt;
&lt;h5 id=&#34;åå‘é”é€‚ç”¨åœºæ™¯&#34;&gt;åå‘é”é€‚ç”¨åœºæ™¯&lt;/h5&gt;
&lt;p&gt;å§‹ç»ˆåªæœ‰ä¸€ä¸ªçº¿ç¨‹æ“ä½œåŒæ­¥èµ„æºï¼Œä¹Ÿå°±æ˜¯é”æ— ç«äº‰çŠ¶å†µä¸‹ä½¿ç”¨ã€‚ä¸€æ—¦æœ‰äº†ç«äº‰ï¼Œåå‘é”ä¾¿ä¼šå‡çº§ä¸ºè½»é‡çº§é”ï¼ˆå‡çº§éœ€è¦æ’¤é”€åå‘é”ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šstop-the-worldï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœå­˜åœ¨é«˜å¹¶å‘é”ç«äº‰ï¼Œåº”å½“ç¦ç”¨åå‘é”ï¼Œè¿™æ ·å¯ä»¥é€‚å½“æé«˜ç¨‹åºæ€§èƒ½ã€‚&lt;/p&gt;
&lt;h5 id=&#34;jvmå¼€å¯å…³é—­åå‘é”&#34;&gt;jvmå¼€å¯/å…³é—­åå‘é”&lt;/h5&gt;
&lt;p&gt;å¼€å¯åå‘é”ï¼š-XX:+UseBiasedLocking -XX:BiasedLockingStartupDelay=0&lt;br&gt;
ï¼ˆ-XX:BiasedLockingStartupDelay=0çš„ä½œç”¨æ˜¯åœ¨è™šæ‹Ÿæœºå¯åŠ¨åï¼Œç«‹å³å¯ç”¨åå‘é”ï¼Œå¦‚æœä¸è®¾ç½®è¯¥å‚æ•°ï¼Œé»˜è®¤è™šæ‹Ÿä¼šåœ¨4ç§’åï¼Œæ‰å¯åŠ¨åå‘é”ã€‚ï¼‰&lt;/p&gt;
&lt;p&gt;å…³é—­åå‘é”ï¼š-XX:-UseBiasedLocking&lt;/p&gt;
&lt;h4 id=&#34;è½»é‡çº§é”&#34;&gt;è½»é‡çº§é”&lt;/h4&gt;
&lt;p&gt;è½»é‡çº§é”æ˜¯ç”±åå‘é”å‡çº§è€Œæ¥çš„ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹æŒæœ‰åå‘é”æ‰§è¡ŒåŒæ­¥å—æ—¶ï¼Œå­˜åœ¨å¦å¤–çš„çº¿ç¨‹æ¥ç«äº‰é”ï¼Œè¿™æ—¶åå‘é”ä¾¿ä¼šå‡çº§ä¸ºè½»é‡çº§é”ã€‚&lt;/p&gt;
&lt;p&gt;è½»é‡çº§é”æ‰§è¡Œè¿‡ç¨‹ï¼š&lt;/p&gt;
&lt;p&gt;aã€åœ¨ä»£ç è¿›å…¥åŒæ­¥å—çš„æ—¶å€™ï¼Œå¦‚æœåŒæ­¥å¯¹è±¡çŠ¶æ€ä¸ºæ— é”çŠ¶æ€ï¼ˆé”æ ‡è¯†ä½ï¼š01ï¼Œæ˜¯å¦åå‘é”æ ‡è¯†ä½ï¼š0ï¼‰ï¼Œè™šæ‹Ÿæœºé¦–å…ˆä¼šåœ¨å½“å‰çº¿ç¨‹çš„æ ˆå¸§ä¸­å»ºç«‹ä¸€ä¸ªåä¸ºé”è®°å½•ï¼ˆLock Recordï¼‰çš„ç©ºé—´ï¼Œç”¨äºå­˜å‚¨å¯¹è±¡ç›®å‰çš„MarkWordçš„æ‹·è´ï¼ˆå®˜æ–¹ç§°ä¹‹ä¸ºDisplaced Mark Wordï¼‰ã€‚çº¿ç¨‹å †æ ˆä¸å¯¹è±¡å¤´çŠ¶æ€å›¾å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230301007.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;bã€æ‹·è´å¯¹è±¡å¤´çš„MarkWordå¤åˆ¶åˆ°é”è®°å½•ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;cã€æ‹·è´æˆåŠŸåï¼Œè™šæ‹Ÿæœºå°†ä½¿ç”¨CASæ“ä½œå°è¯•å°†å¯¹è±¡çš„MarkWordæ›´æ–°ä¸ºæŒ‡å‘Lock Recordçš„æŒ‡é’ˆï¼Œå¹¶å°†Lock Recordä¸­çš„owneræŒ‡é’ˆæŒ‡å‘object mark wordï¼Œå¦‚æœæ›´æ–°æˆåŠŸï¼Œåˆ™æ‰§è¡Œæ­¥éª¤dï¼Œå¦åˆ™æ‰§è¡Œæ­¥éª¤eã€‚&lt;/p&gt;
&lt;p&gt;dã€æ›´æ–°æˆåŠŸåï¼Œè¯¥çº¿ç¨‹ä¾¿æ‹¥æœ‰äº†è¿™ä¸ªå¯¹è±¡çš„é”ï¼Œæ­¤æ—¶å¯¹è±¡MarkWordä¸­çš„é”æ ‡è¯†ä½å°†è¢«è®¾ç½®ä¸ºâ€˜00â€™ï¼Œè¡¨ç¤ºæ­¤å¯¹è±¡å¤„äºè½»é‡çº§é”å®šçŠ¶æ€ã€‚çº¿ç¨‹å †æ ˆä¸å¯¹è±¡å¤´çŠ¶æ€å›¾å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230301008.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;eã€å¦‚æœè¿™ä¸ªæ›´æ–°æ“ä½œå¤±è´¥äº†ï¼Œè™šæ‹Ÿæœºé¦–å…ˆä¼šæ£€æŸ¥å¯¹è±¡çš„MarkWordæ˜¯å¦æŒ‡å‘å½“å‰çº¿ç¨‹çš„æ ˆå¸§ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¡¨ç¤ºå½“å‰çº¿ç¨‹å·²ç»æ‹¥æœ‰äº†è¿™ä¸ªå¯¹è±¡çš„é”ï¼Œé‚£å°±å¯ä»¥ç›´æ¥è¿›å…¥åŒæ­¥å—ç»§ç»­æ‰§è¡Œï¼Œå¦åˆ™è¯´æ˜æœ‰å¤šä¸ªçº¿ç¨‹åœ¨ç«äº‰é”ã€‚&lt;/p&gt;
&lt;p&gt;è‹¥å½“å‰åªæœ‰ä¸€ä¸ªç­‰å¾…çº¿ç¨‹ï¼Œåˆ™è¯¥çº¿ç¨‹è¿›è¡Œè‡ªæ—‹ç­‰å¾…ï¼Œå½“è‡ªæ—‹è¶…è¿‡é˜ˆå€¼ï¼Œæˆ–è€…ä¸€ä¸ªçº¿ç¨‹æŒæœ‰é”ï¼Œä¸€ä¸ªåœ¨è‡ªæ—‹ï¼Œåˆæœ‰ç¬¬ä¸‰ä¸ªæ¥è®¿é—®é”æ—¶ï¼Œè½»é‡çº§é”ä¾¿ä¼šè†¨èƒ€ä¸ºé‡é‡çº§é”ã€‚&lt;/p&gt;
&lt;p&gt;é”çš„æ ‡è¯†ä½å°†è¢«è®¾ç½®ä¸ºâ€˜10â€™ï¼ŒMarkWordä¸­å­˜å‚¨çš„å°±æ˜¯æŒ‡å‘é‡é‡çº§é”ï¼ˆäº’æ–¥é‡ï¼‰çš„æŒ‡é’ˆï¼Œåé¢ç­‰å¾…é”çš„çº¿ç¨‹ä¹Ÿä¼šè¿›å…¥é˜»å¡çŠ¶æ€ã€‚&lt;/p&gt;
&lt;h4 id=&#34;æ•´ä½“æ‰§è¡Œè¿‡ç¨‹&#34;&gt;æ•´ä½“æ‰§è¡Œè¿‡ç¨‹&lt;/h4&gt;
&lt;h5 id=&#34;é”å‡çº§æµç¨‹å›¾&#34;&gt;é”å‡çº§æµç¨‹å›¾ï¼š&lt;/h5&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230301009.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h5 id=&#34;synchronizedæ‰§è¡Œè¿‡ç¨‹&#34;&gt;synchronizedæ‰§è¡Œè¿‡ç¨‹ï¼š&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;æ£€æµ‹Mark Wordä¸­çš„é”æ ‡è¯†æ˜¯å¦ä¸ºå¯åå‘çŠ¶æ€ï¼ˆé”æ ‡è¯†ä½ï¼š01ï¼Œæ˜¯å¦åå‘é”ï¼š1ï¼‰ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ä¸ºåå‘é”ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœä¸æ˜¯ï¼Œåˆ™æ£€æŸ¥Mark Wordé‡Œé¢çš„çº¿ç¨‹idæ˜¯ä¸æ˜¯å½“å‰çº¿ç¨‹çš„IDï¼Œå¦‚æœæ˜¯ï¼Œè¡¨ç¤ºå½“å‰çº¿ç¨‹å¤„äºåå‘é”&lt;/li&gt;
&lt;li&gt;å¦‚æœä¸æ˜¯ï¼Œåˆ™ä½¿ç”¨CASå°†å½“å‰çº¿ç¨‹çš„IDæ›¿æ¢Mard Wordï¼Œå¦‚æœæˆåŠŸåˆ™è¡¨ç¤ºå½“å‰çº¿ç¨‹è·å¾—åå‘é”ï¼Œç½®åå‘æ ‡å¿—ä½1&lt;/li&gt;
&lt;li&gt;å¦‚æœå¤±è´¥ï¼Œåˆ™è¯´æ˜å‘ç”Ÿç«äº‰ï¼Œæ’¤é”€åå‘é”ï¼Œè¿›è€Œå‡çº§ä¸ºè½»é‡çº§é”ã€‚&lt;/li&gt;
&lt;li&gt;å½“å‰çº¿ç¨‹ä½¿ç”¨CASå°†å¯¹è±¡å¤´çš„Mark Wordæ›¿æ¢ä¸ºé”è®°å½•æŒ‡é’ˆï¼Œå¦‚æœæˆåŠŸï¼Œå½“å‰çº¿ç¨‹è·å¾—é”&lt;/li&gt;
&lt;li&gt;å¦‚æœå¤±è´¥ï¼Œè¡¨ç¤ºå…¶ä»–çº¿ç¨‹ç«äº‰é”ï¼Œå½“å‰çº¿ç¨‹ä¾¿å°è¯•ä½¿ç”¨è‡ªæ—‹æ¥è·å–é”ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœè‡ªæ—‹æˆåŠŸåˆ™ä¾ç„¶å¤„äºè½»é‡çº§çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœè‡ªæ—‹å¤±è´¥ï¼Œåˆ™å‡çº§ä¸ºé‡é‡çº§é”ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;é”ä¼˜åŒ–&#34;&gt;é”ä¼˜åŒ–&lt;/h3&gt;
&lt;h4 id=&#34;å‡å°‘é”çš„æ—¶é—´&#34;&gt;å‡å°‘é”çš„æ—¶é—´&lt;/h4&gt;
&lt;p&gt;ä¸éœ€è¦åŒæ­¥æ‰§è¡Œçš„ä»£ç ï¼Œå°½é‡ä¸è¦æ”¾åœ¨åŒæ­¥å—ä¸­ï¼Œè¿™æ ·å¯ä»¥è®©é”æ›´å¿«çš„é‡Šæ”¾ã€‚&lt;/p&gt;
&lt;h4 id=&#34;å‡å°‘é”çš„ç²’åº¦&#34;&gt;å‡å°‘é”çš„ç²’åº¦&lt;/h4&gt;
&lt;p&gt;é”ç²’åº¦çš„å‡å°‘æ ¸å¿ƒæ€æƒ³æ˜¯åˆ©ç”¨ç©ºé—´æ¢æ—¶é—´ï¼Œå®ƒå°†ç‰©ç†ä¸Šçš„ä¸€ä¸ªé”ï¼Œæ‹†åˆ†ä¸ºé€»è¾‘ä¸Šçš„å¤šä¸ªé”ï¼Œå¢åŠ å¹¶å‘åº¦ï¼Œä»è€Œé™ä½äº†é”ç«äº‰ã€‚&lt;/p&gt;
&lt;p&gt;å…¸å‹ä»£è¡¨æœ‰ï¼šConcurrentHashMapï¼ˆjdk1.8ä¹‹å‰ï¼Œæœ‰ç”¨åˆ°Segmentæ•°ç»„ï¼‰ï¼›LongAdderï¼ˆå®ç°æœºåˆ¶ä¸ConcurrentHashMapç±»ä¼¼ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªæ ¹æ®å½“å‰å¹¶å‘çŠ¶æ€åŠ¨æ€æ”¹å˜çš„Cellæ•°ç»„ï¼Œæ³¨æ„ï¼šå…¶ç«äº‰ç»´åº¦ä¸ºcellä¸ªæ•°+1ï¼Œå› ä¸ºè¿˜æœ‰ä¸€ä¸ªbaseæ•°ç»„ï¼‰ï¼›LinkedBlockQueueï¼ˆå‡ºé˜Ÿï¼Œå…¥é˜Ÿé‡‡ç”¨äº†ä¸åŒçš„é”ï¼Œå¢åŠ äº†å¹¶è¡Œæ•ˆç‡ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;é”çš„æ‹†åˆ†ä¸èƒ½æ— é™æ‹†ï¼Œéœ€è¦æ ¹æ®å½“å‰ç³»ç»ŸCPUæ ¸æ•°è¿›è¡Œé™åˆ¶ï¼ˆä¸èƒ½è¶…è¿‡CPUæ ¸æ•°ï¼‰ã€‚&lt;/p&gt;
&lt;h4 id=&#34;é”ç²—åŒ–&#34;&gt;é”ç²—åŒ–&lt;/h4&gt;
&lt;p&gt;å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæ˜¯è¦æ±‚å°†é”ç²’åº¦å‡å°ï¼Œä½†æŸäº›æƒ…å†µä¸‹ï¼Œä¹Ÿéœ€è¦ç²—åŒ–é”ç²’åº¦ï¼Œæ¯”å¦‚å¾ªç¯ä¸­åŠ é”ã€‚&lt;/p&gt;
&lt;h4 id=&#34;ä½¿ç”¨è¯»å†™é”&#34;&gt;ä½¿ç”¨è¯»å†™é”&lt;/h4&gt;
&lt;p&gt;ReentrantReadWriteLock æ˜¯ä¸€ä¸ªè¯»å†™é”ï¼Œè¯»æ“ä½œåŠ è¯»é”ï¼Œå¯ä»¥å¹¶å‘è¯»ï¼Œå†™æ“ä½œä½¿ç”¨å†™é”ï¼Œåªèƒ½å•çº¿ç¨‹å†™ã€‚ä¾‹å¦‚ï¼šCopyOnWriteArrayList ã€CopyOnWriteArraySet&lt;/p&gt;
&lt;p&gt;CopyOnWriteå®¹å™¨å³å†™æ—¶å¤åˆ¶çš„å®¹å™¨ã€‚é€šä¿—çš„ç†è§£æ˜¯å½“æˆ‘ä»¬å¾€ä¸€ä¸ªå®¹å™¨æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œä¸ç›´æ¥å¾€å½“å‰å®¹å™¨æ·»åŠ ï¼Œè€Œæ˜¯å…ˆå°†å½“å‰å®¹å™¨è¿›è¡ŒCopyï¼Œå¤åˆ¶å‡ºä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œç„¶åæ–°çš„å®¹å™¨é‡Œæ·»åŠ å…ƒç´ ï¼Œæ·»åŠ å®Œå…ƒç´ ä¹‹åï¼Œå†å°†åŸå®¹å™¨çš„å¼•ç”¨æŒ‡å‘æ–°çš„å®¹å™¨ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯æˆ‘ä»¬å¯ä»¥å¯¹CopyOnWriteå®¹å™¨è¿›è¡Œå¹¶å‘çš„è¯»ï¼Œè€Œä¸éœ€è¦åŠ é”ï¼Œå› ä¸ºå½“å‰å®¹å™¨ä¸ä¼šæ·»åŠ ä»»ä½•å…ƒç´ ã€‚æ‰€ä»¥CopyOnWriteå®¹å™¨ä¹Ÿæ˜¯ä¸€ç§è¯»å†™åˆ†ç¦»çš„æ€æƒ³ï¼Œè¯»å’Œå†™ä¸åŒçš„å®¹å™¨ã€‚&lt;/p&gt;
&lt;p&gt;CopyOnWriteå¹¶å‘å®¹å™¨ç”¨äºè¯»å¤šå†™å°‘çš„å¹¶å‘åœºæ™¯ï¼Œå› ä¸ºï¼Œè¯»çš„æ—¶å€™æ²¡æœ‰é”ï¼Œä½†æ˜¯å¯¹å…¶è¿›è¡Œæ›´æ”¹çš„æ—¶å€™æ˜¯ä¼šåŠ é”çš„ï¼Œå¦åˆ™ä¼šå¯¼è‡´å¤šä¸ªçº¿ç¨‹åŒæ—¶å¤åˆ¶å‡ºå¤šä¸ªå‰¯æœ¬ï¼Œå„è‡ªä¿®æ”¹å„è‡ªçš„ã€‚&lt;/p&gt;
&lt;h4 id=&#34;ä½¿ç”¨cas&#34;&gt;ä½¿ç”¨CAS&lt;/h4&gt;
&lt;p&gt;å¦‚æœéœ€è¦åŒæ­¥çš„æ“ä½œæ‰§è¡Œé€Ÿåº¦éå¸¸å¿«ï¼Œå¹¶ä¸”çº¿ç¨‹ç«äº‰å¹¶ä¸æ¿€çƒˆï¼Œè¿™æ—¶å€™ä½¿ç”¨casæ•ˆç‡ä¼šæ›´é«˜ï¼Œå› ä¸ºåŠ é”ä¼šå¯¼è‡´çº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå¦‚æœä¸Šä¸‹æ–‡åˆ‡æ¢çš„è€—æ—¶æ¯”åŒæ­¥æ“ä½œæœ¬èº«æ›´è€—æ—¶ï¼Œä¸”çº¿ç¨‹å¯¹èµ„æºçš„ç«äº‰ä¸æ¿€çƒˆï¼Œä½¿ç”¨volatiled+casæ“ä½œä¼šæ˜¯éå¸¸é«˜æ•ˆçš„é€‰æ‹©ã€‚&lt;/p&gt;
&lt;h4 id=&#34;æ¶ˆé™¤ç¼“å­˜è¡Œçš„ä¼ªå…±äº«&#34;&gt;æ¶ˆé™¤ç¼“å­˜è¡Œçš„ä¼ªå…±äº«&lt;/h4&gt;
&lt;p&gt;é™¤äº†æˆ‘ä»¬åœ¨ä»£ç ä¸­ä½¿ç”¨çš„åŒæ­¥é”å’Œjvmè‡ªå·±å†…ç½®çš„åŒæ­¥é”å¤–ï¼Œè¿˜æœ‰ä¸€ç§éšè—çš„é”å°±æ˜¯ç¼“å­˜è¡Œï¼Œå®ƒä¹Ÿè¢«ç§°ä¸ºæ€§èƒ½æ€æ‰‹ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å¤šæ ¸cupçš„å¤„ç†å™¨ä¸­ï¼Œæ¯ä¸ªcupéƒ½æœ‰è‡ªå·±ç‹¬å çš„ä¸€çº§ç¼“å­˜ã€äºŒçº§ç¼“å­˜ï¼Œç”šè‡³è¿˜æœ‰ä¸€ä¸ªå…±äº«çš„ä¸‰çº§ç¼“å­˜ï¼Œä¸ºäº†æé«˜æ€§èƒ½ï¼Œcpuè¯»å†™æ•°æ®æ˜¯ä»¥ç¼“å­˜è¡Œä¸ºæœ€å°å•å…ƒè¯»å†™çš„ï¼›32ä½çš„cpuç¼“å­˜è¡Œä¸º32å­—èŠ‚ï¼Œ64ä½cupçš„ç¼“å­˜è¡Œä¸º64å­—èŠ‚ï¼Œè¿™å°±å¯¼è‡´äº†ä¸€äº›é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå¤šä¸ªä¸éœ€è¦åŒæ­¥çš„å˜é‡å› ä¸ºå­˜å‚¨åœ¨è¿ç»­çš„32å­—èŠ‚æˆ–64å­—èŠ‚é‡Œé¢ï¼Œå½“éœ€è¦å…¶ä¸­çš„ä¸€ä¸ªå˜é‡æ—¶ï¼Œå°±å°†å®ƒä»¬ä½œä¸ºä¸€ä¸ªç¼“å­˜è¡Œä¸€èµ·åŠ è½½åˆ°æŸä¸ªcup-1ç§æœ‰çš„ç¼“å­˜ä¸­ï¼ˆè™½ç„¶åªéœ€è¦ä¸€ä¸ªå˜é‡ï¼Œä½†æ˜¯cpuè¯»å–ä¼šä»¥ç¼“å­˜è¡Œä¸ºæœ€å°å•ä½ï¼Œå°†å…¶ç›¸é‚»çš„å˜é‡ä¸€èµ·è¯»å…¥ï¼‰ï¼Œè¢«è¯»å…¥cpuç¼“å­˜çš„å˜é‡ç›¸å½“äºæ˜¯å¯¹ä¸»å†…å­˜å˜é‡çš„ä¸€ä¸ªæ‹·è´ï¼Œä¹Ÿç›¸å½“äºå˜ç›¸çš„å°†åœ¨åŒä¸€ä¸ªç¼“å­˜è¡Œä¸­çš„å‡ ä¸ªå˜é‡åŠ äº†ä¸€æŠŠé”ï¼Œè¿™ä¸ªç¼“å­˜è¡Œä¸­ä»»ä½•ä¸€ä¸ªå˜é‡å‘ç”Ÿäº†å˜åŒ–ï¼Œå½“cup-2éœ€è¦è¯»å–è¿™ä¸ªç¼“å­˜è¡Œæ—¶ï¼Œå°±éœ€è¦å…ˆå°†cup-1ä¸­è¢«æ”¹å˜äº†çš„æ•´ä¸ªç¼“å­˜è¡Œæ›´æ–°å›ä¸»å­˜ï¼ˆå³ä½¿å…¶å®ƒå˜é‡æ²¡æœ‰æ›´æ”¹ï¼‰ï¼Œç„¶åcup-2æ‰èƒ½å¤Ÿè¯»å–ï¼Œè€Œcup-2å¯èƒ½éœ€è¦æ›´æ”¹è¿™ä¸ªç¼“å­˜è¡Œçš„å˜é‡ä¸cpu-1å·²ç»æ›´æ”¹çš„ç¼“å­˜è¡Œä¸­çš„å˜é‡æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥è¿™ç›¸å½“äºç»™å‡ ä¸ªæ¯«ä¸ç›¸å…³çš„å˜é‡åŠ äº†ä¸€æŠŠåŒæ­¥é”ï¼›&lt;/p&gt;
&lt;p&gt;ä¸ºäº†é˜²æ­¢ä¼ªå…±äº«ï¼Œä¸åŒjdkç‰ˆæœ¬å®ç°æ–¹å¼æ˜¯ä¸ä¸€æ ·çš„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨jdk1.7ä¹‹å‰ä¼š å°†éœ€è¦ç‹¬å ç¼“å­˜è¡Œçš„å˜é‡å‰åæ·»åŠ ä¸€ç»„longç±»å‹çš„å˜é‡ï¼Œä¾é è¿™äº›æ— æ„ä¹‰çš„æ•°ç»„çš„å¡«å……åšåˆ°ä¸€ä¸ªå˜é‡è‡ªå·±ç‹¬å ä¸€ä¸ªç¼“å­˜è¡Œï¼›&lt;/li&gt;
&lt;li&gt;åœ¨jdk1.7å› ä¸ºjvmä¼šå°†è¿™äº›æ²¡æœ‰ç”¨åˆ°çš„å˜é‡ä¼˜åŒ–æ‰ï¼Œæ‰€ä»¥é‡‡ç”¨ç»§æ‰¿ä¸€ä¸ªå£°æ˜äº†å¥½å¤šlongå˜é‡çš„ç±»çš„æ–¹å¼æ¥å®ç°ï¼›&lt;/li&gt;
&lt;li&gt;åœ¨jdk1.8ä¸­é€šè¿‡æ·»åŠ sun.misc.Contendedæ³¨è§£æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè‹¥è¦ä½¿è¯¥æ³¨è§£æœ‰æ•ˆå¿…é¡»åœ¨jvmä¸­æ·»åŠ ä»¥ä¸‹å‚æ•°ï¼š-XX:-RestrictContendedã€‚sun.misc.Contendedæ³¨è§£ä¼šåœ¨å˜é‡å‰é¢æ·»åŠ 128å­—èŠ‚çš„paddingå°†å½“å‰å˜é‡ä¸å…¶ä»–å˜é‡è¿›è¡Œéš”ç¦»&lt;/li&gt;
&lt;/ol&gt;
">Javaä¸­çš„é”</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://philosopherzb.github.io/post/java-xian-cheng-chi-xiang-jie/"" data-c="
          &lt;h2 id=&#34;çº¿ç¨‹æ± &#34;&gt;çº¿ç¨‹æ± &lt;/h2&gt;
&lt;h3 id=&#34;çº¿ç¨‹æ± çš„ä¼˜åŠ¿&#34;&gt;çº¿ç¨‹æ± çš„ä¼˜åŠ¿&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;é™ä½ç³»ç»Ÿèµ„æºæ¶ˆè€—ï¼šé€šè¿‡é‡ç”¨å·²å­˜åœ¨çš„çº¿ç¨‹ï¼Œé™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯æ‰€é€ æˆçš„èµ„æºæ¶ˆè€—ã€‚&lt;/li&gt;
&lt;li&gt;æä¾›ç³»ç»Ÿå“åº”é€Ÿåº¦ï¼šå½“ä»»åŠ¡æ¥ä¸´æ—¶ï¼Œç›´æ¥å¤ç”¨å·²å­˜åœ¨çš„çº¿ç¨‹è¿›è¡Œå·¥ä½œï¼Œè€Œæ— éœ€ç­‰å¾…çº¿ç¨‹çš„åˆ›å»ºã€‚&lt;/li&gt;
&lt;li&gt;æ–¹ä¾¿çº¿ç¨‹æ•°çš„ç®¡æ§ï¼šè¿‡å¤šçš„çº¿ç¨‹åˆ›å»ºï¼Œä¼šå¯¼è‡´æ€§èƒ½çš„æ€¥å‰§ä¸‹é™ï¼ˆçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ååˆ†è€—è´¹æ€§èƒ½ï¼‰ï¼Œç”šè‡³å‡ºç°OOMã€‚&lt;/li&gt;
&lt;li&gt;æä¾›æ›´åŠ å¼ºå¤§çš„åŠŸèƒ½ï¼Œå¦‚å»¶æ—¶å®šæ—¶çº¿ç¨‹æ± ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;çº¿ç¨‹æ± çš„ä¸»è¦å‚æ•°&#34;&gt;çº¿ç¨‹æ± çš„ä¸»è¦å‚æ•°&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;public ThreadPoolExecutor(int corePoolSize,
                          int maximumPoolSize,
                          long keepAliveTime,
                          TimeUnit unit,
                          BlockingQueue&amp;lt;Runnable&amp;gt; workQueue,
                          ThreadFactory threadFactory,
                          RejectedExecutionHandler handler)
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;corePoolSizeï¼šæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ ¸å¿ƒçº¿ç¨‹ä¸€ç›´å­˜æ´»åœ¨çº¿ç¨‹æ± ä¸­ï¼Œå³ä½¿å®ƒä»¬å¤„äºé—²ç½®çŠ¶æ€ï¼ˆå¯é€šè¿‡allowCoreThreadTimeOutè¿›è¡Œæ§åˆ¶ï¼‰ã€‚å½“å‘çº¿ç¨‹æ± æäº¤ä¸€ä¸ªä»»åŠ¡æ—¶ï¼Œè‹¥çº¿ç¨‹æ± å·²åˆ›å»ºçš„çº¿ç¨‹æ•°å°äºcorePoolSizeï¼Œå³ä¾¿æ­¤æ—¶å­˜åœ¨ç©ºé—²çº¿ç¨‹ï¼Œä¹Ÿä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œç›´åˆ°åˆ›å»ºçš„çº¿ç¨‹æ•°å¤§äºæˆ–ç­‰äºcorePoolSizeæ—¶æ‰è¿›è¡Œçº¿ç¨‹å¤ç”¨ï¼ˆå¯é€šè¿‡prestartCoreThread()æˆ–è€…prestartAllCoreThreads()æ¥æå‰å¯åŠ¨çº¿ç¨‹æ± ä¸­çš„åŸºæœ¬çº¿ç¨‹ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;maximumPoolSizeï¼šæœ€å¤§çº¿ç¨‹æ•°ï¼Œå½“é˜Ÿåˆ—æ»¡äº†ï¼Œä¸”å·²åˆ›å»ºçº¿ç¨‹æ•°å°äºmaximumPoolSizeæ—¶ï¼Œçº¿ç¨‹æ± ä¼šåˆ›å»ºæ–°çš„çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;keepAliveTimeï¼šçº¿ç¨‹é—²ç½®æ—¶é•¿ï¼Œè¶…è¿‡æ­¤æ—¶é•¿å°†ä¼šè¢«é”€æ¯ã€‚é»˜è®¤åªå¯¹éæ ¸å¿ƒçº¿ç¨‹ç”Ÿæ•ˆï¼Œåªæœ‰å½“ThreadPoolExecutorä¸­çš„allowCoreThreadTimeOutè®¾ç½®ä¸ºtrueæ—¶ï¼Œæ‰ä¼šå¯¹æ ¸å¿ƒçº¿ç¨‹ç”Ÿæ•ˆã€‚&lt;/li&gt;
&lt;li&gt;unitï¼šç”¨äºæŒ‡å®škeepAliveTimeå‚æ•°çš„æ—¶é—´å•ä½ã€‚&lt;/li&gt;
&lt;li&gt;workQueueï¼šå·¥ä½œé˜Ÿåˆ—ï¼Œç”¨äºä¿å­˜ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡çš„é˜»å¡é˜Ÿåˆ—ã€‚é€šè¿‡çº¿ç¨‹æ± çš„executeæ–¹æ³•æäº¤çš„Runnableå¯¹è±¡éƒ½ä¼šå­˜å‚¨åœ¨è¯¥é˜Ÿåˆ—ä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;ArrayBlockingQueueï¼šåŸºäºæ•°ç»„å®ç°çš„æœ‰ç•Œçš„é˜»å¡é˜Ÿåˆ—,è¯¥é˜Ÿåˆ—æŒ‰ç…§FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰åŸåˆ™å¯¹é˜Ÿåˆ—ä¸­çš„å…ƒç´ è¿›è¡Œæ’åºã€‚&lt;/li&gt;
&lt;li&gt;LinkedBlockingQueueï¼šåŸºäºé“¾è¡¨å®ç°çš„é˜»å¡é˜Ÿåˆ—ï¼Œè¯¥é˜Ÿåˆ—æŒ‰ç…§FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰åŸåˆ™å¯¹é˜Ÿåˆ—ä¸­çš„å…ƒç´ è¿›è¡Œæ’åºã€‚&lt;/li&gt;
&lt;li&gt;SynchronousQueueï¼šå†…éƒ¨æ²¡æœ‰ä»»ä½•å®¹é‡çš„é˜»å¡é˜Ÿåˆ—ã€‚åœ¨å®ƒå†…éƒ¨æ²¡æœ‰ä»»ä½•çš„ç¼“å­˜ç©ºé—´ã€‚å¯¹äºSynchronousQueueä¸­çš„æ•°æ®å…ƒç´ åªæœ‰å½“æˆ‘ä»¬è¯•ç€å–èµ°çš„æ—¶å€™æ‰å¯èƒ½å­˜åœ¨ã€‚&lt;/li&gt;
&lt;li&gt;PriorityBlockingQueueï¼šå…·æœ‰ä¼˜å…ˆçº§çš„æ— é™é˜»å¡é˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡å®ç°BlockingQueueæ¥å£æ¥è‡ªå®šä¹‰æ‰€éœ€è¦çš„é˜»å¡é˜Ÿåˆ—&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;threadFactoryï¼šçº¿ç¨‹å·¥å‚ï¼Œç”¨äºåˆ›å»ºæ–°çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;handlerï¼šæ‹’ç»ç­–ç•¥ï¼Œå½“çº¿ç¨‹æ± é¥±å’Œæ—¶ï¼ˆä»»åŠ¡é˜Ÿåˆ—ä»¥åŠæ´»åŠ¨çº¿ç¨‹æ•°éƒ½å·²è¾¾åˆ°æœ€å¤§å€¼ï¼‰ï¼Œæ­¤æ—¶ä¾¿ä¼šæ‰§è¡Œå¯¹åº”çš„æ‹’ç»ç­–ç•¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;CallerRunsPolicyï¼šä½¿ç”¨è°ƒç”¨è€…æ‰€åœ¨çº¿ç¨‹æ¥è¿è¡Œä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;AbortPolicyï¼šç›´æ¥æŠ›å‡ºRejectedExecutionExceptionå¼‚å¸¸ã€‚&lt;/li&gt;
&lt;li&gt;DiscardPolicyï¼šä¸¢å¼ƒæ‰è¯¥ä»»åŠ¡ï¼Œä¸è¿›è¡Œå¤„ç†&lt;/li&gt;
&lt;li&gt;DiscardOldestPolicyï¼šä¸¢å¼ƒé˜Ÿåˆ—é‡Œæœ€è¿‘çš„ä¸€ä¸ªä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œå½“å‰ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;çº¿ç¨‹æ± æµç¨‹å›¾&#34;&gt;çº¿ç¨‹æ± æµç¨‹å›¾&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;å¦‚æœåœ¨çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡æ²¡æœ‰è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°é‡ï¼Œè¿™æ—¶å€™å°±ä¼šå¯åŠ¨ä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼ˆç­‰äºæ ¸å¿ƒçº¿ç¨‹æ•°æ—¶ï¼Œä¼šå¤ç”¨çº¿ç¨‹æ± ä¸­å·²å­˜åœ¨çš„çº¿ç¨‹ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å·²ç»è¶…è¿‡æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œè¿™æ—¶å€™ä»»åŠ¡å°±ä¼šè¢«æ’å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­æ’é˜Ÿç­‰å¾…æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;ç”±äºä»»åŠ¡é˜Ÿåˆ—å·²æ»¡ï¼Œæ— æ³•å°†ä»»åŠ¡æ’å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚è¿™ä¸ªæ—¶å€™å¦‚æœçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡æ²¡æœ‰è¾¾åˆ°çº¿ç¨‹æ± æ‰€è®¾å®šçš„æœ€å¤§å€¼ï¼ˆmaximumPoolSizeï¼‰ï¼Œé‚£ä¹ˆè¿™æ—¶å€™å°±ä¼šç«‹å³å¯åŠ¨ä¸€ä¸ªéæ ¸å¿ƒçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœçº¿ç¨‹æ± ä¸­çš„æ•°é‡è¾¾åˆ°äº†æ‰€è§„å®šçš„æœ€å¤§å€¼ï¼ˆmaximumPoolSizeï¼‰ï¼Œé‚£ä¹ˆå°±ä¼šæ‹’ç»æ‰§è¡Œæ­¤ä»»åŠ¡ï¼Œè¿™æ—¶å€™å°±ä¼šè°ƒç”¨RejectedExecutionHandlerä¸­çš„rejectedExecutionæ–¹æ³•æ¥é€šçŸ¥è°ƒç”¨è€…ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230228001.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;å››ç§çº¿ç¨‹æ± ä¸€èˆ¬ä¸æ¨èä½¿ç”¨&#34;&gt;å››ç§çº¿ç¨‹æ± ï¼ˆä¸€èˆ¬ä¸æ¨èä½¿ç”¨ï¼‰&lt;/h3&gt;
&lt;p&gt;1ã€newCachedThreadPoolï¼šç”¨æ¥åˆ›å»ºä¸€ä¸ªå¯ä»¥æ— é™æ‰©å¤§çš„çº¿ç¨‹æ± ï¼Œé€‚ç”¨äºè´Ÿè½½è¾ƒè½»çš„åœºæ™¯ï¼Œæ‰§è¡ŒçŸ­æœŸå¼‚æ­¥ä»»åŠ¡ã€‚ï¼ˆå¯ä»¥ä½¿å¾—ä»»åŠ¡å¿«é€Ÿå¾—åˆ°æ‰§è¡Œï¼Œå› ä¸ºä»»åŠ¡æ—¶é—´æ‰§è¡ŒçŸ­ï¼Œå¯ä»¥å¾ˆå¿«ç»“æŸï¼Œä¹Ÿä¸ä¼šé€ æˆcpuè¿‡åº¦åˆ‡æ¢ï¼‰ï¼Œæ— ç•Œçº¿ç¨‹æ± ï¼Œå®¹æ˜“å‘ç”ŸOOMã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public static ExecutorService newCachedThreadPool() {
    return new ThreadPoolExecutor(0, Integer.MAX_VALUE,
                                  60L, TimeUnit.SECONDS,
                                  new SynchronousQueue&amp;lt;Runnable&amp;gt;());
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€newFixedThreadPoolï¼šåˆ›å»ºä¸€ä¸ªå›ºå®šå¤§å°çš„çº¿ç¨‹æ± ï¼Œå› ä¸ºé‡‡ç”¨æ— ç•Œçš„é˜»å¡é˜Ÿåˆ—ï¼Œæ‰€ä»¥å®é™…çº¿ç¨‹æ•°é‡æ°¸è¿œä¸ä¼šå˜åŒ–ï¼Œé€‚ç”¨äºè´Ÿè½½è¾ƒé‡çš„åœºæ™¯ï¼Œå¯¹å½“å‰çº¿ç¨‹æ•°é‡è¿›è¡Œé™åˆ¶ã€‚ï¼ˆä¿è¯çº¿ç¨‹æ•°å¯æ§ï¼Œä¸ä¼šé€ æˆçº¿ç¨‹è¿‡å¤šï¼Œå¯¼è‡´ç³»ç»Ÿè´Ÿè½½æ›´ä¸ºä¸¥é‡ï¼‰&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public static ExecutorService newFixedThreadPool(int nThreads) {
    return new ThreadPoolExecutor(nThreads, nThreads,
                                  0L, TimeUnit.MILLISECONDS,
                                  new LinkedBlockingQueue&amp;lt;Runnable&amp;gt;());
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€newSingleThreadExecutorï¼šåˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹çš„çº¿ç¨‹æ± ï¼Œé€‚ç”¨äºéœ€è¦ä¿è¯é¡ºåºæ‰§è¡Œå„ä¸ªä»»åŠ¡ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public static ExecutorService newSingleThreadExecutor() {
    return new FinalizableDelegatedExecutorService
        (new ThreadPoolExecutor(1, 1,
                                0L, TimeUnit.MILLISECONDS,
                                new LinkedBlockingQueue&amp;lt;Runnable&amp;gt;()));
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4ã€newScheduledThreadPoolï¼šé€‚ç”¨äºæ‰§è¡Œå»¶æ—¶æˆ–è€…å‘¨æœŸæ€§ä»»åŠ¡.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public static ScheduledExecutorService newScheduledThreadPool(int corePoolSize) {
    return new ScheduledThreadPoolExecutor(corePoolSize);
}
public ScheduledThreadPoolExecutor(int corePoolSize) {
    super(corePoolSize, Integer.MAX_VALUE, 0, NANOSECONDS,
          new DelayedWorkQueue());
}
//å®ä¾‹ï¼š
ScheduledExecutorService service = Executors.newScheduledThreadPool(4);
service.schedule(() -&amp;gt; System.out.println(Thread.currentThread().getName()+&amp;quot;å»¶è¿Ÿä¸‰ç§’æ‰§è¡Œ&amp;quot;), 3, TimeUnit.SECONDS);
service.scheduleAtFixedRate(() -&amp;gt; System.out.println(Thread.currentThread().getName()+&amp;quot;å»¶è¿Ÿä¸‰ç§’åæ¯éš”2ç§’æ‰§è¡Œ&amp;quot;), 3, 2, TimeUnit.SECONDS);

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;schedule(Runnable command, long delay, TimeUnit unit)ï¼šå»¶è¿Ÿä¸€å®šæ—¶é—´åæ‰§è¡ŒRunnableä»»åŠ¡ï¼›&lt;/p&gt;
&lt;p&gt;schedule(Callable callable, long delay, TimeUnit unit)ï¼šå»¶è¿Ÿä¸€å®šæ—¶é—´åæ‰§è¡ŒCallableä»»åŠ¡ï¼›&lt;/p&gt;
&lt;p&gt;scheduleAtFixedRate(Runnable command, long initialDelay, long period, TimeUnit unit)ï¼šå»¶è¿Ÿä¸€å®šæ—¶é—´åï¼Œä»¥é—´éš”periodæ—¶é—´çš„é¢‘ç‡å‘¨æœŸæ€§åœ°æ‰§è¡Œä»»åŠ¡(å›ºå®šé¢‘ç‡çš„å«ä¹‰å°±æ˜¯å¯èƒ½è®¾å®šçš„å›ºå®šæ—¶é—´ä¸è¶³ä»¥å®Œæˆçº¿ç¨‹ä»»åŠ¡ï¼Œä½†æ˜¯å®ƒä¸ç®¡ï¼Œè¾¾åˆ°è®¾å®šçš„å»¶è¿Ÿæ—¶é—´äº†å°±è¦æ‰§è¡Œä¸‹ä¸€æ¬¡äº†)ï¼›&lt;/p&gt;
&lt;p&gt;scheduleWithFixedDelay(Runnable command, long initialDelay, long delay,TimeUnit unit)ï¼šä¸scheduleAtFixedRate()æ–¹æ³•å¾ˆç±»ä¼¼ï¼Œä½†æ˜¯ä¸åŒçš„æ˜¯scheduleWithFixedDelay()æ–¹æ³•çš„å‘¨æœŸæ—¶é—´é—´éš”æ˜¯ä»¥ä¸Šä¸€ä¸ªä»»åŠ¡æ‰§è¡Œç»“æŸåˆ°ä¸‹ä¸€ä¸ªä»»åŠ¡å¼€å§‹æ‰§è¡Œçš„é—´éš”ï¼Œè€ŒscheduleAtFixedRate()æ–¹æ³•çš„å‘¨æœŸæ—¶é—´é—´éš”æ˜¯ä»¥ä¸Šä¸€ä¸ªä»»åŠ¡å¼€å§‹æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªä»»åŠ¡å¼€å§‹æ‰§è¡Œçš„é—´éš”ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸€äº›ä»»åŠ¡ç³»åˆ—çš„è§¦å‘æ—¶é—´éƒ½æ˜¯å¯é¢„çŸ¥çš„.&lt;/p&gt;
&lt;h3 id=&#34;çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é…ç½®&#34;&gt;çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é…ç½®&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;CPUå¯†é›†å‹ä»»åŠ¡ï¼šçº¿ç¨‹æ± ä¸­çº¿ç¨‹ä¸ªæ•°åº”å°½é‡å°‘ï¼Œå¦‚é…ç½®N+1ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± ï¼›&lt;/li&gt;
&lt;li&gt;IOå¯†é›†å‹ä»»åŠ¡ï¼šç”±äºIOæ“ä½œé€Ÿåº¦è¿œä½äºCPUé€Ÿåº¦ï¼Œé‚£ä¹ˆåœ¨è¿è¡Œè¿™ç±»ä»»åŠ¡æ—¶ï¼ŒCPUç»å¤§å¤šæ•° æ—¶é—´å¤„äºç©ºé—²çŠ¶æ€ï¼Œé‚£ä¹ˆçº¿ç¨‹æ± å¯ä»¥é…ç½®å°½é‡å¤šäº›çš„çº¿ç¨‹ï¼Œä»¥æé«˜CPUåˆ©ç”¨ç‡ï¼Œå¦‚2*Nï¼›&lt;/li&gt;
&lt;li&gt;æ··åˆå‹ä»»åŠ¡ï¼šå¯ä»¥æ‹†åˆ†ä¸ºCPUå¯†é›†å‹ä»»åŠ¡å’ŒIOå¯†é›†å‹ä»»åŠ¡ï¼Œå½“è¿™ä¸¤ç±»ä»»åŠ¡æ‰§è¡Œæ—¶é—´ç›¸å·®æ— å‡ æ—¶ï¼Œé€šè¿‡æ‹†åˆ†å†æ‰§è¡Œçš„ååç‡é«˜äºä¸²è¡Œæ‰§è¡Œçš„ååç‡ï¼Œä½†è‹¥è¿™ä¸¤ç±»ä»»åŠ¡æ‰§è¡Œæ—¶é—´æœ‰æ•°æ®çº§çš„å·®è·ï¼Œé‚£ä¹ˆæ²¡æœ‰æ‹†åˆ†çš„æ„ä¹‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
">Javaçº¿ç¨‹æ± è¯¦è§£</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://philosopherzb.github.io/post/java-duo-xian-cheng-ji-chu/"" data-c="
          &lt;h2 id=&#34;å¤šçº¿ç¨‹åŸºç¡€&#34;&gt;å¤šçº¿ç¨‹åŸºç¡€&lt;/h2&gt;
&lt;h3 id=&#34;javaå¤šçº¿ç¨‹å¹¶å‘åº“&#34;&gt;javaå¤šçº¿ç¨‹å¹¶å‘åº“&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230227001.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;è¿›ç¨‹ä¸çº¿ç¨‹&#34;&gt;è¿›ç¨‹ä¸çº¿ç¨‹&lt;/h3&gt;
&lt;p&gt;è¿›ç¨‹ï¼šæ˜¯ç¨‹åºè¿è¡Œä»¥åŠèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œä¸€ä¸ªç¨‹åºè‡³å°‘æœ‰ä¸€ä¸ªè¿›ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;çº¿ç¨‹ï¼šæ˜¯CPUè°ƒåº¦å’Œåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œä¸€ä¸ªè¿›ç¨‹è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚åŒä¸€ä¸ªè¿›ç¨‹ä¸­çš„çº¿ç¨‹å…±äº«å…¶èµ„æºï¼ˆå‡å°‘åˆ‡æ¢ï¼Œå¯æé«˜æ•ˆç‡ï¼‰ï¼Œä¸”å¯ä»¥å¹¶å‘æ‰§è¡Œï¼ˆå¹¶å‘ï¼šåŒä¸€æ—¶é—´é—´éš”å¯ä»¥åšå¤šä»¶äº‹ï¼›å¹¶è¡Œï¼šåŒä¸€æ—¶åˆ»å¯ä»¥åšå¤šä»¶äº‹ï¼ˆå¤šæ ¸ï¼‰ï¼‰ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://raw.githubusercontent.com/philosopherZB/blog-images/master/blogImg/clipboard20230227002.png&#34; alt=&#34;img&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;çº¿ç¨‹çš„ä¸Šæ–‡åˆ‡æ¢&#34;&gt;çº¿ç¨‹çš„ä¸Šæ–‡åˆ‡æ¢&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ªCPUæ ¸åœ¨ä»»æ„æ—¶åˆ»åªèƒ½æ‰§è¡Œä¸€ä¸ªçº¿ç¨‹ï¼Œå¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹ï¼ˆè¶…è¿‡CPUæ ¸æ•°ï¼‰å­˜åœ¨ï¼ŒCPUå°†ä¼šé‡‡ç”¨æ—¶é—´ç‰‡è½®è½¬çš„æ–¹å¼è¿›è¡Œçº¿ç¨‹åˆ‡æ¢ï¼Œå³ç»™æ¯ä¸€ä¸ªçº¿ç¨‹åˆ†é…ä¸€ä¸ªæ—¶é—´ç‰‡ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹çš„æ—¶é—´ç‰‡ç”¨å®Œçš„æ—¶å€™ä¾¿ä¼šå¤„äºå°±ç»ªçŠ¶æ€ï¼Œå¹¶è®©å‡ºCPUç»™å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œè¿™å°±æ˜¯ä¸€æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚&lt;/li&gt;
&lt;li&gt;ä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶æ˜¯é€šè¿‡è¿è¡Œæ—¶æ•°æ®åŒºä¸­çš„ç¨‹åºè®¡æ•°å™¨æ¥å­˜å‚¨å„ä¸ªçº¿ç¨‹çš„è¿è¡ŒçŠ¶æ€çš„ï¼Œä»¥ä¾¿äºä¸‹æ¬¡è¿è¡Œçº¿ç¨‹æ—¶å¯ä»¥æ¥ç€ä¸Šæ¬¡æŒ‡ä»¤ç»§ç»­è¿è¡Œï¼ˆæ¯”å¦‚çº¿ç¨‹Aåšäº†ä¸€æ¬¡è®¡ç®—å‡†å¤‡è¿”å›æ•°æ®æ—¶ï¼Œåˆ‡æ¢åˆ°äº†çº¿ç¨‹Bï¼Œç„¶ååˆåˆ‡å›çº¿ç¨‹Aï¼Œæ˜¯ç›´æ¥è¿”å›æ•°æ®ï¼Œè€Œä¸æ˜¯å†å»è®¡ç®—ä¸€éï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç¨‹åºè®¡æ•°å™¨æŒ‡çš„æ˜¯JVMä¸­çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œå®ƒå¯ä»¥çœ‹ä½œæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œå­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ï¼Œé€šè¿‡å®ƒï¼ŒJavaå¯ä»¥çŸ¥é“æ¯ä¸ªçº¿ç¨‹æ‰§è¡Œåˆ°äº†å“ªä¸€æ­¥æŒ‡ä»¤ï¼ˆç”±æ­¤å¯ä»¥çœ‹å‡ºç¨‹åºè®¡æ•°å™¨æ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¸€èˆ¬è€Œè¨€ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢æ˜¯æ¯”è¾ƒè€—è´¹CPUæ—¶é—´çš„ä¸€ç§æ“ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;çº¿ç¨‹çš„å‡ ç§çŠ¶æ€&#34;&gt;çº¿ç¨‹çš„å‡ ç§çŠ¶æ€&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åˆ›å»ºï¼šæŒ‡çš„æ˜¯ç”Ÿæˆçº¿ç¨‹å¯¹è±¡ï¼Œæ­¤æ—¶å¹¶æ²¡æœ‰è°ƒç”¨startæ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;å°±ç»ªï¼šè°ƒç”¨çº¿ç¨‹çš„startæ–¹æ³•åï¼Œçº¿ç¨‹ä¾¿è¿›å…¥äº†å°±ç»ªçŠ¶æ€ï¼Œæ­¤æ—¶ç­‰å¾…ç³»ç»Ÿè°ƒåº¦ã€‚&lt;/li&gt;
&lt;li&gt;è¿è¡Œï¼šé€šè¿‡ç³»ç»Ÿè°ƒåº¦ï¼Œå¼€å§‹è¿è¡Œçº¿ç¨‹ä¸­çš„runå‡½æ•°ã€‚&lt;/li&gt;
&lt;li&gt;ç­‰å¾…ï¼šè°ƒç”¨äº†Object.wait()ä¼šè¿›å…¥ç­‰å¾…é˜Ÿåˆ—ã€‚ä¸€èˆ¬éœ€è¦ç­‰å¾…å…¶ä»–çº¿ç¨‹åšå‡ºä¸€äº›ç‰¹å®šçš„é€šçŸ¥æˆ–è€…ä¸­æ–­ã€‚&lt;/li&gt;
&lt;li&gt;è¶…æ—¶ç­‰å¾…ï¼šè¯¥çŠ¶æ€ä¸ç­‰å¾…çŠ¶æ€æœ‰ä¸€ç‚¹åŒºåˆ«å°±æ˜¯å®ƒä¼šè‡ªåŠ¨è¿”å›ï¼Œæ¯”å¦‚è°ƒç”¨Threa.sleep(long)ï¼Œåœ¨è¶…æ—¶ä¹‹åï¼Œä¼šè‡ªåŠ¨è¿”å›è¿›å…¥å°±ç»ªçŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;é˜»å¡ï¼šæŒ‡çš„æ˜¯å»è·å–é”æ—¶(ç­‰å¾…è¿›å…¥synchronizedæ–¹æ³•æˆ–å—)ï¼Œå‘ç°åŒæ­¥é”è¢«å ç”¨äº†ï¼Œè¿™æ—¶çº¿ç¨‹ä¼šè¢«æ”¾å…¥é”æ± ï¼Œç­‰å¾…è·å–é”ã€‚&lt;/li&gt;
&lt;li&gt;æ­»äº¡ï¼šè¿è¡Œå®Œrunæ–¹æ³•ï¼Œmainæ–¹æ³•ï¼ˆmainæ–¹æ³•æŒ‡çš„æ˜¯ä¸»çº¿ç¨‹ï¼‰ä¹‹åæ­£å¸¸é€€å‡ºï¼Œä¹Ÿæœ‰å¯èƒ½å‡ºç°å¼‚å¸¸å¯¼è‡´æ­»äº¡ï¼›æ­»äº¡çš„çº¿ç¨‹ä¸èƒ½é‡æ–°å¯ç”¨ï¼Œå¦åˆ™æŠ¥é”™ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;åˆ›å»ºçº¿ç¨‹çš„å‡ ç§æ–¹å¼&#34;&gt;åˆ›å»ºçº¿ç¨‹çš„å‡ ç§æ–¹å¼&lt;/h2&gt;
&lt;h3 id=&#34;ç»§æ‰¿thread&#34;&gt;ç»§æ‰¿Thread&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;public class ThreadTest {
    public static void main(String[] args){
        new TestThread().start();
    }
}

class TestThread extends Thread{
    @Override
    public void run(){
        System.out.println(&amp;quot;Test Thread&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å®ç°runnable&#34;&gt;å®ç°Runnable&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;public class ThreadTest {
    public static void main(String[] args){
        new Thread(new TestRunnable()).start();
    }
}

class TestRunnable implements Runnable{
    @Override
    public void run() {
        System.out.println(&amp;quot;Test Runnable&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å®ç°callable&#34;&gt;å®ç°Callable&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;public class ThreadTest {
    public static void main(String[] args){
        FutureTask&amp;lt;Integer&amp;gt; task = new FutureTask(new TestCallable());
        new Thread(task).start();
        try {
            System.out.println(task.get());//getæ–¹æ³•ä¼šå¾—åˆ°callæ‰§è¡Œå®Œä¹‹åçš„å€¼
        } catch (InterruptedException e) {
            e.printStackTrace();
        } catch (ExecutionException e) {
            e.printStackTrace();
        }
    }
}

class TestCallable implements Callable&amp;lt;Integer&amp;gt; {
    @Override
    public Integer call() throws Exception {
        int num = 0;
        while(num &amp;lt; 5){
            num++;
        }
        return num;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;çº¿ç¨‹å®‰å…¨æ€§&#34;&gt;çº¿ç¨‹å®‰å…¨æ€§&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;åŸå­æ€§ï¼šåŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹å¯¹æ•°æ®è¿›è¡Œæ“ä½œï¼ˆatomicå¼€å¤´çš„åŸå­ç±»,synchronizedï¼ŒLockï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¯è§æ€§ï¼šä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œå¯ä»¥åŠæ—¶åœ°è¢«å…¶ä»–çº¿ç¨‹è§‚å¯Ÿåˆ°ï¼Œï¼ˆsynchronized,volatileï¼ŒLockï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æœ‰åºæ€§ï¼šæŒ‡çš„æ˜¯å¯ä»¥è§‚å¯Ÿåˆ°å…¶ä»–çº¿ç¨‹çš„æŒ‡ä»¤æ‰§è¡Œé¡ºåºï¼Œç”±äºæŒ‡ä»¤é‡æ’ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ˜¯æ— åºçš„ï¼ˆhappens-beforeåŸåˆ™ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;çº¿ç¨‹æ­»é”&#34;&gt;çº¿ç¨‹æ­»é”&lt;/h3&gt;
&lt;h4 id=&#34;æ­»é”&#34;&gt;æ­»é”&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;æŒ‡çš„æ˜¯å¤šä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé™·å…¥ç¯è·¯é˜»å¡çš„ä¸€ç§ç°è±¡ã€‚&lt;/li&gt;
&lt;li&gt;ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼ˆè¿è¡Œä¹‹åï¼Œä¸¤ä¸ªçº¿ç¨‹é™·å…¥æ­»é”ä¸­ï¼Œå¦‚æœæ²¡æœ‰å¤–åŠ›ä¸­æ–­ï¼Œå°†ä¼šä¸€ç›´é”å®šï¼‰ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;public class ThreadTest {
    //å…±äº«èµ„æºA
    private static final Object A = new Object();
    //å…±äº«èµ„æºB
    private static final Object B = new Object();

    public static void main(String[] args){
        new Thread(() -&amp;gt; {
            synchronized (A){
                System.out.println(Thread.currentThread().getName() + &amp;quot;ï¼šå¾—åˆ°èµ„æº---A&amp;quot;);
                try {
                    Thread.sleep(1000);//æ­¤å¤„ä¼‘çœ æ˜¯ä¸ºäº†è®©å…¶ä»–çº¿ç¨‹è·å¾—æ‰§è¡Œæœºä¼š
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                System.out.println(Thread.currentThread().getName() + &amp;quot;ï¼šå»è·å–èµ„æº---B&amp;quot;);
                synchronized (B){
                    System.out.println(Thread.currentThread().getName() + &amp;quot;ï¼šå¾—åˆ°èµ„æº---B&amp;quot;);
                }
            }
        },&amp;quot;Thread-01&amp;quot;).start();

        new Thread(() -&amp;gt; {
            synchronized (B){
                System.out.println(Thread.currentThread().getName() + &amp;quot;ï¼šå¾—åˆ°èµ„æº---B&amp;quot;);
                try {
                    Thread.sleep(1000);//æ­¤å¤„ä¼‘çœ æ˜¯ä¸ºäº†è®©å…¶ä»–çº¿ç¨‹è·å¾—æ‰§è¡Œæœºä¼š
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                System.out.println(Thread.currentThread().getName() + &amp;quot;ï¼šå»è·å–èµ„æº---A&amp;quot;);
                synchronized (A){
                    System.out.println(Thread.currentThread().getName() + &amp;quot;ï¼šå¾—åˆ°èµ„æº---A&amp;quot;);
                }
            }
        },&amp;quot;Thread-02&amp;quot;).start();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;æ­»é”å››ä¸ªå¿…è¦æ¡ä»¶ä»¥åŠå¦‚ä½•é¿å…æ­»é”&#34;&gt;æ­»é”å››ä¸ªå¿…è¦æ¡ä»¶ä»¥åŠå¦‚ä½•é¿å…æ­»é”&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;äº’æ–¥æ¡ä»¶ï¼šä¸€ä¸ªèµ„æºåœ¨ä»»æ„æ—¶åˆ»åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹å ç”¨ï¼Œå¦‚æœæœ‰å…¶ä»–çº¿ç¨‹è¯·æ±‚è¯¥èµ„æºï¼Œéœ€è¦ç­‰å¾…åŸçº¿ç¨‹é‡Šæ”¾èµ„æºï¼ˆæ­¤æ¡ä»¶ä¸èƒ½è¢«ç ´åï¼Œå› ä¸ºé”æœ¬èº«å°±æ˜¯ä¸ºäº†äº’æ–¥è®¿é—®ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è¯·æ±‚å’Œä¿æŒæ¡ä»¶ï¼šä¸€ä¸ªçº¿ç¨‹å·²ç»è·å–äº†ä¸€éƒ¨åˆ†èµ„æºï¼Œåˆå»è¯·æ±‚å…¶ä»–èµ„æºï¼Œå¦‚æœå…¶ä»–èµ„æºæ­£è¢«å ç”¨ï¼ŒåŸçº¿ç¨‹é™·å…¥é˜»å¡ï¼Œä¸”ä¸ä¼šé‡Šæ”¾è‡ªå·±å ç”¨çš„èµ„æºï¼ˆä¸€æ¬¡æ€§ç”³è¯·æ‰€æœ‰èµ„æºï¼›æˆ–è€…é˜»å¡æ—¶ï¼Œé‡Šæ”¾è‡ªå·±å ç”¨çš„èµ„æºï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¸å¯å‰¥å¤ºæ¡ä»¶ï¼šä¸€ä¸ªçº¿ç¨‹å·²ç»è·å¾—çš„èµ„æºï¼Œåœ¨è‡ªå·±æœªä½¿ç”¨å®Œä¹‹å‰ä¸èƒ½è¢«å…¶ä»–çº¿ç¨‹å‰¥å¤ºï¼Œåªèƒ½è‡ªå·±ä½¿ç”¨ç»“æŸåé‡Šæ”¾ï¼ˆå¦‚æœå»è·å–æ­£åœ¨è¢«å…¶ä»–çº¿ç¨‹ä½¿ç”¨çš„èµ„æºè€Œé˜»å¡æ—¶ï¼Œå¯ä»¥é‡Šæ”¾è‡ªå·±å ç”¨çš„èµ„æºï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç¯è·¯ç­‰å¾…æ¡ä»¶ï¼šå¤šä¸ªè¿›ç¨‹ä¹‹é—´å½¢æˆä¸€ç§å¤´å°¾ç›¸æ¥çš„å¾ªç¯ç­‰å¾…èµ„æºå…³ç³»ï¼ˆæŒ‰ä¸€å®šçš„é¡ºåºæ¥è·å–èµ„æºï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é’ˆå¯¹ä¸Šè¿°ä¾‹å­è€Œè¨€ï¼Œå¯ä»¥è®©ç°çº¿ç¨‹1å…ˆè·å–èµ„æºABï¼Œæ‰§è¡Œå®Œä¹‹åï¼Œå†è®©çº¿ç¨‹2è·å–èµ„æºABï¼Œæ”¹åŠ¨å¦‚ä¸‹ï¼ˆæ‰§è¡Œé¡ºåºä¸ºï¼šçº¿ç¨‹1å…ˆè·å–èµ„æºAï¼Œæ¥ç€é‡Šæ”¾CPUï¼Œçº¿ç¨‹2æ‰§è¡Œå‡†å¤‡å»è·å–èµ„æºAï¼Œå‘ç°èµ„æºAå·²è¢«å ç”¨ï¼Œæ­¤æ—¶çº¿ç¨‹2é˜»å¡ï¼Œç„¶åä¸€ç§’ä¹‹åé‡Šæ”¾CPUï¼Œçº¿ç¨‹1æ¥ç€æ‰§è¡Œï¼Œå»è·å–èµ„æºBï¼Œæ­£å¸¸è·å–ï¼Œæ‰§è¡Œå®Œæ¯•ï¼Œé‡Šæ”¾CPUï¼›çº¿ç¨‹2å¼€å§‹è·å–èµ„æºAï¼Œç”±äºçº¿ç¨‹1å·²ç»æ‰§è¡Œå®Œæ¯•é‡Šæ”¾äº†é”ï¼Œæ‰€ä»¥çº¿ç¨‹2æ­£å¸¸è·å–èµ„æºAï¼Œæ¥ç€ä¼‘çœ ä¸€ç§’é‡Šæ”¾CPUï¼Œç„¶ååˆå»è·å–èµ„æºBï¼ŒåŒæ ·æ­£å¸¸è·å–ï¼Œæ‰§è¡Œå®Œæ¯•ï¼‰ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;public class ThreadTest {
    //å…±äº«èµ„æºA
    private static final Object A = new Object();
    //å…±äº«èµ„æºB
    private static final Object B = new Object();

    public static void main(String[] args){
        new Thread(() -&amp;gt; {
            synchronized (A){
                System.out.println(Thread.currentThread().getName() + &amp;quot;ï¼šå¾—åˆ°èµ„æº---A&amp;quot;);
                try {
                    Thread.sleep(1000);//æ­¤å¤„ä¼‘çœ æ˜¯ä¸ºäº†è®©å…¶ä»–çº¿ç¨‹è·å¾—æ‰§è¡Œæœºä¼š
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                System.out.println(Thread.currentThread().getName() + &amp;quot;ï¼šå»è·å–èµ„æº---B&amp;quot;);
                synchronized (B){
                    System.out.println(Thread.currentThread().getName() + &amp;quot;ï¼šå¾—åˆ°èµ„æº---B&amp;quot;);
                }
            }
        },&amp;quot;Thread-01&amp;quot;).start();

        new Thread(() -&amp;gt; {
            //çº¿ç¨‹2å»è·å–Aæ—¶è¢«é˜»å¡
            synchronized (A){
                System.out.println(Thread.currentThread().getName() + &amp;quot;ï¼šå¾—åˆ°èµ„æº---A&amp;quot;);
                try {
                    Thread.sleep(1000);//æ­¤å¤„ä¼‘çœ æ˜¯ä¸ºäº†è®©å…¶ä»–çº¿ç¨‹è·å¾—æ‰§è¡Œæœºä¼š
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                System.out.println(Thread.currentThread().getName() + &amp;quot;ï¼šå»è·å–èµ„æº---B&amp;quot;);
                synchronized (B){
                    System.out.println(Thread.currentThread().getName() + &amp;quot;ï¼šå¾—åˆ°èµ„æº---B&amp;quot;);
                }
            }
        },&amp;quot;Thread-02&amp;quot;).start();
    }
}
&lt;/code&gt;&lt;/pre&gt;
">Javaå¤šçº¿ç¨‹åŸºç¡€</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://philosopherzb.github.io/post/java-ji-chu-zhi-shi/"" data-c="
          &lt;h2 id=&#34;é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§&#34;&gt;é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§&lt;/h2&gt;
&lt;h3 id=&#34;å°è£…&#34;&gt;å°è£…&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å°†ç°å®ä¸­çš„å®¢è§‚äº‹ç‰©å°è£…æˆæŠ½è±¡çš„ç±»ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹ä¸€ä¸ªç±»ä¸­çš„å˜é‡ï¼Œæ–¹æ³•è¿›è¡Œè®¿é—®ç¬¦ä¿®é¥°ï¼Œä»¥è¾¾åˆ°æœ‰äº›å˜é‡ï¼Œæ–¹æ³•å¯¹å¤–å¼€æ”¾ï¼Œæœ‰äº›å˜é‡ï¼Œæ–¹æ³•éšè—ã€‚&lt;/li&gt;
&lt;li&gt;é’ˆå¯¹ç¬¬2ç‚¹å¯¹åº”çš„è®¿é—®ä¿®é¥°ç¬¦æœ‰(èŒƒå›´ä»å¤§åˆ°å°)ï¼špublic &amp;gt; protected &amp;gt; default &amp;gt; privateã€‚&lt;/li&gt;
&lt;li&gt;ç”±äºå°è£…éšè—äº†å…·ä½“å®ç°ï¼Œä»…æä¾›æ¥å£ä¾›å¤–éƒ¨è°ƒç”¨ï¼Œæ‰€ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥æé«˜å®‰å…¨æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ç»§æ‰¿&#34;&gt;ç»§æ‰¿&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¯ä»¥å®ç°å·²å­˜åœ¨çš„ç±»çš„å˜é‡ï¼Œæ–¹æ³•ï¼ˆéprivateï¼‰ï¼Œå¹¶å¯ä»¥æ‰©å±•å•å±äºè‡ªæˆ‘çš„å˜é‡åŠæ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;ç»§æ‰¿åœ¨Javaä¸­ä¸ºå•ç»§æ‰¿ï¼Œå³ä¸€ä¸ªå­ç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ï¼ˆå¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡ç»§æ‰¿åˆ›å»ºçš„ç±»ç§°ä¸ºâ€œå­ç±»â€ï¼Œâ€œæ´¾ç”Ÿç±»â€ã€‚&lt;/li&gt;
&lt;li&gt;è¢«ç»§æ‰¿çš„ç±»ç§°ä¸ºâ€œçˆ¶ç±»â€ï¼Œâ€œåŸºç±»â€ï¼Œâ€œè¶…ç±»â€ã€‚&lt;/li&gt;
&lt;li&gt;ç»§æ‰¿çš„å…³ç³»æ˜¯is-aï¼Œæ¯”å¦‚è¯´è€å¸ˆæ˜¯äººï¼Œç‹®å­æ˜¯åŠ¨ç‰©ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;ç»§æ‰¿å¯ä»¥é™ä½ä»£ç çš„é‡å¤æ€§ï¼Œæ–¹ä¾¿åç»­å¯¹å…¬å…±è¡Œä¸ºçš„ç»´æŠ¤ï¼Œä¸è¿‡åŒæ—¶ä¹Ÿå¢åŠ äº†ä»£ç çš„è€¦åˆåº¦ã€‚&lt;/li&gt;
&lt;li&gt;å­ç±»ä¸ç»§æ‰¿çˆ¶ç±»çš„æ„é€ å™¨ï¼Œè€Œæ˜¯æ˜¾ç¤ºæˆ–éšå¼çš„è°ƒç”¨ï¼ˆå¦‚æœçˆ¶ç±»ä¸­å­˜åœ¨ä¸å¸¦å‚æ„é€ å™¨ï¼Œåˆ™å­ç±»éšå¼è°ƒç”¨è¯¥æ„é€ å™¨ï¼›å¦åˆ™å¦‚æœçˆ¶ç±»ä¸­ä»…å­˜åœ¨å¸¦å‚æ„é€ å™¨ï¼Œåˆ™å­ç±»éœ€è¦é€šè¿‡superæ¥æ˜¾ç¤ºè°ƒç”¨çˆ¶ç±»å¸¦å‚æ„é€ å™¨ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å¤šæ€&#34;&gt;å¤šæ€&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹åŒä¸€ä¸ªè¡Œä¸ºä½“ç°å‡ºä¸åŒçš„è¡¨ç°å½¢å¼ï¼Œæ¯”å¦‚åƒï¼Œå¯ä»¥åƒé¥­ï¼Œåƒé›¶é£Ÿç­‰ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨Javaä¸­ä½“ç°ä¸ºå¯¹æ–¹æ³•çš„é‡å†™ä»¥åŠé‡è½½ï¼Œå³ä¼ å…¥å‚æ•°æ¥å†³å®šåšå“ªä¸€ç§å…·ä½“çš„åŠ¨ä½œï¼ˆé‡è½½ï¼‰ä¸åŒç±»ä¹‹é—´åŒä¸€æ–¹æ³•ä¸åŒè¡¨ç°ï¼ˆé‡å†™ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é‡å†™ä¸€èˆ¬ä¸ºçˆ¶å­ç±»ä¹‹é—´å¯¹æ–¹æ³•çš„ä¸åŒæ“ä½œï¼Œé‡è½½ä¸€èˆ¬ä¸ºåŒä¸€ä¸ªç±»ä¸­å¯¹æ–¹æ³•çš„ä¸åŒæ“ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;åŸºæœ¬æ•°æ®ç±»å‹å››ä¸ªæ•´æ•°ä¸¤ä¸ªæµ®ç‚¹ä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå¸ƒå°”&#34;&gt;åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆå››ä¸ªæ•´æ•°ï¼Œä¸¤ä¸ªæµ®ç‚¹ï¼Œä¸€ä¸ªå­—ç¬¦ï¼Œä¸€ä¸ªå¸ƒå°”ï¼‰&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;byteï¼Œå 8ä½ï¼Œ1å­—èŠ‚ï¼Œé»˜è®¤å€¼ï¼š0ï¼ŒåŒ…è£…ç±»ï¼šjava.lang.Byte&lt;/li&gt;
&lt;li&gt;shortï¼Œå 16ä½ï¼Œ2å­—èŠ‚ï¼Œé»˜è®¤å€¼ï¼š0ï¼ŒåŒ…è£…ç±»ï¼šjava.lang.Short&lt;/li&gt;
&lt;li&gt;intï¼Œå 32ä½ï¼Œ4å­—èŠ‚ï¼Œé»˜è®¤å€¼ï¼š0ï¼ŒåŒ…è£…ç±»ï¼šjava.lang.Integer&lt;/li&gt;
&lt;li&gt;longï¼Œå 64ä½ï¼Œ8å­—èŠ‚ï¼Œé»˜è®¤å€¼ï¼š0Lï¼ŒåŒ…è£…ç±»ï¼šjava.lang.Long&lt;/li&gt;
&lt;li&gt;floatï¼Œå 32ä½ï¼Œ4å­—èŠ‚ï¼Œé»˜è®¤å€¼ï¼š0.0fï¼ŒåŒ…è£…ç±»ï¼šjava.lang.Float&lt;/li&gt;
&lt;li&gt;doubleï¼Œå 64ä½ï¼Œ8å­—èŠ‚ï¼Œé»˜è®¤å€¼ï¼š0.fdï¼ŒåŒ…è£…ç±»ï¼šjava.lang.Double&lt;/li&gt;
&lt;li&gt;charï¼Œå¯ä»¥å­˜å‚¨ä»»ä½•å­—ç¬¦ï¼ŒåŒ…è£…ç±»ï¼šjava.lang.Character&lt;/li&gt;
&lt;li&gt;booleanï¼Œé»˜è®¤å€¼ï¼šfalseï¼ŒåŒ…è£…ç±»ï¼šjava.lang.Boolean&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;é¢å‘å¯¹è±¡çš„å…­å¤§åŸºæœ¬åŸå†Œ&#34;&gt;é¢å‘å¯¹è±¡çš„å…­å¤§åŸºæœ¬åŸå†Œ&lt;/h2&gt;
&lt;h3 id=&#34;å•ä¸€èŒè´£åŸåˆ™single-responsibility-priciple&#34;&gt;å•ä¸€èŒè´£åŸåˆ™ï¼ˆSingle Responsibility Pricipleï¼‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºä¸€ä¸ªç±»è€Œè¨€ï¼Œåº”è¯¥åªæœ‰ä¸€ä¸ªå¼•èµ·ä»–å˜åŒ–çš„åŸå› ã€‚&lt;/li&gt;
&lt;li&gt;æ¯”å¦‚ï¼Œä¸è¦å°†teacher,doctoréƒ½æ”¾åœ¨ä¸€ä¸ªpersonç±»ä¸­ï¼Œè€Œæ˜¯å°†å…¶æ‹†æˆteacherç±»ï¼Œdoctorç±»ã€‚&lt;/li&gt;
&lt;li&gt;èƒ½å¤Ÿä¸€å®šç¨‹åº¦ä¸Šé™ä½è€¦åˆåº¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å¼€é—­åŸåˆ™open-close-priciple&#34;&gt;å¼€é—­åŸåˆ™ï¼ˆOpen Close Pricipleï¼‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºæ‰©å±•æ˜¯å¼€æ”¾çš„ï¼Œå¯¹äºä¿®æ”¹æ˜¯å…³é—­çš„ã€‚&lt;/li&gt;
&lt;li&gt;ä¸€èˆ¬æ¥è¯´å°±æ˜¯ä¸è¦ä¿®æ”¹ä¹‹å‰çš„ä»£ç ï¼Œå¯ä»¥é€‰æ‹©ç»§æ‰¿æˆ–è€…å®ç°æ¥å£æ¥æ‰©å±•å¯¹åº”çš„åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;é‡Œå¼æ›¿æ¢åŸåˆ™liskov-substitution-priciple&#34;&gt;é‡Œå¼æ›¿æ¢åŸåˆ™ï¼ˆLiskov Substitution Pricipleï¼‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ‰€æœ‰å¼•ç”¨çˆ¶ç±»çš„åœ°æ–¹éƒ½å¯ä»¥é€æ˜çš„ä½¿ç”¨å…¶å­ç±»å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;å³çˆ¶ç±»å‡ºç°çš„åœ°æ–¹ï¼ŒæŠŠçˆ¶ç±»æ¢æˆå­ç±»ä¸ä¼šå‡ºç°å¼‚å¸¸æˆ–é”™è¯¯ï¼›åä¹‹ï¼Œå­ç±»å‡ºç°çš„åœ°æ–¹ï¼ŒæŠŠå­ç±»æ¢æˆçˆ¶ç±»å¯èƒ½ä¼šå‡ºç°å¼‚å¸¸æˆ–é”™è¯¯ã€‚&lt;/li&gt;
&lt;li&gt;æ¯”å¦‚,personç±»å…·æœ‰eatåŠŸèƒ½ï¼Œé‚£ä¹ˆå°†person.eatæ¢æˆteacher.eatæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼›è€Œå¦‚æœteacherç±»å…·æœ‰ç‹¬ç‰¹çš„teachåŠŸèƒ½ï¼Œé‚£ä¹ˆå¦‚æœå°†teacher.teachæ¢æˆperson.teachå°±ä¼šå‡ºç°é”™è¯¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ä¾èµ–å€’ç½®åŸåˆ™dependence-inversion-priciple&#34;&gt;ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDependence Inversion Pricipleï¼‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;é«˜å±‚æ¨¡å—ä¸ä¾èµ–ä½å±‚æ¨¡å—ï¼Œè€Œæ˜¯åº”è¯¥ä¾èµ–å…¶æŠ½è±¡&lt;/li&gt;
&lt;li&gt;æŠ½è±¡ä¸ä¾èµ–äºç»†èŠ‚ï¼Œç»†èŠ‚ä¾èµ–äºæŠ½è±¡&lt;/li&gt;
&lt;li&gt;æ¯”å¦‚teacherç±»ä¸­åº”è¯¥å°½é‡åšä¸€äº›è€å¸ˆå…±æœ‰çš„æŠ½è±¡è¡Œä¸ºï¼Œæ¯”å¦‚æ•™ä¹¦ï¼Œè¿™æ ·åé¢çš„è¯­æ–‡è€å¸ˆï¼Œæ•°å­¦è€å¸ˆç­‰å¯ä»¥ç»§æ‰¿è¯¥æŠ½è±¡è€å¸ˆç±»è¿›è¡Œæ‰©å±•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ¥å£éš”ç¦»åŸåˆ™interface-segregation-priciple&#34;&gt;æ¥å£éš”ç¦»åŸåˆ™ï¼ˆInterface Segregation Pricipleï¼‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å®¢æˆ·ç«¯ä¸åº”è¯¥ä¾èµ–å®ƒä¸éœ€è¦çš„æ¥å£;ä¸€ä¸ªç±»å¯¹å¦ä¸€ä¸ªç±»çš„ä¾èµ–åº”è¯¥å»ºç«‹åœ¨æœ€å°çš„æ¥å£ä¸Š&lt;/li&gt;
&lt;li&gt;å°½é‡ä¸€ä¸ªæ¥å£åªå®ç°ä¸€ä¸ªåŠŸèƒ½ï¼Œå¦‚æœæ¥å£åŠŸèƒ½å¤ªå¤šå¯è¿›è¡Œæ‹†åˆ†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;è¿ªç±³ç‰¹åŸåˆ™law-of-demeter-or-least-knowlegde-priciple&#34;&gt;è¿ªç±³ç‰¹åŸåˆ™ï¼ˆLaw of Demeter or Least Knowlegde Pricipleï¼‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ªå¯¹è±¡åº”è¯¥å¯¹å…¶ä»–å¯¹è±¡æœ‰æœ€å°‘çš„äº†è§£ã€‚&lt;/li&gt;
&lt;li&gt;æ­¤åŸåˆ™ä¸æ¥å£éš”ç¦»åŸåˆ™å¯ä»¥ç»“åˆä½¿ç”¨ï¼Œå°½é‡ä¿æŒä¸€ä¸ªæ–¹æ³•ä¸€ä¸ªå…·ä½“è¡Œä¸ºï¼Œè€Œä¸è¦æ¶µç›–å¤šä¸ªè¡Œä¸ºã€‚&lt;/li&gt;
&lt;/ul&gt;
">JavaåŸºç¡€çŸ¥è¯†</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://philosopherzb.github.io/post/about/"" data-c="
          &lt;blockquote&gt;
&lt;p&gt;æ¬¢è¿æ¥åˆ°æˆ‘çš„å°ç«™å‘€ï¼Œå¾ˆé«˜å…´é‡è§ä½ ï¼ğŸ¤&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;å…³äºæœ¬ç«™&#34;&gt;ğŸ  å…³äºæœ¬ç«™&lt;/h2&gt;
&lt;p&gt;æœ¬ç«™ä½¿ç”¨github-pagesåŠGrideaæ­å»ºè€Œæˆï¼Œä¸“é—¨ç”¨äºæŠ€æœ¯åˆ†äº«ï¼Œæ¬¢è¿å¤§å®¶ä¸€èµ·å‚ä¸ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;github-pages doc: &lt;a href=&#34;https://docs.github.com/en/pages&#34;&gt;https://docs.github.com/en/pages&lt;/a&gt;&lt;br&gt;
gridea doc: &lt;a href=&#34;https://gridea.dev/gridea-start/&#34;&gt;https://gridea.dev/gridea-start/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;åšä¸»æ˜¯è°&#34;&gt;ğŸ‘¨â€ğŸ’» åšä¸»æ˜¯è°&lt;/h2&gt;
&lt;p&gt;æ±‚çŸ¥è·¯ä¸Šçš„é™Œç”Ÿäºº&lt;/p&gt;
&lt;h2 id=&#34;è”ç³»æˆ‘å‘€&#34;&gt;ğŸ“¬ è”ç³»æˆ‘å‘€&lt;/h2&gt;
&lt;p&gt;æœ‰é—®é¢˜å¯ä»¥ç•™è¨€è®¨è®ºå“ˆğŸ˜„&lt;/p&gt;
">å…³äº</a>
      </div>
      
    </div>
    <div class="page">
      <div id="page_ul"></div>
    </div>
  </div>
</div>
<script>
  !function () {
    let searchMask = document.querySelector('#search_mask');
    let result = document.querySelector('#result');
    let items = document.querySelectorAll('.item');
    let searchBox = document.querySelector('#search');
    let statCount = document.querySelector('#stat_count');
    let statTimes = document.querySelector('#stat_times');
    let pageUl = document.querySelector('#page_ul');
    let close = document.querySelector('#close');
    
    close.addEventListener('click', function() {
      searchMask.style = 'display: none;'
    })

    let finds = [];
    let contents = [];
    let pageSize = 10;
    items.forEach(item => {
      let a = item.querySelector('a');
      contents.push({
        title: a.innerText,
        details: a.dataset.c,
        link: a.href
      })
      item.remove();
    })

    function insertStr(soure, start, count) {
      let newStr = soure.substr(start, count);
      return soure.slice(0, start) + '<em>' + newStr + '</em>' + soure.slice(start + count);
    }

    pageUl.addEventListener('click', function(event) {
      let target = event.target;
      if (target.__proto__ === HTMLSpanElement.prototype) {
        appendResults(parseInt(target.dataset.i));
      }
    })

    function appendResults(index) {
      let htmlResult = '';
      let start = index || 0;
      let end = Math.min(start + pageSize, finds.length);
      for (let i = start; i < end; i++) {
        const current = finds[i];
        let html = current.title;
        let sum = 0;
        let positions = current.positions;
        positions.forEach(position => {
          html = insertStr(html, position.start + sum, position.count);
          sum += 9;
        })
        htmlResult += `<div class="item"><a class="result-title" href="${current.link}">${html}</a></div>`;
      }
      result.innerHTML = htmlResult;
      pageUl.innerHTML = '';
      let count = finds.length / pageSize;
      let lis = '';
      if (start !== 0) {
        lis += `<span class="fa fa-angle-left" data-i='${start - 1}'></span>`;
      }
      for (let i = 0; i < count; i++) {
        lis += `<span class='${i === start?'current':''}' data-i='${i}'>${i+1}</span>`;     
      }
      if (start+1 < count) {
        lis += `<span class="fa fa-angle-right" data-i='${start+1}'></span>`;  
      }
      pageUl.innerHTML = lis;
    }

    function search(delay) {
      let timer = null
      return function () {
        clearTimeout(timer)
        timer = setTimeout(() => {
          let start = Date.now();
          let segments = searchBox.value.split(' ').filter(c => c != '');
          if (segments.length <= 0) {
            return;
          }
          finds = [];
          let htmlResult = '';
          contents.forEach(content => {
            let title = content.title;
            let positions = [];
            let find = false;
            segments.forEach((segment) => {
              if (content.title.includes(segment)) {
                find = true;
                positions.push({
                  start: content.title.indexOf(segment),
                  count: segment.length
                })
              } else if (content.details.includes(segment)) {
                find = true;
              }
            });
            if (find) {
              finds.push({
                title: content.title,
                link: content.link,
                positions
              });
            }
          })
          appendResults(0);
          statCount.textContent = finds.length;
          statTimes.textContent = Date.now() - start;
        }, delay)
      }
    }
    searchBox.addEventListener('input', search(200));
  }()
</script>

<input hidden id="copy" />
<script>
  !function () {
    let times = document.querySelectorAll('.publish-time');
    for (let i = 0; i < times.length; i++) {
      let date = times[i].dataset.t;
      let time = Math.floor((new Date().getTime() - new Date(date).getTime()) / 1000);
      if (time < 60) {
        str = time + 'ç§’ä¹‹å‰';
      } else if (time < 3600) {
        str = Math.floor(time / 60) + 'åˆ†é’Ÿä¹‹å‰';
      } else if (time >= 3600 && time < 86400) {
        str = Math.floor(time / 3600) + 'å°æ—¶ä¹‹å‰';
      } else if (time >= 86400 && time < 259200) {
        str = Math.floor(time / 86400) + 'å¤©ä¹‹å‰';
      } else {
        str = times[i].textContent;
      }
      times[i].textContent = str;
    }
  }();
</script>

<script>
  let language = '';
  if (language !== '') {
    let map = new Map();
    if (language === 'en') {
      map.set('search', 'Search');
      map.set('category', 'Categories');
      map.set('article', 'Articles');
      map.set('tag', 'Tags');
      map.set('top', 'Top');
      map.set('publish', 'published');
      map.set('minute', ' minutes');
      map.set('read-more', 'Read More');
      map.set('view', 'View');
      map.set('words', ' words');
      map.set('category-in', 'category in');
      map.set('preview', 'Meta');
      map.set('index', 'Toc');
      map.set('no-archives', "You haven't created yet");
      map.set('archives', " articles in total");
      map.set('cloud-tags', " tags in total");
      map.set('copyright', "Copyright: ");
      map.set('author', "Author: ");
      map.set('link', "Link: ");
      map.set('leave-message', "Leave a message");
      map.set('format', "Links Format");
      map.set('site-name', "Name: ");
      map.set('site-link', "Link: ");
      map.set('site-desc', "Desc: ");
      map.set('stat', " related results, taking ");
      map.set('stat-time', " ms");
      map.set('site-img', "Image: ");
    }

    if (map.size > 0) {
      let lanElems = document.querySelectorAll('.language');
      lanElems.forEach(elem => {
        let lan = elem.dataset.lan, text = map.get(lan);
        if (elem.__proto__ === HTMLInputElement.prototype) {
          elem.placeholder = text
        } else {
          if (elem.dataset.count) {
            text = elem.dataset.count + text;
          }
          elem.textContent = text;
        }
      })
    }
  }
  //æ‹¿æ¥ä¸»ä¹‰(çœŸé¦™)^_^ï¼ŒClipboard å®ç°æ‘˜è‡ªæ˜é‡‘ https://juejin.im/post/5aefeb6e6fb9a07aa43c20af
  window.Clipboard = (function (window, document, navigator) {
    var textArea,
      copy;

    // åˆ¤æ–­æ˜¯ä¸æ˜¯iosç«¯
    function isOS() {
      return navigator.userAgent.match(/ipad|iphone/i);
    }
    //åˆ›å»ºæ–‡æœ¬å…ƒç´ 
    function createTextArea(text) {
      textArea = document.createElement('textArea');
      textArea.value = text;
      textArea.style.width = 0;
      textArea.style.height = 0;
      textArea.clientHeight = 0;
      textArea.clientWidth = 0;
      document.body.appendChild(textArea);
    }
    //é€‰æ‹©å†…å®¹
    function selectText() {
      var range,
        selection;

      if (isOS()) {
        range = document.createRange();
        range.selectNodeContents(textArea);
        selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        textArea.setSelectionRange(0, 999999);
      } else {
        textArea.select();
      }
    }

    //å¤åˆ¶åˆ°å‰ªè´´æ¿
    function copyToClipboard() {
      try {
        document.execCommand("Copy")
      } catch (err) {
        alert("å¤åˆ¶é”™è¯¯ï¼è¯·æ‰‹åŠ¨å¤åˆ¶ï¼")
      }
      document.body.removeChild(textArea);
    }

    copy = function (text) {
      createTextArea(text);
      selectText();
      copyToClipboard();
    };

    return {
      copy: copy
    };
  })(window, document, navigator);

  function copyCode(e) {
    if (e.srcElement.tagName === 'SPAN' && e.srcElement.classList.contains('copy-code')) {
      let code = e.currentTarget.querySelector('code');
      var text = code.innerText;
      if (e.srcElement.textContent === 'å¤åˆ¶æˆåŠŸ') {
        return;
      }
      e.srcElement.textContent = 'å¤åˆ¶æˆåŠŸ';
      (function (elem) {
        setTimeout(() => {
          if (elem.textContent === 'å¤åˆ¶æˆåŠŸ') {
            elem.textContent = 'å¤åˆ¶ä»£ç '
          }
        }, 1000);
      })(e.srcElement)
      Clipboard.copy(text);
    }
  }

  let pres = document.querySelectorAll('pre');
  pres.forEach(pre => {
    let code = pre.querySelector('code');
    let copyElem = document.createElement('span');
    copyElem.classList.add('copy-code');
    copyElem.textContent = 'å¤åˆ¶ä»£ç ';
    pre.appendChild(copyElem);
    pre.onclick = copyCode
  })

</script>
<script src="/media/js/motion.js"></script>


<script src="https://cdn.jsdelivr.net/gh/cferdinandi/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
<script>
  var scroll = new SmoothScroll('a[href*="#"]', {
    speed: 200
  });
</script>





</html>